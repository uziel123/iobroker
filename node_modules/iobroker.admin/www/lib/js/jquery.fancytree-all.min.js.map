{"version":3,"sources":["jquery.fancytree-all.js"],"names":["factory","define","amd","module","exports","require","jQuery","$","ui","fancytree","i","attr","FT","TEST_IMG","RegExp","REX_HTML","REX_TOOLTIP","RECURSIVE_REQUEST_ERROR","ENTITY_MAP","&","<",">","\"","'","/","IGNORE_KEYCODES","16","17","18","SPECIAL_KEYCODES","8","9","10","13","19","20","27","32","33","34","35","36","37","38","39","40","45","46","59","61","96","97","98","99","100","101","102","103","104","105","106","107","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","144","145","173","186","187","188","189","190","191","192","219","220","221","222","MOUSE_BUTTONS","0","1","2","3","CLASS_ATTRS","split","CLASS_ATTR_MAP","TREE_ATTRS","NODE_ATTRS","NODE_ATTR_MAP","NODE_ATTR_LOWERCASE_MAP","NONE_NODE_DATA_MAP","active","children","data","focus","length","toLowerCase","_assert","FancytreeNode","prototype","_findDirectChild","ptr","l","cl","this","key","parent","_setChildren","push","addChildren","insertBefore","pos","firstNode","origFirstChild","getFirstChild","origLastChild","getLastChild","nodeList","isPlainObject","concat","inArray","splice","apply","render","renderStatus","ul","tr","tree","options","selectMode","fixSelection3FromEndNodes","triggerModifyChild","addClass","className","toggleClass","addNode","node","mode","undefined","getParent","getNextSibling","addPagingNode","n","extend","title","strings","moreData","statusNodeType","icon","partload","removeChild","appendSibling","applyPatch","patch","remove","_getResolvedPromise","name","v","IGNORE_MAP","expanded","isFunction","hasOwnProperty","removeChildren","isVisible","renderTitle","setExpanded","collapseSiblings","_callHook","copyTo","map","toDict","countChildren","deep","debug","msg","debugLevel","Array","unshift","call","arguments","toString","consoleApply","discard","warn","resetLazy","discardMarkup","includeSelf","fn","findAll","match","_makeNodeTitleMatcher","res","visit","findFirst","_changeSelectStatusAttrs","state","changed","opts","unselectable","evalOption","unselectableStatus","selected","partsel","fixSelection3AfterClick","callOpts","flag","isSelected","_walk","child","s","allSelected","someSelected","unselState","visitParents","fromDict","dict","getChildren","hasChildren","getIndex","getIndexHier","separator","digits","each","getParentList","o","substr","join","getKeyPath","excludeSelf","path","sep","keyPathSeparator","getLevel","level","dtn","ac","includeRoot","getPrevSibling","getSelectedNodes","stopOnParents","lazy","isStatusNode","hasFocus","focusNode","info","isActive","activeNode","isChildOf","otherNode","isDescendantOf","p","error","isExpanded","isFirstSibling","isFolder","folder","isLastSibling","isLazy","isLoaded","isLoading","_isLoading","isRoot","isRootNode","isPartsel","isPartload","rootNode","isPagingNode","isTopLevel","isUndefined","parents","lazyLoad","load","forceReload","source","that","wasExpanded","_triggerNodeEvent","always","makeVisible","deferreds","dfd","Deferred","len","effects","noAnimation","scroll","scrollIntoView","when","done","resolve","promise","moveTo","targetNode","prevParent","targetParent","navigate","where","activate","KC","keyCode","sib","_goto","e","span","is","setFocus","setActive","BACKSPACE","HOME","END","LEFT","RIGHT","UP","DOWN","childNode","removeClass","force","replaceWith","fail","scheduleAction","ms","timer","clearTimeout","self","setTimeout","x","topNode","topNodeY","nodeY","containerOffsetTop","duration","queue","scrollOfs","scrollParent","$container","nodeHeight","height","topOfs","top","bottomOfs","bottom","containerHeight","scrollTop","$animateTarget","isParentWindow","window","newScrollTop","offset","document","body","Math","max","innerHeight","clientHeight","complete","resolveWith","stop","animate","setSelected","setStatus","status","message","details","setTitle","triggerModify","sortChildren","cmp","a","b","y","sort","recursive","callback","isEmptyObject","value","hasClass","classNames","wasAdded","statusElem","statusClassPropName","curClasses","extraClasses","indexOf","replace","trim","toggleExpanded","toggleSelected","operation","extra","modifyChild","type","visitAndLoad","_recursion","loaders","reject","then","visitSiblings","Fancytree","_makeHookContext","obj","originalEvent","ctx","widget","typeInfo","types","funcName","contextObject","_extraArgs","args","slice","_setExpiringValue","_tempCache","expire","Date","now","_getExpiringValue","entry","_requireExtension","required","before","thisName","_local","extList","extensions","isBefore","isMissing","ext","badOrder","activateKey","getNodeByKey","patchList","p2","patchCount","deferredList","_makeResolveFunc","clear","count","enableUpdate","_enableUpdate","findNextNode","startNode","visibleOnly","reMatch","test","stopNode","parentChildren","matchingNode","walkVisible","idx","grandParent","siblingCount","generateFormElements","selectedName","_id","activeName","id","$result","_appender","append","checked","empty","hide","insertAfter","filter","getActiveNode","getFocusNode","searchRoot","el","getElementById","idPrefix","ftnode","getRootNode","_hasFocus","loadKeyPath","keyPathList","optsOrCallback","pathSegList","notifyWith","matchKey","isArray","charAt","_loadKeyPathImpl","remainMap","tmpParent","segList","subDfd","__findChild","shift","__lazyload","errMsg","rejectWith","nodeKey","remain","reactivate","noFocus","reload","_trigger","result","_triggerTreeEvent","nodeClick","expand","targetType","focusOnSelect","clickFolderMode","nodeSetFocus","nodeCollapseSiblings","nodeDblclick","preventDefault","nodeKeydown","matchNode","stamp","event","which","whichChar","String","fromCharCode","clean","altKey","ctrlKey","metaKey","shiftKey","$target","target","handled","autoActivate","quicksearch","getTime","lastQuicksearchTime","lastQuicksearchTerm","eventToString","nodeSetExpanded","nodeToggleSelected","nodeSetActive","nodeLoadChildren","ajax","delay","requestId","url","_requestId","debugDelay","random","round","textStatus","jqXHR","errorObj","dataType","postProcess","response","enableAspx","d","parseJSON","errorThrown","reason","nodeSetStatus","ctxErr","metaData","nodeLoadKeyPath","nodeRemoveChild","subCtx","nodeRemoveChildren","nodeRemoveMarkup","nodeRemoveChildMarkup","li","nodeRenderStatus","nodeRender","collapsed","_recursive","childLI","childNode1","childNode2","next","aria","firstTime","successorLi","parentNode","nextSibling","createElement","generateIds","appendChild","nodeRenderTitle","createNode","renderNode","style","display","$div","firstChild","checkbox","nodeTitle","role","tooltip","iconTooltip","ares","minExpandLevel","radiogroup","iconClass","_escapeTooltip","imagePath","text","titlesTabbable","escapeTitles","escapeHtml","innerHTML","enhanceTitle","$title","$ariaElem","isLastSib","cn","_classNames","cnList","focused","Boolean","removeAttr","lastsib","loading","_error","statusNodePrefix","combinedExpanderPrefix","combinedIconPrefix","noEvents","_getRejectedPromise","activeVisible","_afterLoad","prevAC","autoCollapse","lastChild","autoScroll","effect","toggleEffect","animating","toggle","ctx2","isInput","calledByNode","find","activeElement","closest","uniqueId","nodeSetSelected","_lastSelectIntent","lastSelectedNode","_setStatusNode","_clearStatusNode","loadError","noData","nodeToggleExpanded","treeClear","treeCreate","treeDestroy","$source","treeInit","tabindex","rtl","treeLoad","$ul","element","rootCtx","parseHtml","_getElementDataAsDict","contents","nodeType","treeRegisterNode","add","treeSetFocus","_lastMousedownNode","treeSetOption","callDefault","callCreate","callRender","_super","Widget","_setOption","cache","disabled","direction","scale","keyboard","radio","_create","extension","extName","_extensions","_subclassObject","base","icons","tabbable","_init","_bind","destroy","_unbind","ns","_ns","off","on","getNode","tbody","prevPhase","phase","et","getEventTarget","getTree","version","buildType","_nextId","_nextNodeKey","_FancytreeClass","_FancytreeNodeClass","jquerySupports","positionMyOfs","dottedVersion","major","minor","t","verParts","parseInt","testParts","isVersionAtLeast","assert","cond","createTree","debounce","timeout","invokeAsap","fixPositionOptions","my","at","myParts","exec","atParts","dx","dy","tcn","getEventTargetType","eq","selector","optionName","nodeObject","treeOptions","defaultValue","treeOpt","nodeOpt","setSpanIcon","baseClass","$span","button","keyEventToString","overrideMethod","instance","methodName","handler","prevSuper","noop","classes","iPos","tmp","tmp2","$children","allData","lowerCaseAttr","$li","$liSpan","$liA","html","href","search","substring","registerExtension","definition","unescapeHtml","childNodes","nodeValue","method","console","_makeVirtualFunction","prevFunc","baseFunc","_superApply","prevLocal","prevSuperApply","attrName","context","argArray","deferred","$el","json","uiFancytree","unselectableIgnore","hideCheckbox","defaultKey","lazyload","loaderror","fx","removeNode","columns","systemFocusElement","ariaPropName","nodeContainerAttrName","fakeParent","class","appendTo","countSelected","topOnly","updateCounters","$badge","extOpts","childcounter","childCounter","hideZeros","hideExpanded","widgetMethod1","arg1","foo","_appendCounter","bar","getCloneList","refList","refMap","refKey","keyMap","val","isClone","reRegister","prevKey","prevRefKey","modified","setRefKey","getNodesByRef","changeRefKey","oldRefKey","newRefKey","highlightActiveClones","highlightClones","asString","seed","h1b","k1","remainder","bytes","h1","c1","c2","charCodeAt","hashMurmur3","clones","arr","elem","_removeArrayMember","scpn","didRegisterDnd","classDropAccept","classDropAfter","classDropBefore","classDropReject","_initDragAndDrop","dnd","glyph","plugin","start","draggable","sourceNode","helper","click","left","_onDragEvent","drag","prevTargetNode","dndOpts","updateHelper","dropMarker","dragDrop","dropped","dragStart","addClasses","containment","distance","revert","scrollSpeed","scrollSensitivity","connectToFancytree","$helper","$nodeTag","css","zIndex","position","clone","_addClass","dragHelper","initHelper","droppable","tolerance","greedy","autoExpandMS","focusOnClick","preventVoidMoves","preventRecursiveMoves","smartRevert","dropMarkerOffsetX","dropMarkerInsertOffsetX","dragStop","dragEnter","dragOver","dragExpand","dragLeave","_setDndStatus","hitMode","accept","markerOffsetX","markerAt","instData","dndOpt","glyphOpt","$targetTitle","$dropMarker","z-index","prependTo","show","of","eventName","nodeOfs","parentRect","rect","relPos","relPos2","enterResponse","r","trigger","getBoundingClientRect","originalPosition","ESCAPE","_cancelDrag","over","after","pageX","pageY","width","dd","ddmanager","current","cancel","classDragSource","classDragRemove","classDropOver","classDropTarget","nodeMimeType","SOURCE_NODE","DRAG_ENTER_RESPONSE","LAST_HIT_MODE","handleDragOver","spOfs","sp","sensitivity","speed","scrolled","dnd5","$scrollParent","tagName","offsetHeight","scrollHeight","relPosY","setTextTypeJson","preventForeignNodes","preventNonNodes","dragDrag","dragEnd","$temp","pointer-events","dataTransfer","isMove","dropEffect","isCancelled","JSON","stringify","setData","ex","effectAllowed","setDragImage","nodeData","allowDrop","otherNodeData","Object","keys","getData","parse","isMac","navigator","platform","editStart","$input","local","edit","instOpts","eventData","isNew","orgTitle","input","dirty","beforeEdit","currentNode","editEnd","adjustWidthOfs","inputCss","change","keydown","ENTER","stopPropagation","blur","applyChanges","_event","newVal","save","beforeClose","relatedNode","close","editCreateNode","init","newNode","isEditing","allowEmpty","minWidth","triggerStart","KeyNoData","_escapeRegex","str","_applyFilterImpl","branchMode","_opts","statusNode","re","reHighlight","temp","treeOpts","prevAutoCollapse","hideMode","leavesOnly","clearFilter","fuzzy","reduce","highlight","titleWithHighlight","enableFilter","lastFilterArgs","hideExpanders","subMatchCount","matchedByBranch","c","autoExpand","_filterAutoExpanded","nodata","filterNodes","applyFilter","filterBranches","$subMatchBadge","isFilterActive","isMatched","autoApply","counter","hideExpandedCounter","PRESETS","awesome3","checkboxSelected","checkboxUnknown","expanderClosed","expanderLazy","expanderOpen","noExpander","radioSelected","doc","docOpen","folderOpen","awesome4","bootstrap3","material","setIcon","setClass","preset","get","NAV_KEYS","link","radiobutton","select-one","select-multiple","findTdAtColIdx","$tr","colIdx","colspan","prop","findNeighbourTd","td","$td","$tdNext","prev","autofocusInput","handleCursorKeys","gridnav","triggeredByInput","inputType","handleKeys","cookieStore","localStorageStore","localStorage","getItem","set","setItem","removeItem","sessionStorageStore","sessionStorage","ACTIVE","EXPANDED","FOCUS","SELECTED","Cookies","persist","cookie","removeCookie","clearData","prefix","cookiePrefix","_data","clearCookies","getPersistData","delim","cookieDelimiter","raw","expires","domain","secure","expandLazy","expandOpts","fireActivate","overrideSource","store","_appendKey","cookieName","keyList","storeActive","storeExpanded","storeSelected","storeFocus","prevFocus","_loadLazyNodes","foundOne","missingKeyList","selNodes","setChildRowVisibility","checkboxColumnIdx","indentation","nodeColumnIdx","columnCount","$row","$tbody","tableOpts","table","$table","customStatus","renderStatusColumns","renderColumns","rowFragment","createDocumentFragment","firstTr","newRow","prevNode","prevTr","hasCollapsedParents","cloneNode","last","siblings","findPrevRowNode","referenceNode","previousSibling","nextTr","$cb","indent","paddingLeft","subOpts","_afterExpand","ok","activeClass","focusClass","hoverClass","selectedClass","themeroller","nodeName","delegate","reNumUnit","defineHeadStyleElement","cssText","$headStyle","styleSheet","renderLevelCss","containerId","depth","levelOfs","lineOfs","labelOfs","measureUnit","rules","iconWidth","iconSpacing","labelSpacing","iconSpacingUnit","labelSpacingUnit","iconWidthUnit","levelOfsUnit","wide","$dummyLI","$dummyIcon","$dummyUL","parseFloat","maxDepth"],"mappings":"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","file":"jquery.fancytree-all.min.js","sourcesContent":["/*!\r\n * jquery.fancytree.js\r\n * Tree view control with support for lazy loading and much more.\r\n * https://github.com/mar10/fancytree/\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n/** Core Fancytree module.\r\n */\r\n\r\n// UMD wrapper for the Fancytree core module\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree.ui-deps\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree.ui-deps\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n// prevent duplicate loading\r\nif ( $.ui && $.ui.fancytree ) {\r\n\t$.ui.fancytree.warn(\"Fancytree: ignored duplicate include\");\r\n\treturn;\r\n}\r\n\r\n\r\n/* *****************************************************************************\r\n * Private functions and variables\r\n */\r\n\r\nvar i, attr,\r\n\tFT = null, // initialized below\r\n\tTEST_IMG = new RegExp(/\\.|\\//),  // strings are considered image urls if they contain '.' or '/'\r\n\tREX_HTML = /[&<>\"'\\/]/g,  // Escape those characters\r\n\tREX_TOOLTIP = /[<>\"'\\/]/g,  // Don't escape `&` in tooltips\r\n\tRECURSIVE_REQUEST_ERROR = \"$recursive_request\",\r\n\tENTITY_MAP = {\"&\": \"&amp;\", \"<\": \"&lt;\", \">\": \"&gt;\", \"\\\"\": \"&quot;\", \"'\": \"&#39;\", \"/\": \"&#x2F;\"},\r\n\tIGNORE_KEYCODES = { 16: true, 17: true, 18: true },\r\n\tSPECIAL_KEYCODES = {\r\n\t\t8: \"backspace\", 9: \"tab\", 10: \"return\", 13: \"return\",\r\n\t\t// 16: null, 17: null, 18: null, // ignore shift, ctrl, alt\r\n\t\t19: \"pause\", 20: \"capslock\", 27: \"esc\", 32: \"space\", 33: \"pageup\",\r\n\t\t34: \"pagedown\", 35: \"end\", 36: \"home\", 37: \"left\", 38: \"up\",\r\n\t\t39: \"right\", 40: \"down\", 45: \"insert\", 46: \"del\", 59: \";\", 61: \"=\",\r\n\t\t96: \"0\", 97: \"1\", 98: \"2\", 99: \"3\", 100: \"4\", 101: \"5\", 102: \"6\",\r\n\t\t103: \"7\", 104: \"8\", 105: \"9\", 106: \"*\", 107: \"+\", 109: \"-\", 110: \".\",\r\n\t\t111: \"/\", 112: \"f1\", 113: \"f2\", 114: \"f3\", 115: \"f4\", 116: \"f5\",\r\n\t\t117: \"f6\", 118: \"f7\", 119: \"f8\", 120: \"f9\", 121: \"f10\", 122: \"f11\",\r\n\t\t123: \"f12\", 144: \"numlock\", 145: \"scroll\", 173: \"-\", 186: \";\", 187: \"=\",\r\n\t\t188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\r\n\t\t221: \"]\", 222: \"'\"},\r\n\tMOUSE_BUTTONS = { 0: \"\", 1: \"left\", 2: \"middle\", 3: \"right\" },\r\n\t// Boolean attributes that can be set with equivalent class names in the LI tags\r\n\t// Note: v2.23: checkbox and hideCheckbox are *not* in this list\r\n\tCLASS_ATTRS = \"active expanded focus folder lazy radiogroup selected unselectable unselectableIgnore\".split(\" \"),\r\n\tCLASS_ATTR_MAP = {},\r\n\t// Top-level Fancytree attributes, that can be set by dict\r\n\tTREE_ATTRS = \"columns types\".split(\" \"),\r\n\t// TREE_ATTR_MAP = {},\r\n\t// Top-level FancytreeNode attributes, that can be set by dict\r\n\tNODE_ATTRS = \"checkbox expanded extraClasses folder icon iconTooltip key lazy radiogroup refKey selected statusNodeType title tooltip type unselectable unselectableIgnore unselectableStatus\".split(\" \"),\r\n\tNODE_ATTR_MAP = {},\r\n\t// Mapping of lowercase -> real name (because HTML5 data-... attribute only supports lowercase)\r\n\tNODE_ATTR_LOWERCASE_MAP = {},\r\n\t// Attribute names that should NOT be added to node.data\r\n\tNONE_NODE_DATA_MAP = {\"active\": true, \"children\": true, \"data\": true, \"focus\": true};\r\n\r\nfor(i=0; i<CLASS_ATTRS.length; i++){ CLASS_ATTR_MAP[CLASS_ATTRS[i]] = true; }\r\nfor(i=0; i<NODE_ATTRS.length; i++) {\r\n\tattr = NODE_ATTRS[i];\r\n\tNODE_ATTR_MAP[attr] = true;\r\n\tif( attr !== attr.toLowerCase() ) {\r\n\t\tNODE_ATTR_LOWERCASE_MAP[attr.toLowerCase()] = attr;\r\n\t}\r\n}\r\n// for(i=0; i<TREE_ATTRS.length; i++) {\r\n// \tTREE_ATTR_MAP[TREE_ATTRS[i]] = true;\r\n// }\r\n\r\n\r\nfunction _assert(cond, msg){\r\n\t// TODO: see qunit.js extractStacktrace()\r\n\tif(!cond){\r\n\t\tmsg = msg ? \": \" + msg : \"\";\r\n\t\t// consoleApply(\"assert\", [!!cond, msg]);\r\n\t\t$.error(\"Fancytree assertion failed\" + msg);\r\n\t}\r\n}\r\n\r\n_assert($.ui, \"Fancytree requires jQuery UI (http://jqueryui.com)\");\r\n\r\nfunction consoleApply(method, args){\r\n\tvar i, s,\r\n\t\tfn = window.console ? window.console[method] : null;\r\n\r\n\tif(fn){\r\n\t\ttry{\r\n\t\t\tfn.apply(window.console, args);\r\n\t\t} catch(e) {\r\n\t\t\t// IE 8?\r\n\t\t\ts = \"\";\r\n\t\t\tfor( i=0; i<args.length; i++ ) {\r\n\t\t\t\ts += args[i];\r\n\t\t\t}\r\n\t\t\tfn(s);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n/*Return true if x is a FancytreeNode.*/\r\nfunction _isNode(x){\r\n\treturn !!(x.tree && x.statusNodeType !== undefined);\r\n}\r\n\r\n/** Return true if dotted version string is equal or higher than requested version.\r\n *\r\n * See http://jsfiddle.net/mar10/FjSAN/\r\n */\r\nfunction isVersionAtLeast(dottedVersion, major, minor, patch){\r\n\tvar i, v, t,\r\n\t\tverParts = $.map($.trim(dottedVersion).split(\".\"), function(e){ return parseInt(e, 10); }),\r\n\t\ttestParts = $.map(Array.prototype.slice.call(arguments, 1), function(e){ return parseInt(e, 10); });\r\n\r\n\tfor( i = 0; i < testParts.length; i++ ){\r\n\t\tv = verParts[i] || 0;\r\n\t\tt = testParts[i] || 0;\r\n\t\tif( v !== t ){\r\n\t\t\treturn ( v > t );\r\n\t\t}\r\n\t}\r\n\treturn true;\r\n}\r\n\r\n/** Return a wrapper that calls sub.methodName() and exposes\r\n *  this             : tree\r\n *  this._local      : tree.ext.EXTNAME\r\n *  this._super      : base.methodName.call()\r\n *  this._superApply : base.methodName.apply()\r\n */\r\nfunction _makeVirtualFunction(methodName, tree, base, extension, extName){\r\n\t// $.ui.fancytree.debug(\"_makeVirtualFunction\", methodName, tree, base, extension, extName);\r\n\t// if(rexTestSuper && !rexTestSuper.test(func)){\r\n\t//     // extension.methodName() doesn't call _super(), so no wrapper required\r\n\t//     return func;\r\n\t// }\r\n\t// Use an immediate function as closure\r\n\tvar proxy = (function(){\r\n\t\tvar prevFunc = tree[methodName],      // org. tree method or prev. proxy\r\n\t\t\tbaseFunc = extension[methodName], //\r\n\t\t\t_local = tree.ext[extName],\r\n\t\t\t_super = function(){\r\n\t\t\t\treturn prevFunc.apply(tree, arguments);\r\n\t\t\t},\r\n\t\t\t_superApply = function(args){\r\n\t\t\t\treturn prevFunc.apply(tree, args);\r\n\t\t\t};\r\n\r\n\t\t// Return the wrapper function\r\n\t\treturn function(){\r\n\t\t\tvar prevLocal = tree._local,\r\n\t\t\t\tprevSuper = tree._super,\r\n\t\t\t\tprevSuperApply = tree._superApply;\r\n\r\n\t\t\ttry{\r\n\t\t\t\ttree._local = _local;\r\n\t\t\t\ttree._super = _super;\r\n\t\t\t\ttree._superApply = _superApply;\r\n\t\t\t\treturn  baseFunc.apply(tree, arguments);\r\n\t\t\t}finally{\r\n\t\t\t\ttree._local = prevLocal;\r\n\t\t\t\ttree._super = prevSuper;\r\n\t\t\t\ttree._superApply = prevSuperApply;\r\n\t\t\t}\r\n\t\t};\r\n\t})(); // end of Immediate Function\r\n\treturn proxy;\r\n}\r\n\r\n/**\r\n * Subclass `base` by creating proxy functions\r\n */\r\nfunction _subclassObject(tree, base, extension, extName){\r\n\t// $.ui.fancytree.debug(\"_subclassObject\", tree, base, extension, extName);\r\n\tfor(var attrName in extension){\r\n\t\tif(typeof extension[attrName] === \"function\"){\r\n\t\t\tif(typeof tree[attrName] === \"function\"){\r\n\t\t\t\t// override existing method\r\n\t\t\t\ttree[attrName] = _makeVirtualFunction(attrName, tree, base, extension, extName);\r\n\t\t\t}else if(attrName.charAt(0) === \"_\"){\r\n\t\t\t\t// Create private methods in tree.ext.EXTENSION namespace\r\n\t\t\t\ttree.ext[extName][attrName] = _makeVirtualFunction(attrName, tree, base, extension, extName);\r\n\t\t\t}else{\r\n\t\t\t\t$.error(\"Could not override tree.\" + attrName + \". Use prefix '_' to create tree.\" + extName + \"._\" + attrName);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t// Create member variables in tree.ext.EXTENSION namespace\r\n\t\t\tif(attrName !== \"options\"){\r\n\t\t\t\ttree.ext[extName][attrName] = extension[attrName];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nfunction _getResolvedPromise(context, argArray){\r\n\tif(context === undefined){\r\n\t\treturn $.Deferred(function(){this.resolve();}).promise();\r\n\t}else{\r\n\t\treturn $.Deferred(function(){this.resolveWith(context, argArray);}).promise();\r\n\t}\r\n}\r\n\r\n\r\nfunction _getRejectedPromise(context, argArray){\r\n\tif(context === undefined){\r\n\t\treturn $.Deferred(function(){this.reject();}).promise();\r\n\t}else{\r\n\t\treturn $.Deferred(function(){this.rejectWith(context, argArray);}).promise();\r\n\t}\r\n}\r\n\r\n\r\nfunction _makeResolveFunc(deferred, context){\r\n\treturn function(){\r\n\t\tdeferred.resolveWith(context);\r\n\t};\r\n}\r\n\r\n\r\nfunction _getElementDataAsDict($el){\r\n\t// Evaluate 'data-NAME' attributes with special treatment for 'data-json'.\r\n\tvar d = $.extend({}, $el.data()),\r\n\t\tjson = d.json;\r\n\r\n\tdelete d.fancytree; // added to container by widget factory (old jQuery UI)\r\n\tdelete d.uiFancytree; // added to container by widget factory\r\n\r\n\tif( json ) {\r\n\t\tdelete d.json;\r\n\t\t// <li data-json='...'> is already returned as object (http://api.jquery.com/data/#data-html5)\r\n\t\td = $.extend(d, json);\r\n\t}\r\n\treturn d;\r\n}\r\n\r\n\r\nfunction _escapeTooltip(s){\r\n\treturn (\"\" + s).replace(REX_TOOLTIP, function(s) {\r\n\t\treturn ENTITY_MAP[s];\r\n\t});\r\n}\r\n\r\n\r\n// TODO: use currying\r\nfunction _makeNodeTitleMatcher(s){\r\n\ts = s.toLowerCase();\r\n\treturn function(node){\r\n\t\treturn node.title.toLowerCase().indexOf(s) >= 0;\r\n\t};\r\n}\r\n\r\n\r\nfunction _makeNodeTitleStartMatcher(s){\r\n\tvar reMatch = new RegExp(\"^\" + s, \"i\");\r\n\treturn function(node){\r\n\t\treturn reMatch.test(node.title);\r\n\t};\r\n}\r\n\r\n\r\n/* *****************************************************************************\r\n * FancytreeNode\r\n */\r\n\r\n\r\n/**\r\n * Creates a new FancytreeNode\r\n *\r\n * @class FancytreeNode\r\n * @classdesc A FancytreeNode represents the hierarchical data model and operations.\r\n *\r\n * @param {FancytreeNode} parent\r\n * @param {NodeData} obj\r\n *\r\n * @property {Fancytree} tree The tree instance\r\n * @property {FancytreeNode} parent The parent node\r\n * @property {string} key Node id (must be unique inside the tree)\r\n * @property {string} title Display name (may contain HTML)\r\n * @property {object} data Contains all extra data that was passed on node creation\r\n * @property {FancytreeNode[] | null | undefined} children Array of child nodes.<br>\r\n *     For lazy nodes, null or undefined means 'not yet loaded'. Use an empty array\r\n *     to define a node that has no children.\r\n * @property {boolean} expanded Use isExpanded(), setExpanded() to access this property.\r\n * @property {string} extraClasses Additional CSS classes, added to the node's `&lt;span>`.<br>\r\n *     Note: use `node.add/remove/toggleClass()` to modify.\r\n * @property {boolean} folder Folder nodes have different default icons and click behavior.<br>\r\n *     Note: Also non-folders may have children.\r\n * @property {string} statusNodeType null for standard nodes. Otherwise type of special system node: 'error', 'loading', 'nodata', or 'paging'.\r\n * @property {boolean} lazy True if this node is loaded on demand, i.e. on first expansion.\r\n * @property {boolean} selected Use isSelected(), setSelected() to access this property.\r\n * @property {string} tooltip Alternative description used as hover popup\r\n * @property {string} iconTooltip Description used as hover popup for icon. @since 2.27\r\n * @property {string} type Node type, used with tree.types map. @since 2.27\r\n */\r\nfunction FancytreeNode(parent, obj){\r\n\tvar i, l, name, cl;\r\n\r\n\tthis.parent = parent;\r\n\tthis.tree = parent.tree;\r\n\tthis.ul = null;\r\n\tthis.li = null;  // <li id='key' ftnode=this> tag\r\n\tthis.statusNodeType = null; // if this is a temp. node to display the status of its parent\r\n\tthis._isLoading = false;    // if this node itself is loading\r\n\tthis._error = null;         // {message: '...'} if a load error occurred\r\n\tthis.data = {};\r\n\r\n\t// TODO: merge this code with node.toDict()\r\n\t// copy attributes from obj object\r\n\tfor(i=0, l=NODE_ATTRS.length; i<l; i++){\r\n\t\tname = NODE_ATTRS[i];\r\n\t\tthis[name] = obj[name];\r\n\t}\r\n\t// unselectableIgnore and unselectableStatus imply unselectable\r\n\tif( this.unselectableIgnore != null || this.unselectableStatus != null ) {\r\n\t\tthis.unselectable = true;\r\n\t}\r\n\tif( obj.hideCheckbox ) {\r\n\t\t$.error(\"'hideCheckbox' node option was removed in v2.23.0: use 'checkbox: false'\");\r\n\t}\r\n\t// node.data += obj.data\r\n\tif(obj.data){\r\n\t\t$.extend(this.data, obj.data);\r\n\t}\r\n\t// Copy all other attributes to this.data.NAME\r\n\tfor(name in obj){\r\n\t\tif(!NODE_ATTR_MAP[name] && !$.isFunction(obj[name]) && !NONE_NODE_DATA_MAP[name]){\r\n\t\t\t// node.data.NAME = obj.NAME\r\n\t\t\tthis.data[name] = obj[name];\r\n\t\t}\r\n\t}\r\n\r\n\t// Fix missing key\r\n\tif( this.key == null ){ // test for null OR undefined\r\n\t\tif( this.tree.options.defaultKey ) {\r\n\t\t\tthis.key = this.tree.options.defaultKey(this);\r\n\t\t\t_assert(this.key, \"defaultKey() must return a unique key\");\r\n\t\t} else {\r\n\t\t\tthis.key = \"_\" + (FT._nextNodeKey++);\r\n\t\t}\r\n\t} else {\r\n\t\tthis.key = \"\" + this.key; // Convert to string (#217)\r\n\t}\r\n\r\n\t// Fix tree.activeNode\r\n\t// TODO: not elegant: we use obj.active as marker to set tree.activeNode\r\n\t// when loading from a dictionary.\r\n\tif(obj.active){\r\n\t\t_assert(this.tree.activeNode === null, \"only one active node allowed\");\r\n\t\tthis.tree.activeNode = this;\r\n\t}\r\n\tif( obj.selected ){ // #186\r\n\t\tthis.tree.lastSelectedNode = this;\r\n\t}\r\n\t// TODO: handle obj.focus = true\r\n\r\n\t// Create child nodes\r\n\tcl = obj.children;\r\n\tif( cl ){\r\n\t\tif( cl.length ){\r\n\t\t\tthis._setChildren(cl);\r\n\t\t} else {\r\n\t\t\t// if an empty array was passed for a lazy node, keep it, in order to mark it 'loaded'\r\n\t\t\tthis.children = this.lazy ? [] : null;\r\n\t\t}\r\n\t} else {\r\n\t\tthis.children = null;\r\n\t}\r\n\t// Add to key/ref map (except for root node)\r\n//\tif( parent ) {\r\n\tthis.tree._callHook(\"treeRegisterNode\", this.tree, true, this);\r\n//\t}\r\n}\r\n\r\n\r\nFancytreeNode.prototype = /** @lends FancytreeNode# */{\r\n\t/* Return the direct child FancytreeNode with a given key, index. */\r\n\t_findDirectChild: function(ptr){\r\n\t\tvar i, l,\r\n\t\t\tcl = this.children;\r\n\r\n\t\tif(cl){\r\n\t\t\tif(typeof ptr === \"string\"){\r\n\t\t\t\tfor(i=0, l=cl.length; i<l; i++){\r\n\t\t\t\t\tif(cl[i].key === ptr){\r\n\t\t\t\t\t\treturn cl[i];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else if(typeof ptr === \"number\"){\r\n\t\t\t\treturn this.children[ptr];\r\n\t\t\t}else if(ptr.parent === this){\r\n\t\t\t\treturn ptr;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t// TODO: activate()\r\n\t// TODO: activateSilently()\r\n\t/* Internal helper called in recursive addChildren sequence.*/\r\n\t_setChildren: function(children){\r\n\t\t_assert(children && (!this.children || this.children.length === 0), \"only init supported\");\r\n\t\tthis.children = [];\r\n\t\tfor(var i=0, l=children.length; i<l; i++){\r\n\t\t\tthis.children.push(new FancytreeNode(this, children[i]));\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * Append (or insert) a list of child nodes.\r\n\t *\r\n\t * @param {NodeData[]} children array of child node definitions (also single child accepted)\r\n\t * @param {FancytreeNode | string | Integer} [insertBefore] child node (or key or index of such).\r\n\t *     If omitted, the new children are appended.\r\n\t * @returns {FancytreeNode} first child added\r\n\t *\r\n\t * @see FancytreeNode#applyPatch\r\n\t */\r\n\taddChildren: function(children, insertBefore){\r\n\t\tvar i, l, pos,\r\n\t\t\torigFirstChild = this.getFirstChild(),\r\n\t\t\torigLastChild = this.getLastChild(),\r\n\t\t\tfirstNode = null,\r\n\t\t\tnodeList = [];\r\n\r\n\t\tif($.isPlainObject(children) ){\r\n\t\t\tchildren = [children];\r\n\t\t}\r\n\t\tif(!this.children){\r\n\t\t\tthis.children = [];\r\n\t\t}\r\n\t\tfor(i=0, l=children.length; i<l; i++){\r\n\t\t\tnodeList.push(new FancytreeNode(this, children[i]));\r\n\t\t}\r\n\t\tfirstNode = nodeList[0];\r\n\t\tif(insertBefore == null){\r\n\t\t\tthis.children = this.children.concat(nodeList);\r\n\t\t}else{\r\n\t\t\t// Returns null if insertBefore is not a direct child:\r\n\t\t\tinsertBefore = this._findDirectChild(insertBefore);\r\n\t\t\tpos = $.inArray(insertBefore, this.children);\r\n\t\t\t_assert(pos >= 0, \"insertBefore must be an existing child\");\r\n\t\t\t// insert nodeList after children[pos]\r\n\t\t\tthis.children.splice.apply(this.children, [pos, 0].concat(nodeList));\r\n\t\t}\r\n\t\tif ( origFirstChild && !insertBefore ) {\r\n\t\t\t// #708: Fast path -- don't render every child of root, just the new ones!\r\n\t\t\t// #723, #729: but only if it's appended to an existing child list\r\n\t\t\tfor(i=0, l=nodeList.length; i<l; i++) {\r\n\t\t\t\tnodeList[i].render();   // New nodes were never rendered before\r\n\t\t\t}\r\n\t\t\t// Adjust classes where status may have changed\r\n\t\t\t// Has a first child\r\n\t\t\tif (origFirstChild !== this.getFirstChild()) {\r\n\t\t\t\t// Different first child -- recompute classes\r\n\t\t\t\torigFirstChild.renderStatus();\r\n\t\t\t}\r\n\t\t\tif (origLastChild !== this.getLastChild()) {\r\n\t\t\t\t// Different last child -- recompute classes\r\n\t\t\t\torigLastChild.renderStatus();\r\n\t\t\t}\r\n\t\t} else if( !this.parent || this.parent.ul || this.tr ){\r\n\t\t\t// render if the parent was rendered (or this is a root node)\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t\tif( this.tree.options.selectMode === 3 ){\r\n\t\t\tthis.fixSelection3FromEndNodes();\r\n\t\t}\r\n\t\tthis.triggerModifyChild(\"add\", nodeList.length === 1 ? nodeList[0] : null);\r\n\t\treturn firstNode;\r\n\t},\r\n\t/**\r\n\t * Add class to node's span tag and to .extraClasses.\r\n\t *\r\n\t * @param {string} className class name\r\n\t *\r\n\t * @since 2.17\r\n\t */\r\n\taddClass: function(className){\r\n\t\treturn this.toggleClass(className, true);\r\n\t},\r\n\t/**\r\n\t * Append or prepend a node, or append a child node.\r\n\t *\r\n\t * This a convenience function that calls addChildren()\r\n\t *\r\n\t * @param {NodeData} node node definition\r\n\t * @param {string} [mode=child] 'before', 'after', 'firstChild', or 'child' ('over' is a synonym for 'child')\r\n\t * @returns {FancytreeNode} new node\r\n\t */\r\n\taddNode: function(node, mode){\r\n\t\tif(mode === undefined || mode === \"over\"){\r\n\t\t\tmode = \"child\";\r\n\t\t}\r\n\t\tswitch(mode){\r\n\t\tcase \"after\":\r\n\t\t\treturn this.getParent().addChildren(node, this.getNextSibling());\r\n\t\tcase \"before\":\r\n\t\t\treturn this.getParent().addChildren(node, this);\r\n\t\tcase \"firstChild\":\r\n\t\t\t// Insert before the first child if any\r\n\t\t\tvar insertBefore = (this.children ? this.children[0] : null);\r\n\t\t\treturn this.addChildren(node, insertBefore);\r\n\t\tcase \"child\":\r\n\t\tcase \"over\":\r\n\t\t\treturn this.addChildren(node);\r\n\t\t}\r\n\t\t_assert(false, \"Invalid mode: \" + mode);\r\n\t},\r\n\t/**Add child status nodes that indicate 'More...', etc.\r\n\t *\r\n\t * This also maintains the node's `partload` property.\r\n\t * @param {boolean|object} node optional node definition. Pass `false` to remove all paging nodes.\r\n\t * @param {string} [mode='child'] 'child'|firstChild'\r\n\t * @since 2.15\r\n\t */\r\n\taddPagingNode: function(node, mode){\r\n\t\tvar i, n;\r\n\r\n\t\tmode = mode || \"child\";\r\n\t\tif( node === false ) {\r\n\t\t\tfor(i=this.children.length-1; i >= 0; i--) {\r\n\t\t\t\tn = this.children[i];\r\n\t\t\t\tif( n.statusNodeType === \"paging\" ) {\r\n\t\t\t\t\tthis.removeChild(n);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.partload = false;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tnode = $.extend({\r\n\t\t\ttitle: this.tree.options.strings.moreData,\r\n\t\t\tstatusNodeType: \"paging\",\r\n\t\t\ticon: false\r\n\t\t}, node);\r\n\t\tthis.partload = true;\r\n\t\treturn this.addNode(node, mode);\r\n\t},\r\n\t/**\r\n\t * Append new node after this.\r\n\t *\r\n\t * This a convenience function that calls addNode(node, 'after')\r\n\t *\r\n\t * @param {NodeData} node node definition\r\n\t * @returns {FancytreeNode} new node\r\n\t */\r\n\tappendSibling: function(node){\r\n\t\treturn this.addNode(node, \"after\");\r\n\t},\r\n\t/**\r\n\t * Modify existing child nodes.\r\n\t *\r\n\t * @param {NodePatch} patch\r\n\t * @returns {$.Promise}\r\n\t * @see FancytreeNode#addChildren\r\n\t */\r\n\tapplyPatch: function(patch) {\r\n\t\t// patch [key, null] means 'remove'\r\n\t\tif(patch === null){\r\n\t\t\tthis.remove();\r\n\t\t\treturn _getResolvedPromise(this);\r\n\t\t}\r\n\t\t// TODO: make sure that root node is not collapsed or modified\r\n\t\t// copy (most) attributes to node.ATTR or node.data.ATTR\r\n\t\tvar name, promise, v,\r\n\t\t\tIGNORE_MAP = { children: true, expanded: true, parent: true }; // TODO: should be global\r\n\r\n\t\tfor(name in patch){\r\n\t\t\tv = patch[name];\r\n\t\t\tif( !IGNORE_MAP[name] && !$.isFunction(v)){\r\n\t\t\t\tif(NODE_ATTR_MAP[name]){\r\n\t\t\t\t\tthis[name] = v;\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.data[name] = v;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Remove and/or create children\r\n\t\tif(patch.hasOwnProperty(\"children\")){\r\n\t\t\tthis.removeChildren();\r\n\t\t\tif(patch.children){ // only if not null and not empty list\r\n\t\t\t\t// TODO: addChildren instead?\r\n\t\t\t\tthis._setChildren(patch.children);\r\n\t\t\t}\r\n\t\t\t// TODO: how can we APPEND or INSERT child nodes?\r\n\t\t}\r\n\t\tif(this.isVisible()){\r\n\t\t\tthis.renderTitle();\r\n\t\t\tthis.renderStatus();\r\n\t\t}\r\n\t\t// Expand collapse (final step, since this may be async)\r\n\t\tif(patch.hasOwnProperty(\"expanded\")){\r\n\t\t\tpromise = this.setExpanded(patch.expanded);\r\n\t\t}else{\r\n\t\t\tpromise = _getResolvedPromise(this);\r\n\t\t}\r\n\t\treturn promise;\r\n\t},\r\n\t/** Collapse all sibling nodes.\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tcollapseSiblings: function() {\r\n\t\treturn this.tree._callHook(\"nodeCollapseSiblings\", this);\r\n\t},\r\n\t/** Copy this node as sibling or child of `node`.\r\n\t *\r\n\t * @param {FancytreeNode} node source node\r\n\t * @param {string} [mode=child] 'before' | 'after' | 'child'\r\n\t * @param {Function} [map] callback function(NodeData) that could modify the new node\r\n\t * @returns {FancytreeNode} new\r\n\t */\r\n\tcopyTo: function(node, mode, map) {\r\n\t\treturn node.addNode(this.toDict(true, map), mode);\r\n\t},\r\n\t/** Count direct and indirect children.\r\n\t *\r\n\t * @param {boolean} [deep=true] pass 'false' to only count direct children\r\n\t * @returns {int} number of child nodes\r\n\t */\r\n\tcountChildren: function(deep) {\r\n\t\tvar cl = this.children, i, l, n;\r\n\t\tif( !cl ){\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\tn = cl.length;\r\n\t\tif(deep !== false){\r\n\t\t\tfor(i=0, l=n; i<l; i++){\r\n\t\t\t\tn += cl[i].countChildren();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn n;\r\n\t},\r\n\t// TODO: deactivate()\r\n\t/** Write to browser console if debugLevel >= 2 (prepending node info)\r\n\t *\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\tdebug: function(msg){\r\n\t\tif( this.tree.options.debugLevel >= 2 ) {\r\n\t\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\t\tconsoleApply(\"log\", arguments);\r\n\t\t}\r\n\t},\r\n\t/** Deprecated.\r\n\t * @deprecated since 2014-02-16. Use resetLazy() instead.\r\n\t */\r\n\tdiscard: function(){\r\n\t\tthis.warn(\"FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead.\");\r\n\t\treturn this.resetLazy();\r\n\t},\r\n\t/** Remove DOM elements for all descendents. May be called on .collapse event\r\n\t * to keep the DOM small.\r\n\t * @param {boolean} [includeSelf=false]\r\n\t */\r\n\tdiscardMarkup: function(includeSelf){\r\n\t\tvar fn = includeSelf ? \"nodeRemoveMarkup\" : \"nodeRemoveChildMarkup\";\r\n\t\tthis.tree._callHook(fn, this);\r\n\t},\r\n\t/**Find all nodes that match condition (excluding self).\r\n\t *\r\n\t * @param {string | function(node)} match title string to search for, or a\r\n\t *     callback function that returns `true` if a node is matched.\r\n\t * @returns {FancytreeNode[]} array of nodes (may be empty)\r\n\t */\r\n\tfindAll: function(match) {\r\n\t\tmatch = $.isFunction(match) ? match : _makeNodeTitleMatcher(match);\r\n\t\tvar res = [];\r\n\t\tthis.visit(function(n){\r\n\t\t\tif(match(n)){\r\n\t\t\t\tres.push(n);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn res;\r\n\t},\r\n\t/**Find first node that matches condition (excluding self).\r\n\t *\r\n\t * @param {string | function(node)} match title string to search for, or a\r\n\t *     callback function that returns `true` if a node is matched.\r\n\t * @returns {FancytreeNode} matching node or null\r\n\t * @see FancytreeNode#findAll\r\n\t */\r\n\tfindFirst: function(match) {\r\n\t\tmatch = $.isFunction(match) ? match : _makeNodeTitleMatcher(match);\r\n\t\tvar res = null;\r\n\t\tthis.visit(function(n){\r\n\t\t\tif(match(n)){\r\n\t\t\t\tres = n;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn res;\r\n\t},\r\n\t/* Apply selection state (internal use only) */\r\n\t_changeSelectStatusAttrs: function(state) {\r\n\t\tvar changed = false,\r\n\t\t\topts = this.tree.options,\r\n\t\t\tunselectable = FT.evalOption(\"unselectable\", this, this, opts, false),\r\n\t\t\tunselectableStatus = FT.evalOption(\"unselectableStatus\", this, this, opts, undefined);\r\n\r\n\t\tif( unselectable && unselectableStatus != null ) {\r\n\t\t\tstate = unselectableStatus;\r\n\t\t}\r\n\t\tswitch(state){\r\n\t\tcase false:\r\n\t\t\tchanged = ( this.selected || this.partsel );\r\n\t\t\tthis.selected = false;\r\n\t\t\tthis.partsel = false;\r\n\t\t\tbreak;\r\n\t\tcase true:\r\n\t\t\tchanged = ( !this.selected || !this.partsel );\r\n\t\t\tthis.selected = true;\r\n\t\t\tthis.partsel = true;\r\n\t\t\tbreak;\r\n\t\tcase undefined:\r\n\t\t\tchanged = ( this.selected || !this.partsel );\r\n\t\t\tthis.selected = false;\r\n\t\t\tthis.partsel = true;\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\t_assert(false, \"invalid state: \" + state);\r\n\t\t}\r\n\t\t// this.debug(\"fixSelection3AfterLoad() _changeSelectStatusAttrs()\", state, changed);\r\n\t\tif( changed ){\r\n\t\t\tthis.renderStatus();\r\n\t\t}\r\n\t\treturn changed;\r\n\t},\r\n\t/**\r\n\t * Fix selection status, after this node was (de)selected in multi-hier mode.\r\n\t * This includes (de)selecting all children.\r\n\t */\r\n\tfixSelection3AfterClick: function(callOpts) {\r\n\t\tvar flag = this.isSelected();\r\n\r\n//\t\tthis.debug(\"fixSelection3AfterClick()\");\r\n\r\n\t\tthis.visit(function(node){\r\n\t\t\tnode._changeSelectStatusAttrs(flag);\r\n\t\t});\r\n\t\tthis.fixSelection3FromEndNodes(callOpts);\r\n\t},\r\n\t/**\r\n\t * Fix selection status for multi-hier mode.\r\n\t * Only end-nodes are considered to update the descendants branch and parents.\r\n\t * Should be called after this node has loaded new children or after\r\n\t * children have been modified using the API.\r\n\t */\r\n\tfixSelection3FromEndNodes: function(callOpts) {\r\n\t\tvar opts = this.tree.options;\r\n\r\n//\t\tthis.debug(\"fixSelection3FromEndNodes()\");\r\n\t\t_assert(opts.selectMode === 3, \"expected selectMode 3\");\r\n\r\n\t\t// Visit all end nodes and adjust their parent's `selected` and `partsel`\r\n\t\t// attributes. Return selection state true, false, or undefined.\r\n\t\tfunction _walk(node){\r\n\t\t\tvar i, l, child, s, state, allSelected, someSelected, unselIgnore, unselState,\r\n\t\t\t\tchildren = node.children;\r\n\r\n\t\t\tif( children && children.length ){\r\n\t\t\t\t// check all children recursively\r\n\t\t\t\tallSelected = true;\r\n\t\t\t\tsomeSelected = false;\r\n\r\n\t\t\t\tfor( i=0, l=children.length; i<l; i++ ){\r\n\t\t\t\t\tchild = children[i];\r\n\t\t\t\t\t// the selection state of a node is not relevant; we need the end-nodes\r\n\t\t\t\t\ts = _walk(child);\r\n\t\t\t\t\t// if( !child.unselectableIgnore ) {\r\n\t\t\t\t\tunselIgnore = FT.evalOption(\"unselectableIgnore\", child, child, opts, false);\r\n\t\t\t\t\tif( !unselIgnore ) {\r\n\t\t\t\t\t\tif( s !== false ) {\r\n\t\t\t\t\t\t\tsomeSelected = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif( s !== true ) {\r\n\t\t\t\t\t\t\tallSelected = false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tstate = allSelected ? true : (someSelected ? undefined : false);\r\n\t\t\t}else{\r\n\t\t\t\t// This is an end-node: simply report the status\r\n\t\t\t\tunselState = FT.evalOption(\"unselectableStatus\", node, node, opts, undefined);\r\n\t\t\t\tstate = ( unselState == null ) ? !!node.selected : !!unselState;\r\n\t\t\t}\r\n\t\t\tnode._changeSelectStatusAttrs(state);\r\n\t\t\treturn state;\r\n\t\t}\r\n\t\t_walk(this);\r\n\r\n\t\t// Update parent's state\r\n\t\tthis.visitParents(function(node){\r\n\t\t\tvar i, l, child, state, unselIgnore, unselState,\r\n\t\t\t\tchildren = node.children,\r\n\t\t\t\tallSelected = true,\r\n\t\t\t\tsomeSelected = false;\r\n\r\n\t\t\tfor( i=0, l=children.length; i<l; i++ ){\r\n\t\t\t\tchild = children[i];\r\n\t\t\t\tunselIgnore = FT.evalOption(\"unselectableIgnore\", child, child, opts, false);\r\n\t\t\t\tif( !unselIgnore ) {\r\n\t\t\t\t\tunselState = FT.evalOption(\"unselectableStatus\", child,  child, opts, undefined);\r\n\t\t\t\t\tstate = ( unselState == null ) ? !!child.selected : !!unselState;\r\n\t\t\t\t\t// When fixing the parents, we trust the sibling status (i.e.\r\n\t\t\t\t\t// we don't recurse)\r\n\t\t\t\t\tif( state || child.partsel ) {\r\n\t\t\t\t\t\tsomeSelected = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( !state ) {\r\n\t\t\t\t\t\tallSelected = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tstate = allSelected ? true : (someSelected ? undefined : false);\r\n\t\t\tnode._changeSelectStatusAttrs(state);\r\n\t\t});\r\n\t},\r\n\t// TODO: focus()\r\n\t/**\r\n\t * Update node data. If dict contains 'children', then also replace\r\n\t * the hole sub tree.\r\n\t * @param {NodeData} dict\r\n\t *\r\n\t * @see FancytreeNode#addChildren\r\n\t * @see FancytreeNode#applyPatch\r\n\t */\r\n\tfromDict: function(dict) {\r\n\t\t// copy all other attributes to this.data.xxx\r\n\t\tfor(var name in dict){\r\n\t\t\tif(NODE_ATTR_MAP[name]){\r\n\t\t\t\t// node.NAME = dict.NAME\r\n\t\t\t\tthis[name] = dict[name];\r\n\t\t\t}else if(name === \"data\"){\r\n\t\t\t\t// node.data += dict.data\r\n\t\t\t\t$.extend(this.data, dict.data);\r\n\t\t\t}else if(!$.isFunction(dict[name]) && !NONE_NODE_DATA_MAP[name]){\r\n\t\t\t\t// node.data.NAME = dict.NAME\r\n\t\t\t\tthis.data[name] = dict[name];\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(dict.children){\r\n\t\t\t// recursively set children and render\r\n\t\t\tthis.removeChildren();\r\n\t\t\tthis.addChildren(dict.children);\r\n\t\t}\r\n\t\tthis.renderTitle();\r\n/*\r\n\t\tvar children = dict.children;\r\n\t\tif(children === undefined){\r\n\t\t\tthis.data = $.extend(this.data, dict);\r\n\t\t\tthis.render();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdict = $.extend({}, dict);\r\n\t\tdict.children = undefined;\r\n\t\tthis.data = $.extend(this.data, dict);\r\n\t\tthis.removeChildren();\r\n\t\tthis.addChild(children);\r\n*/\r\n\t},\r\n\t/** Return the list of child nodes (undefined for unexpanded lazy nodes).\r\n\t * @returns {FancytreeNode[] | undefined}\r\n\t */\r\n\tgetChildren: function() {\r\n\t\tif(this.hasChildren() === undefined){ // TODO: only required for lazy nodes?\r\n\t\t\treturn undefined; // Lazy node: unloaded, currently loading, or load error\r\n\t\t}\r\n\t\treturn this.children;\r\n\t},\r\n\t/** Return the first child node or null.\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetFirstChild: function() {\r\n\t\treturn this.children ? this.children[0] : null;\r\n\t},\r\n\t/** Return the 0-based child index.\r\n\t * @returns {int}\r\n\t */\r\n\tgetIndex: function() {\r\n//\t\treturn this.parent.children.indexOf(this);\r\n\t\treturn $.inArray(this, this.parent.children); // indexOf doesn't work in IE7\r\n\t},\r\n\t/** Return the hierarchical child index (1-based, e.g. '3.2.4').\r\n\t * @param {string} [separator=\".\"]\r\n\t * @param {int} [digits=1]\r\n\t * @returns {string}\r\n\t */\r\n\tgetIndexHier: function(separator, digits) {\r\n\t\tseparator = separator || \".\";\r\n\t\tvar s,\r\n\t\t\tres = [];\r\n\t\t$.each(this.getParentList(false, true), function(i, o){\r\n\t\t\ts = \"\" + (o.getIndex() + 1);\r\n\t\t\tif( digits ){\r\n\t\t\t\t// prepend leading zeroes\r\n\t\t\t\ts = (\"0000000\" + s).substr(-digits);\r\n\t\t\t}\r\n\t\t\tres.push(s);\r\n\t\t});\r\n\t\treturn res.join(separator);\r\n\t},\r\n\t/** Return the parent keys separated by options.keyPathSeparator, e.g. \"id_1/id_17/id_32\".\r\n\t * @param {boolean} [excludeSelf=false]\r\n\t * @returns {string}\r\n\t */\r\n\tgetKeyPath: function(excludeSelf) {\r\n\t\tvar path = [],\r\n\t\t\tsep = this.tree.options.keyPathSeparator;\r\n\t\tthis.visitParents(function(n){\r\n\t\t\tif(n.parent){\r\n\t\t\t\tpath.unshift(n.key);\r\n\t\t\t}\r\n\t\t}, !excludeSelf);\r\n\t\treturn sep + path.join(sep);\r\n\t},\r\n\t/** Return the last child of this node or null.\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetLastChild: function() {\r\n\t\treturn this.children ? this.children[this.children.length - 1] : null;\r\n\t},\r\n\t/** Return node depth. 0: System root node, 1: visible top-level node, 2: first sub-level, ... .\r\n\t * @returns {int}\r\n\t */\r\n\tgetLevel: function() {\r\n\t\tvar level = 0,\r\n\t\t\tdtn = this.parent;\r\n\t\twhile( dtn ) {\r\n\t\t\tlevel++;\r\n\t\t\tdtn = dtn.parent;\r\n\t\t}\r\n\t\treturn level;\r\n\t},\r\n\t/** Return the successor node (under the same parent) or null.\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetNextSibling: function() {\r\n\t\t// TODO: use indexOf, if available: (not in IE6)\r\n\t\tif( this.parent ){\r\n\t\t\tvar i, l,\r\n\t\t\t\tac = this.parent.children;\r\n\r\n\t\t\tfor(i=0, l=ac.length-1; i<l; i++){ // up to length-2, so next(last) = null\r\n\t\t\t\tif( ac[i] === this ){\r\n\t\t\t\t\treturn ac[i+1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t/** Return the parent node (null for the system root node).\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetParent: function() {\r\n\t\t// TODO: return null for top-level nodes?\r\n\t\treturn this.parent;\r\n\t},\r\n\t/** Return an array of all parent nodes (top-down).\r\n\t * @param {boolean} [includeRoot=false] Include the invisible system root node.\r\n\t * @param {boolean} [includeSelf=false] Include the node itself.\r\n\t * @returns {FancytreeNode[]}\r\n\t */\r\n\tgetParentList: function(includeRoot, includeSelf) {\r\n\t\tvar l = [],\r\n\t\t\tdtn = includeSelf ? this : this.parent;\r\n\t\twhile( dtn ) {\r\n\t\t\tif( includeRoot || dtn.parent ){\r\n\t\t\t\tl.unshift(dtn);\r\n\t\t\t}\r\n\t\t\tdtn = dtn.parent;\r\n\t\t}\r\n\t\treturn l;\r\n\t},\r\n\t/** Return the predecessor node (under the same parent) or null.\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetPrevSibling: function() {\r\n\t\tif( this.parent ){\r\n\t\t\tvar i, l,\r\n\t\t\t\tac = this.parent.children;\r\n\r\n\t\t\tfor(i=1, l=ac.length; i<l; i++){ // start with 1, so prev(first) = null\r\n\t\t\t\tif( ac[i] === this ){\r\n\t\t\t\t\treturn ac[i-1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t/**\r\n\t * Return an array of selected descendant nodes.\r\n\t * @param {boolean} [stopOnParents=false] only return the topmost selected\r\n\t *     node (useful with selectMode 3)\r\n\t * @returns {FancytreeNode[]}\r\n\t */\r\n\tgetSelectedNodes: function(stopOnParents) {\r\n\t\tvar nodeList = [];\r\n\t\tthis.visit(function(node){\r\n\t\t\tif( node.selected ) {\r\n\t\t\t\tnodeList.push(node);\r\n\t\t\t\tif( stopOnParents === true ){\r\n\t\t\t\t\treturn \"skip\"; // stop processing this branch\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn nodeList;\r\n\t},\r\n\t/** Return true if node has children. Return undefined if not sure, i.e. the node is lazy and not yet loaded).\r\n\t * @returns {boolean | undefined}\r\n\t */\r\n\thasChildren: function() {\r\n\t\tif(this.lazy){\r\n\t\t\tif(this.children == null ){\r\n\t\t\t\t// null or undefined: Not yet loaded\r\n\t\t\t\treturn undefined;\r\n\t\t\t}else if(this.children.length === 0){\r\n\t\t\t\t// Loaded, but response was empty\r\n\t\t\t\treturn false;\r\n\t\t\t}else if(this.children.length === 1 && this.children[0].isStatusNode() ){\r\n\t\t\t\t// Currently loading or load error\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn !!( this.children && this.children.length );\r\n\t},\r\n\t/** Return true if node has keyboard focus.\r\n\t * @returns {boolean}\r\n\t */\r\n\thasFocus: function() {\r\n\t\treturn (this.tree.hasFocus() && this.tree.focusNode === this);\r\n\t},\r\n\t/** Write to browser console if debugLevel >= 1 (prepending node info)\r\n\t *\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\tinfo: function(msg){\r\n\t\tif( this.tree.options.debugLevel >= 1 ) {\r\n\t\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\t\tconsoleApply(\"info\", arguments);\r\n\t\t}\r\n\t},\r\n\t/** Return true if node is active (see also FancytreeNode#isSelected).\r\n\t * @returns {boolean}\r\n\t */\r\n\tisActive: function() {\r\n\t\treturn (this.tree.activeNode === this);\r\n\t},\r\n\t/** Return true if node is a direct child of otherNode.\r\n\t * @param {FancytreeNode} otherNode\r\n\t * @returns {boolean}\r\n\t */\r\n\tisChildOf: function(otherNode) {\r\n\t\treturn (this.parent && this.parent === otherNode);\r\n\t},\r\n\t/** Return true, if node is a direct or indirect sub node of otherNode.\r\n\t * @param {FancytreeNode} otherNode\r\n\t * @returns {boolean}\r\n\t */\r\n\tisDescendantOf: function(otherNode) {\r\n\t\tif(!otherNode || otherNode.tree !== this.tree){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar p = this.parent;\r\n\t\twhile( p ) {\r\n\t\t\tif( p === otherNode ){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tif( p === p.parent ) { $.error(\"Recursive parent link: \" + p); }\r\n\t\t\tp = p.parent;\r\n\t\t}\r\n\t\treturn false;\r\n\t},\r\n\t/** Return true if node is expanded.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisExpanded: function() {\r\n\t\treturn !!this.expanded;\r\n\t},\r\n\t/** Return true if node is the first node of its parent's children.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisFirstSibling: function() {\r\n\t\tvar p = this.parent;\r\n\t\treturn !p || p.children[0] === this;\r\n\t},\r\n\t/** Return true if node is a folder, i.e. has the node.folder attribute set.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisFolder: function() {\r\n\t\treturn !!this.folder;\r\n\t},\r\n\t/** Return true if node is the last node of its parent's children.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisLastSibling: function() {\r\n\t\tvar p = this.parent;\r\n\t\treturn !p || p.children[p.children.length-1] === this;\r\n\t},\r\n\t/** Return true if node is lazy (even if data was already loaded)\r\n\t * @returns {boolean}\r\n\t */\r\n\tisLazy: function() {\r\n\t\treturn !!this.lazy;\r\n\t},\r\n\t/** Return true if node is lazy and loaded. For non-lazy nodes always return true.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisLoaded: function() {\r\n\t\treturn !this.lazy || this.hasChildren() !== undefined; // Also checks if the only child is a status node\r\n\t},\r\n\t/** Return true if children are currently beeing loaded, i.e. a Ajax request is pending.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisLoading: function() {\r\n\t\treturn !!this._isLoading;\r\n\t},\r\n\t/*\r\n\t * @deprecated since v2.4.0:  Use isRootNode() instead\r\n\t */\r\n\tisRoot: function() {\r\n\t\treturn this.isRootNode();\r\n\t},\r\n\t/** Return true if node is partially selected (tri-state).\r\n\t * @returns {boolean}\r\n\t * @since 2.23\r\n\t */\r\n\tisPartsel: function() {\r\n\t\treturn !this.selected && !!this.partsel;\r\n\t},\r\n\t/** (experimental) Return true if this is partially loaded.\r\n\t * @returns {boolean}\r\n\t * @since 2.15\r\n\t */\r\n\tisPartload: function() {\r\n\t\treturn !!this.partload;\r\n\t},\r\n\t/** Return true if this is the (invisible) system root node.\r\n\t * @returns {boolean}\r\n\t * @since 2.4\r\n\t */\r\n\tisRootNode: function() {\r\n\t\treturn (this.tree.rootNode === this);\r\n\t},\r\n\t/** Return true if node is selected, i.e. has a checkmark set (see also FancytreeNode#isActive).\r\n\t * @returns {boolean}\r\n\t */\r\n\tisSelected: function() {\r\n\t\treturn !!this.selected;\r\n\t},\r\n\t/** Return true if this node is a temporarily generated system node like\r\n\t * 'loading', 'paging', or 'error' (node.statusNodeType contains the type).\r\n\t * @returns {boolean}\r\n\t */\r\n\tisStatusNode: function() {\r\n\t\treturn !!this.statusNodeType;\r\n\t},\r\n\t/** Return true if this node is a status node of type 'paging'.\r\n\t * @returns {boolean}\r\n\t * @since 2.15\r\n\t */\r\n\tisPagingNode: function() {\r\n\t\treturn this.statusNodeType === \"paging\";\r\n\t},\r\n\t/** Return true if this a top level node, i.e. a direct child of the (invisible) system root node.\r\n\t * @returns {boolean}\r\n\t * @since 2.4\r\n\t */\r\n\tisTopLevel: function() {\r\n\t\treturn (this.tree.rootNode === this.parent);\r\n\t},\r\n\t/** Return true if node is lazy and not yet loaded. For non-lazy nodes always return false.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisUndefined: function() {\r\n\t\treturn this.hasChildren() === undefined; // also checks if the only child is a status node\r\n\t},\r\n\t/** Return true if all parent nodes are expanded. Note: this does not check\r\n\t * whether the node is scrolled into the visible part of the screen.\r\n\t * @returns {boolean}\r\n\t */\r\n\tisVisible: function() {\r\n\t\tvar i, l,\r\n\t\t\tparents = this.getParentList(false, false);\r\n\r\n\t\tfor(i=0, l=parents.length; i<l; i++){\r\n\t\t\tif( ! parents[i].expanded ){ return false; }\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t/** Deprecated.\r\n\t * @deprecated since 2014-02-16: use load() instead.\r\n\t */\r\n\tlazyLoad: function(discard) {\r\n\t\tthis.warn(\"FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead.\");\r\n\t\treturn this.load(discard);\r\n\t},\r\n\t/**\r\n\t * Load all children of a lazy node if neccessary. The <i>expanded</i> state is maintained.\r\n\t * @param {boolean} [forceReload=false] Pass true to discard any existing nodes before. Otherwise this method does nothing if the node was already loaded.\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tload: function(forceReload) {\r\n\t\tvar res, source,\r\n\t\t\tthat = this,\r\n\t\t\twasExpanded = this.isExpanded();\r\n\r\n\t\t_assert( this.isLazy(), \"load() requires a lazy node\" );\r\n\t\t// _assert( forceReload || this.isUndefined(), \"Pass forceReload=true to re-load a lazy node\" );\r\n\t\tif( !forceReload && !this.isUndefined() ) {\r\n\t\t\treturn _getResolvedPromise(this);\r\n\t\t}\r\n\t\tif( this.isLoaded() ){\r\n\t\t\tthis.resetLazy(); // also collapses\r\n\t\t}\r\n\t\t// This method is also called by setExpanded() and loadKeyPath(), so we\r\n\t\t// have to avoid recursion.\r\n\t\tsource = this.tree._triggerNodeEvent(\"lazyLoad\", this);\r\n\t\tif( source === false ) { // #69\r\n\t\t\treturn _getResolvedPromise(this);\r\n\t\t}\r\n\t\t_assert(typeof source !== \"boolean\", \"lazyLoad event must return source in data.result\");\r\n\t\tres = this.tree._callHook(\"nodeLoadChildren\", this, source);\r\n\t\tif( wasExpanded ) {\r\n\t\t\tthis.expanded = true;\r\n\t\t\tres.always(function(){\r\n\t\t\t\tthat.render();\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tres.always(function(){\r\n\t\t\t\tthat.renderStatus();  // fix expander icon to 'loaded'\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/** Expand all parents and optionally scroll into visible area as neccessary.\r\n\t * Promise is resolved, when lazy loading and animations are done.\r\n\t * @param {object} [opts] passed to `setExpanded()`.\r\n\t *     Defaults to {noAnimation: false, noEvents: false, scrollIntoView: true}\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tmakeVisible: function(opts) {\r\n\t\tvar i,\r\n\t\t\tthat = this,\r\n\t\t\tdeferreds = [],\r\n\t\t\tdfd = new $.Deferred(),\r\n\t\t\tparents = this.getParentList(false, false),\r\n\t\t\tlen = parents.length,\r\n\t\t\teffects = !(opts && opts.noAnimation === true),\r\n\t\t\tscroll = !(opts && opts.scrollIntoView === false);\r\n\r\n\t\t// Expand bottom-up, so only the top node is animated\r\n\t\tfor(i = len - 1; i >= 0; i--){\r\n\t\t\t// that.debug(\"pushexpand\" + parents[i]);\r\n\t\t\tdeferreds.push(parents[i].setExpanded(true, opts));\r\n\t\t}\r\n\t\t$.when.apply($, deferreds).done(function(){\r\n\t\t\t// All expands have finished\r\n\t\t\t// that.debug(\"expand DONE\", scroll);\r\n\t\t\tif( scroll ){\r\n\t\t\t\tthat.scrollIntoView(effects).done(function(){\r\n\t\t\t\t\t// that.debug(\"scroll DONE\");\r\n\t\t\t\t\tdfd.resolve();\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tdfd.resolve();\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn dfd.promise();\r\n\t},\r\n\t/** Move this node to targetNode.\r\n\t *  @param {FancytreeNode} targetNode\r\n\t *  @param {string} mode <pre>\r\n\t *      'child': append this node as last child of targetNode.\r\n\t *               This is the default. To be compatble with the D'n'd\r\n\t *               hitMode, we also accept 'over'.\r\n\t *      'firstChild': add this node as first child of targetNode.\r\n\t *      'before': add this node as sibling before targetNode.\r\n\t *      'after': add this node as sibling after targetNode.</pre>\r\n\t *  @param {function} [map] optional callback(FancytreeNode) to allow modifcations\r\n\t */\r\n\tmoveTo: function(targetNode, mode, map) {\r\n\t\tif(mode === undefined || mode === \"over\"){\r\n\t\t\tmode = \"child\";\r\n\t\t} else if ( mode === \"firstChild\" ) {\r\n\t\t\tif( targetNode.children && targetNode.children.length ) {\r\n\t\t\t\tmode = \"before\";\r\n\t\t\t\ttargetNode = targetNode.children[0];\r\n\t\t\t} else {\r\n\t\t\t\tmode = \"child\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar pos,\r\n\t\t\tprevParent = this.parent,\r\n\t\t\ttargetParent = (mode === \"child\") ? targetNode : targetNode.parent;\r\n\r\n\t\tif(this === targetNode){\r\n\t\t\treturn;\r\n\t\t}else if( !this.parent  ){\r\n\t\t\t$.error(\"Cannot move system root\");\r\n\t\t}else if( targetParent.isDescendantOf(this) ){\r\n\t\t\t$.error(\"Cannot move a node to its own descendant\");\r\n\t\t}\r\n\t\tif( targetParent !== prevParent ) {\r\n\t\t\tprevParent.triggerModifyChild(\"remove\", this);\r\n\t\t}\r\n\t\t// Unlink this node from current parent\r\n\t\tif( this.parent.children.length === 1 ) {\r\n\t\t\tif( this.parent === targetParent ){\r\n\t\t\t\treturn; // #258\r\n\t\t\t}\r\n\t\t\tthis.parent.children = this.parent.lazy ? [] : null;\r\n\t\t\tthis.parent.expanded = false;\r\n\t\t} else {\r\n\t\t\tpos = $.inArray(this, this.parent.children);\r\n\t\t\t_assert(pos >= 0, \"invalid source parent\");\r\n\t\t\tthis.parent.children.splice(pos, 1);\r\n\t\t}\r\n\t\t// Remove from source DOM parent\r\n//\t\tif(this.parent.ul){\r\n//\t\t\tthis.parent.ul.removeChild(this.li);\r\n//\t\t}\r\n\r\n\t\t// Insert this node to target parent's child list\r\n\t\tthis.parent = targetParent;\r\n\t\tif( targetParent.hasChildren() ) {\r\n\t\t\tswitch(mode) {\r\n\t\t\tcase \"child\":\r\n\t\t\t\t// Append to existing target children\r\n\t\t\t\ttargetParent.children.push(this);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"before\":\r\n\t\t\t\t// Insert this node before target node\r\n\t\t\t\tpos = $.inArray(targetNode, targetParent.children);\r\n\t\t\t\t_assert(pos >= 0, \"invalid target parent\");\r\n\t\t\t\ttargetParent.children.splice(pos, 0, this);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"after\":\r\n\t\t\t\t// Insert this node after target node\r\n\t\t\t\tpos = $.inArray(targetNode, targetParent.children);\r\n\t\t\t\t_assert(pos >= 0, \"invalid target parent\");\r\n\t\t\t\ttargetParent.children.splice(pos+1, 0, this);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t$.error(\"Invalid mode \" + mode);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttargetParent.children = [ this ];\r\n\t\t}\r\n\t\t// Parent has no <ul> tag yet:\r\n//\t\tif( !targetParent.ul ) {\r\n//\t\t\t// This is the parent's first child: create UL tag\r\n//\t\t\t// (Hidden, because it will be\r\n//\t\t\ttargetParent.ul = document.createElement(\"ul\");\r\n//\t\t\ttargetParent.ul.style.display = \"none\";\r\n//\t\t\ttargetParent.li.appendChild(targetParent.ul);\r\n//\t\t}\r\n//\t\t// Issue 319: Add to target DOM parent (only if node was already rendered(expanded))\r\n//\t\tif(this.li){\r\n//\t\t\ttargetParent.ul.appendChild(this.li);\r\n//\t\t}^\r\n\r\n\t\t// Let caller modify the nodes\r\n\t\tif( map ){\r\n\t\t\ttargetNode.visit(map, true);\r\n\t\t}\r\n\t\tif( targetParent === prevParent ) {\r\n\t\t\ttargetParent.triggerModifyChild(\"move\", this);\r\n\t\t} else {\r\n\t\t\t// prevParent.triggerModifyChild(\"remove\", this);\r\n\t\t\ttargetParent.triggerModifyChild(\"add\", this);\r\n\t\t}\r\n\t\t// Handle cross-tree moves\r\n\t\tif( this.tree !== targetNode.tree ) {\r\n\t\t\t// Fix node.tree for all source nodes\r\n//\t\t\t_assert(false, \"Cross-tree move is not yet implemented.\");\r\n\t\t\tthis.warn(\"Cross-tree moveTo is experimantal!\");\r\n\t\t\tthis.visit(function(n){\r\n\t\t\t\t// TODO: fix selection state and activation, ...\r\n\t\t\t\tn.tree = targetNode.tree;\r\n\t\t\t}, true);\r\n\t\t}\r\n\r\n\t\t// A collaposed node won't re-render children, so we have to remove it manually\r\n\t\t// if( !targetParent.expanded ){\r\n\t\t//   prevParent.ul.removeChild(this.li);\r\n\t\t// }\r\n\r\n\t\t// Update HTML markup\r\n\t\tif( !prevParent.isDescendantOf(targetParent)) {\r\n\t\t\tprevParent.render();\r\n\t\t}\r\n\t\tif( !targetParent.isDescendantOf(prevParent) && targetParent !== prevParent) {\r\n\t\t\ttargetParent.render();\r\n\t\t}\r\n\t\t// TODO: fix selection state\r\n\t\t// TODO: fix active state\r\n\r\n/*\r\n\t\tvar tree = this.tree;\r\n\t\tvar opts = tree.options;\r\n\t\tvar pers = tree.persistence;\r\n\r\n\r\n\t\t// Always expand, if it's below minExpandLevel\r\n//\t\ttree.logDebug (\"%s._addChildNode(%o), l=%o\", this, ftnode, ftnode.getLevel());\r\n\t\tif ( opts.minExpandLevel >= ftnode.getLevel() ) {\r\n//\t\t\ttree.logDebug (\"Force expand for %o\", ftnode);\r\n\t\t\tthis.bExpanded = true;\r\n\t\t}\r\n\r\n\t\t// In multi-hier mode, update the parents selection state\r\n\t\t// DT issue #82: only if not initializing, because the children may not exist yet\r\n//\t\tif( !ftnode.data.isStatusNode() && opts.selectMode==3 && !isInitializing )\r\n//\t\t\tftnode._fixSelectionState();\r\n\r\n\t\t// In multi-hier mode, update the parents selection state\r\n\t\tif( ftnode.bSelected && opts.selectMode==3 ) {\r\n\t\t\tvar p = this;\r\n\t\t\twhile( p ) {\r\n\t\t\t\tif( !p.hasSubSel )\r\n\t\t\t\t\tp._setSubSel(true);\r\n\t\t\t\tp = p.parent;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// render this node and the new child\r\n\t\tif ( tree.bEnableUpdate )\r\n\t\t\tthis.render();\r\n\r\n\t\treturn ftnode;\r\n\r\n*/\r\n\t},\r\n\t/** Set focus relative to this node and optionally activate.\r\n\t *\r\n\t * @param {number} where The keyCode that would normally trigger this move,\r\n\t *\t\te.g. `$.ui.keyCode.LEFT` would collapse the node if it\r\n\t *      is expanded or move to the parent oterwise.\r\n\t * @param {boolean} [activate=true]\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tnavigate: function(where, activate) {\r\n\t\tvar i, parents, res,\r\n\t\t\thandled = true,\r\n\t\t\tKC = $.ui.keyCode,\r\n\t\t\tsib = null;\r\n\r\n\t\t// Navigate to node\r\n\t\tfunction _goto(n){\r\n\t\t\tif( n ){\r\n\t\t\t\t// setFocus/setActive will scroll later (if autoScroll is specified)\r\n\t\t\t\ttry { n.makeVisible({scrollIntoView: false}); } catch(e) {} // #272\r\n\t\t\t\t// Node may still be hidden by a filter\r\n\t\t\t\tif( ! $(n.span).is(\":visible\") ) {\r\n\t\t\t\t\tn.debug(\"Navigate: skipping hidden node\");\r\n\t\t\t\t\tn.navigate(where, activate);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\treturn activate === false ? n.setFocus() : n.setActive();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tswitch( where ) {\r\n\t\t\tcase KC.BACKSPACE:\r\n\t\t\t\tif( this.parent && this.parent.parent ) {\r\n\t\t\t\t\tres = _goto(this.parent);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase KC.HOME:\r\n\t\t\t\tthis.tree.visit(function(n){  // goto first visible node\r\n\t\t\t\t\tif( $(n.span).is(\":visible\") ) {\r\n\t\t\t\t\t\tres = _goto(n);\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tbreak;\r\n\t\t\tcase KC.END:\r\n\t\t\t\tthis.tree.visit(function(n){  // goto last visible node\r\n\t\t\t\t\tif( $(n.span).is(\":visible\") ) {\r\n\t\t\t\t\t\tres = n;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tif( res ) {\r\n\t\t\t\t\tres = _goto(res);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase KC.LEFT:\r\n\t\t\t\tif( this.expanded ) {\r\n\t\t\t\t\tthis.setExpanded(false);\r\n\t\t\t\t\tres = _goto(this);\r\n\t\t\t\t} else if( this.parent && this.parent.parent ) {\r\n\t\t\t\t\tres = _goto(this.parent);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase KC.RIGHT:\r\n\t\t\t\tif( !this.expanded && (this.children || this.lazy) ) {\r\n\t\t\t\t\tthis.setExpanded();\r\n\t\t\t\t\tres = _goto(this);\r\n\t\t\t\t} else if( this.children && this.children.length ) {\r\n\t\t\t\t\tres = _goto(this.children[0]);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase KC.UP:\r\n\t\t\t\tsib = this.getPrevSibling();\r\n\t\t\t\t// #359: skip hidden sibling nodes, preventing a _goto() recursion\r\n\t\t\t\twhile( sib && !$(sib.span).is(\":visible\") ) {\r\n\t\t\t\t\tsib = sib.getPrevSibling();\r\n\t\t\t\t}\r\n\t\t\t\twhile( sib && sib.expanded && sib.children && sib.children.length ) {\r\n\t\t\t\t\tsib = sib.children[sib.children.length - 1];\r\n\t\t\t\t}\r\n\t\t\t\tif( !sib && this.parent && this.parent.parent ){\r\n\t\t\t\t\tsib = this.parent;\r\n\t\t\t\t}\r\n\t\t\t\tres = _goto(sib);\r\n\t\t\t\tbreak;\r\n\t\t\tcase KC.DOWN:\r\n\t\t\t\tif( this.expanded && this.children && this.children.length ) {\r\n\t\t\t\t\tsib = this.children[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tparents = this.getParentList(false, true);\r\n\t\t\t\t\tfor(i=parents.length-1; i>=0; i--) {\r\n\t\t\t\t\t\tsib = parents[i].getNextSibling();\r\n\t\t\t\t\t\t// #359: skip hidden sibling nodes, preventing a _goto() recursion\r\n\t\t\t\t\t\twhile( sib && !$(sib.span).is(\":visible\") ) {\r\n\t\t\t\t\t\t\tsib = sib.getNextSibling();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif( sib ){ break; }\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tres = _goto(sib);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\thandled = false;\r\n\t\t}\r\n\t\treturn res || _getResolvedPromise();\r\n\t},\r\n\t/**\r\n\t * Remove this node (not allowed for system root).\r\n\t */\r\n\tremove: function() {\r\n\t\treturn this.parent.removeChild(this);\r\n\t},\r\n\t/**\r\n\t * Remove childNode from list of direct children.\r\n\t * @param {FancytreeNode} childNode\r\n\t */\r\n\tremoveChild: function(childNode) {\r\n\t\treturn this.tree._callHook(\"nodeRemoveChild\", this, childNode);\r\n\t},\r\n\t/**\r\n\t * Remove all child nodes and descendents. This converts the node into a leaf.<br>\r\n\t * If this was a lazy node, it is still considered 'loaded'; call node.resetLazy()\r\n\t * in order to trigger lazyLoad on next expand.\r\n\t */\r\n\tremoveChildren: function() {\r\n\t\treturn this.tree._callHook(\"nodeRemoveChildren\", this);\r\n\t},\r\n\t/**\r\n\t * Remove class from node's span tag and .extraClasses.\r\n\t *\r\n\t * @param {string} className class name\r\n\t *\r\n\t * @since 2.17\r\n\t */\r\n\tremoveClass: function(className){\r\n\t\treturn this.toggleClass(className, false);\r\n\t},\r\n\t/**\r\n\t * This method renders and updates all HTML markup that is required\r\n\t * to display this node in its current state.<br>\r\n\t * Note:\r\n\t * <ul>\r\n\t * <li>It should only be neccessary to call this method after the node object\r\n\t *     was modified by direct access to its properties, because the common\r\n\t *     API methods (node.setTitle(), moveTo(), addChildren(), remove(), ...)\r\n\t *     already handle this.\r\n\t * <li> {@link FancytreeNode#renderTitle} and {@link FancytreeNode#renderStatus}\r\n\t *     are implied. If changes are more local, calling only renderTitle() or\r\n\t *     renderStatus() may be sufficient and faster.\r\n\t * </ul>\r\n\t *\r\n\t * @param {boolean} [force=false] re-render, even if html markup was already created\r\n\t * @param {boolean} [deep=false] also render all descendants, even if parent is collapsed\r\n\t */\r\n\trender: function(force, deep) {\r\n\t\treturn this.tree._callHook(\"nodeRender\", this, force, deep);\r\n\t},\r\n\t/** Create HTML markup for the node's outer &lt;span> (expander, checkbox, icon, and title).\r\n\t * Implies {@link FancytreeNode#renderStatus}.\r\n\t * @see Fancytree_Hooks#nodeRenderTitle\r\n\t */\r\n\trenderTitle: function() {\r\n\t\treturn this.tree._callHook(\"nodeRenderTitle\", this);\r\n\t},\r\n\t/** Update element's CSS classes according to node state.\r\n\t * @see Fancytree_Hooks#nodeRenderStatus\r\n\t */\r\n\trenderStatus: function() {\r\n\t\treturn this.tree._callHook(\"nodeRenderStatus\", this);\r\n\t},\r\n\t/**\r\n\t * (experimental) Replace this node with `source`.\r\n\t * (Currently only available for paging nodes.)\r\n\t * @param {NodeData[]} source List of child node definitions\r\n\t * @since 2.15\r\n\t */\r\n\treplaceWith: function(source) {\r\n\t\tvar res,\r\n\t\t\tparent = this.parent,\r\n\t\t\tpos = $.inArray(this, parent.children),\r\n\t\t\tthat = this;\r\n\r\n\t\t_assert( this.isPagingNode(), \"replaceWith() currently requires a paging status node\" );\r\n\r\n\t\tres = this.tree._callHook(\"nodeLoadChildren\", this, source);\r\n\t\tres.done(function(data){\r\n\t\t\t// New nodes are currently children of `this`.\r\n\t\t\tvar children = that.children;\r\n\t\t\t// Prepend newly loaded child nodes to `this`\r\n\t\t\t// Move new children after self\r\n\t\t\tfor( i=0; i<children.length; i++ ) {\r\n\t\t\t\tchildren[i].parent = parent;\r\n\t\t\t}\r\n\t\t\tparent.children.splice.apply(parent.children, [pos + 1, 0].concat(children));\r\n\r\n\t\t\t// Remove self\r\n\t\t\tthat.children = null;\r\n\t\t\tthat.remove();\r\n\t\t\t// Redraw new nodes\r\n\t\t\tparent.render();\r\n\t\t\t// TODO: set node.partload = false if this was tha last paging node?\r\n\t\t\t// parent.addPagingNode(false);\r\n\t\t}).fail(function(){\r\n\t\t\tthat.setExpanded();\r\n\t\t});\r\n\t\treturn res;\r\n\t\t// $.error(\"Not implemented: replaceWith()\");\r\n\t},\r\n\t/**\r\n\t * Remove all children, collapse, and set the lazy-flag, so that the lazyLoad\r\n\t * event is triggered on next expand.\r\n\t */\r\n\tresetLazy: function() {\r\n\t\tthis.removeChildren();\r\n\t\tthis.expanded = false;\r\n\t\tthis.lazy = true;\r\n\t\tthis.children = undefined;\r\n\t\tthis.renderStatus();\r\n\t},\r\n\t/** Schedule activity for delayed execution (cancel any pending request).\r\n\t *  scheduleAction('cancel') will only cancel a pending request (if any).\r\n\t * @param {string} mode\r\n\t * @param {number} ms\r\n\t */\r\n\tscheduleAction: function(mode, ms) {\r\n\t\tif( this.tree.timer ) {\r\n\t\t\tclearTimeout(this.tree.timer);\r\n//            this.tree.debug(\"clearTimeout(%o)\", this.tree.timer);\r\n\t\t}\r\n\t\tthis.tree.timer = null;\r\n\t\tvar self = this; // required for closures\r\n\t\tswitch (mode) {\r\n\t\tcase \"cancel\":\r\n\t\t\t// Simply made sure that timer was cleared\r\n\t\t\tbreak;\r\n\t\tcase \"expand\":\r\n\t\t\tthis.tree.timer = setTimeout(function(){\r\n\t\t\t\tself.tree.debug(\"setTimeout: trigger expand\");\r\n\t\t\t\tself.setExpanded(true);\r\n\t\t\t}, ms);\r\n\t\t\tbreak;\r\n\t\tcase \"activate\":\r\n\t\t\tthis.tree.timer = setTimeout(function(){\r\n\t\t\t\tself.tree.debug(\"setTimeout: trigger activate\");\r\n\t\t\t\tself.setActive(true);\r\n\t\t\t}, ms);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\t$.error(\"Invalid mode \" + mode);\r\n\t\t}\r\n//        this.tree.debug(\"setTimeout(%s, %s): %s\", mode, ms, this.tree.timer);\r\n\t},\r\n\t/**\r\n\t *\r\n\t * @param {boolean | PlainObject} [effects=false] animation options.\r\n\t * @param {object} [options=null] {topNode: null, effects: ..., parent: ...} this node will remain visible in\r\n\t *     any case, even if `this` is outside the scroll pane.\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tscrollIntoView: function(effects, options) {\r\n\t\tif( options !== undefined && _isNode(options) ) {\r\n\t\t\tthis.warn(\"scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead.\");\r\n\t\t\toptions = {topNode: options};\r\n\t\t}\r\n\t\t// this.$scrollParent = (this.options.scrollParent === \"auto\") ? $ul.scrollParent() : $(this.options.scrollParent);\r\n\t\t// this.$scrollParent = this.$scrollParent.length ? this.$scrollParent || this.$container;\r\n\r\n\t\tvar topNodeY, nodeY, horzScrollbarHeight, containerOffsetTop,\r\n\t\t\topts = $.extend({\r\n\t\t\t\teffects: (effects === true) ? {duration: 200, queue: false} : effects,\r\n\t\t\t\tscrollOfs: this.tree.options.scrollOfs,\r\n\t\t\t\tscrollParent: this.tree.options.scrollParent || this.tree.$container,\r\n\t\t\t\ttopNode: null\r\n\t\t\t}, options),\r\n\t\t\tdfd = new $.Deferred(),\r\n\t\t\tthat = this,\r\n\t\t\tnodeHeight = $(this.span).height(),\r\n\t\t\t$container = $(opts.scrollParent),\r\n\t\t\ttopOfs = opts.scrollOfs.top || 0,\r\n\t\t\tbottomOfs = opts.scrollOfs.bottom || 0,\r\n\t\t\tcontainerHeight = $container.height(),// - topOfs - bottomOfs,\r\n\t\t\tscrollTop = $container.scrollTop(),\r\n\t\t\t$animateTarget = $container,\r\n\t\t\tisParentWindow = $container[0] === window,\r\n\t\t\ttopNode = opts.topNode || null,\r\n\t\t\tnewScrollTop = null;\r\n\r\n\t\t// this.debug(\"scrollIntoView(), scrollTop=\" + scrollTop, opts.scrollOfs);\r\n//\t\t_assert($(this.span).is(\":visible\"), \"scrollIntoView node is invisible\"); // otherwise we cannot calc offsets\r\n\t\tif( !$(this.span).is(\":visible\") ) {\r\n\t\t\t// We cannot calc offsets for hidden elements\r\n\t\t\tthis.warn(\"scrollIntoView(): node is invisible.\");\r\n\t\t\treturn _getResolvedPromise();\r\n\t\t}\r\n\t\tif( isParentWindow ) {\r\n\t\t\tnodeY = $(this.span).offset().top;\r\n\t\t\ttopNodeY = (topNode && topNode.span) ? $(topNode.span).offset().top : 0;\r\n\t\t\t$animateTarget = $(\"html,body\");\r\n\r\n\t\t} else {\r\n\t\t\t_assert($container[0] !== document && $container[0] !== document.body,\r\n\t\t\t\t\"scrollParent should be a simple element or `window`, not document or body.\");\r\n\r\n\t\t\tcontainerOffsetTop = $container.offset().top,\r\n\t\t\tnodeY = $(this.span).offset().top - containerOffsetTop + scrollTop; // relative to scroll parent\r\n\t\t\ttopNodeY = topNode ? $(topNode.span).offset().top - containerOffsetTop + scrollTop : 0;\r\n\t\t\thorzScrollbarHeight = Math.max(0, ($container.innerHeight() - $container[0].clientHeight));\r\n\t\t\tcontainerHeight -= horzScrollbarHeight;\r\n\t\t}\r\n\r\n\t\t// this.debug(\"    scrollIntoView(), nodeY=\" + nodeY + \", containerHeight=\" + containerHeight);\r\n\t\tif( nodeY < (scrollTop + topOfs) ){\r\n\t\t\t// Node is above visible container area\r\n\t\t\tnewScrollTop = nodeY - topOfs;\r\n\t\t\t// this.debug(\"    scrollIntoView(), UPPER newScrollTop=\" + newScrollTop);\r\n\r\n\t\t}else if((nodeY + nodeHeight) > (scrollTop + containerHeight - bottomOfs)){\r\n\t\t\tnewScrollTop = nodeY + nodeHeight - containerHeight + bottomOfs;\r\n\t\t\t// this.debug(\"    scrollIntoView(), LOWER newScrollTop=\" + newScrollTop);\r\n\t\t\t// If a topNode was passed, make sure that it is never scrolled\r\n\t\t\t// outside the upper border\r\n\t\t\tif(topNode){\r\n\t\t\t\t_assert(topNode.isRootNode() || $(topNode.span).is(\":visible\"), \"topNode must be visible\");\r\n\t\t\t\tif( topNodeY < newScrollTop ){\r\n\t\t\t\t\tnewScrollTop = topNodeY - topOfs;\r\n\t\t\t\t\t// this.debug(\"    scrollIntoView(), TOP newScrollTop=\" + newScrollTop);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(newScrollTop !== null){\r\n\t\t\t// this.debug(\"    scrollIntoView(), SET newScrollTop=\" + newScrollTop);\r\n\t\t\tif(opts.effects){\r\n\t\t\t\topts.effects.complete = function(){\r\n\t\t\t\t\tdfd.resolveWith(that);\r\n\t\t\t\t};\r\n\t\t\t\t$animateTarget.stop(true).animate({\r\n\t\t\t\t\tscrollTop: newScrollTop\r\n\t\t\t\t}, opts.effects);\r\n\t\t\t}else{\r\n\t\t\t\t$animateTarget[0].scrollTop = newScrollTop;\r\n\t\t\t\tdfd.resolveWith(this);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tdfd.resolveWith(this);\r\n\t\t}\r\n\t\treturn dfd.promise();\r\n\t},\r\n\r\n\t/**Activate this node.\r\n\t * @param {boolean} [flag=true] pass false to deactivate\r\n\t * @param {object} [opts] additional options. Defaults to {noEvents: false, noFocus: false}\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tsetActive: function(flag, opts){\r\n\t\treturn this.tree._callHook(\"nodeSetActive\", this, flag, opts);\r\n\t},\r\n\t/**Expand or collapse this node. Promise is resolved, when lazy loading and animations are done.\r\n\t * @param {boolean} [flag=true] pass false to collapse\r\n\t * @param {object} [opts] additional options. Defaults to {noAnimation: false, noEvents: false}\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tsetExpanded: function(flag, opts){\r\n\t\treturn this.tree._callHook(\"nodeSetExpanded\", this, flag, opts);\r\n\t},\r\n\t/**Set keyboard focus to this node.\r\n\t * @param {boolean} [flag=true] pass false to blur\r\n\t * @see Fancytree#setFocus\r\n\t */\r\n\tsetFocus: function(flag){\r\n\t\treturn this.tree._callHook(\"nodeSetFocus\", this, flag);\r\n\t},\r\n\t/**Select this node, i.e. check the checkbox.\r\n\t * @param {boolean} [flag=true] pass false to deselect\r\n\t * @param {object} [opts] additional options. Defaults to {noEvents: false, p\r\n\t *     propagateDown: null, propagateUp: null, callback: null }\r\n\t */\r\n\tsetSelected: function(flag, opts){\r\n\t\treturn this.tree._callHook(\"nodeSetSelected\", this, flag, opts);\r\n\t},\r\n\t/**Mark a lazy node as 'error', 'loading', 'nodata', or 'ok'.\r\n\t * @param {string} status 'error'|'empty'|'ok'\r\n\t * @param {string} [message]\r\n\t * @param {string} [details]\r\n\t */\r\n\tsetStatus: function(status, message, details){\r\n\t\treturn this.tree._callHook(\"nodeSetStatus\", this, status, message, details);\r\n\t},\r\n\t/**Rename this node.\r\n\t * @param {string} title\r\n\t */\r\n\tsetTitle: function(title){\r\n\t\tthis.title = title;\r\n\t\tthis.renderTitle();\r\n\t\tthis.triggerModify(\"rename\");\r\n\t},\r\n\t/**Sort child list by title.\r\n\t * @param {function} [cmp] custom compare function(a, b) that returns -1, 0, or 1 (defaults to sort by title).\r\n\t * @param {boolean} [deep=false] pass true to sort all descendant nodes\r\n\t */\r\n\tsortChildren: function(cmp, deep) {\r\n\t\tvar i,l,\r\n\t\t\tcl = this.children;\r\n\r\n\t\tif( !cl ){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tcmp = cmp || function(a, b) {\r\n\t\t\tvar x = a.title.toLowerCase(),\r\n\t\t\t\ty = b.title.toLowerCase();\r\n\t\t\treturn x === y ? 0 : x > y ? 1 : -1;\r\n\t\t\t};\r\n\t\tcl.sort(cmp);\r\n\t\tif( deep ){\r\n\t\t\tfor(i=0, l=cl.length; i<l; i++){\r\n\t\t\t\tif( cl[i].children ){\r\n\t\t\t\t\tcl[i].sortChildren(cmp, \"$norender$\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( deep !== \"$norender$\" ){\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t\tthis.triggerModifyChild(\"sort\");\r\n\t},\r\n\t/** Convert node (or whole branch) into a plain object.\r\n\t *\r\n\t * The result is compatible with node.addChildren().\r\n\t *\r\n\t * @param {boolean} [recursive=false] include child nodes\r\n\t * @param {function} [callback] callback(dict, node) is called for every node, in order to allow modifications\r\n\t * @returns {NodeData}\r\n\t */\r\n\ttoDict: function(recursive, callback) {\r\n\t\tvar i, l, node,\r\n\t\t\tdict = {},\r\n\t\t\tself = this;\r\n\r\n\t\t$.each(NODE_ATTRS, function(i, a){\r\n\t\t\tif(self[a] || self[a] === false){\r\n\t\t\t\tdict[a] = self[a];\r\n\t\t\t}\r\n\t\t});\r\n\t\tif(!$.isEmptyObject(this.data)){\r\n\t\t\tdict.data = $.extend({}, this.data);\r\n\t\t\tif($.isEmptyObject(dict.data)){\r\n\t\t\t\tdelete dict.data;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( callback ){\r\n\t\t\tcallback(dict, self);\r\n\t\t}\r\n\t\tif( recursive ) {\r\n\t\t\tif(this.hasChildren()){\r\n\t\t\t\tdict.children = [];\r\n\t\t\t\tfor(i=0, l=this.children.length; i<l; i++ ){\r\n\t\t\t\t\tnode = this.children[i];\r\n\t\t\t\t\tif( !node.isStatusNode() ){\r\n\t\t\t\t\t\tdict.children.push(node.toDict(true, callback));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n//                dict.children = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn dict;\r\n\t},\r\n\t/**\r\n\t * Set, clear, or toggle class of node's span tag and .extraClasses.\r\n\t *\r\n\t * @param {string} className class name (separate multiple classes by space)\r\n\t * @param {boolean} [flag] true/false to add/remove class. If omitted, class is toggled.\r\n\t * @returns {boolean} true if a class was added\r\n\t *\r\n\t * @since 2.17\r\n\t */\r\n\ttoggleClass: function(value, flag){\r\n\t\tvar className, hasClass,\r\n\t\t\trnotwhite = ( /\\S+/g ),\r\n\t\t\tclassNames = value.match( rnotwhite ) || [],\r\n\t\t\ti = 0,\r\n\t\t\twasAdded = false,\r\n\t\t\tstatusElem = this[this.tree.statusClassPropName],\r\n\t\t\tcurClasses = (\" \" + (this.extraClasses || \"\") + \" \");\r\n\r\n\t\t// this.info(\"toggleClass('\" + value + \"', \" + flag + \")\", curClasses);\r\n\t\t// Modify DOM element directly if it already exists\r\n\t\tif( statusElem ) {\r\n\t\t\t$(statusElem).toggleClass(value, flag);\r\n\t\t}\r\n\t\t// Modify node.extraClasses to make this change persistent\r\n\t\t// Toggle if flag was not passed\r\n\t\twhile ( className = classNames[ i++ ] ) {\r\n\t\t\thasClass = curClasses.indexOf(\" \" + className + \" \") >= 0;\r\n\t\t\tflag = (flag === undefined) ? (!hasClass) : !!flag;\r\n\t\t\tif ( flag ) {\r\n\t\t\t\tif( !hasClass ) {\r\n\t\t\t\t\tcurClasses += className + \" \";\r\n\t\t\t\t\twasAdded = true;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\twhile ( curClasses.indexOf( \" \" + className + \" \" ) > -1 ) {\r\n\t\t\t\t\tcurClasses = curClasses.replace( \" \" + className + \" \", \" \" );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.extraClasses = $.trim(curClasses);\r\n\t\t// this.info(\"-> toggleClass('\" + value + \"', \" + flag + \"): '\" + this.extraClasses + \"'\");\r\n\t\treturn wasAdded;\r\n\t},\r\n\t/** Flip expanded status. */\r\n\ttoggleExpanded: function(){\r\n\t\treturn this.tree._callHook(\"nodeToggleExpanded\", this);\r\n\t},\r\n\t/** Flip selection status. */\r\n\ttoggleSelected: function(){\r\n\t\treturn this.tree._callHook(\"nodeToggleSelected\", this);\r\n\t},\r\n\ttoString: function() {\r\n\t\treturn \"FancytreeNode@\" + this.key + \"[title='\" + this.title + \"']\";\r\n\t\t// return \"<FancytreeNode(#\" + this.key + \", '\" + this.title + \"')>\";\r\n\t},\r\n\t/**\r\n\t * Trigger `modifyChild` event on a parent to signal that a child was modified.\r\n\t * @param {string} operation Type of change: 'add', 'remove', 'rename', 'move', 'data', ...\r\n\t * @param {FancytreeNode} [childNode]\r\n\t * @param {object} [extra]\r\n\t */\r\n\ttriggerModifyChild: function(operation, childNode, extra){\r\n\t\tvar data,\r\n\t\t\tmodifyChild = this.tree.options.modifyChild;\r\n\r\n\t\tif ( modifyChild ){\r\n\t\t\tif( childNode && childNode.parent !== this ) {\r\n\t\t\t\t$.error(\"childNode \" + childNode + \" is not a child of \" + this);\r\n\t\t\t}\r\n\t\t\tdata = {\r\n\t\t\t\tnode: this,\r\n\t\t\t\ttree: this.tree,\r\n\t\t\t\toperation: operation,\r\n\t\t\t\tchildNode: childNode || null\r\n\t\t\t};\r\n\t\t\tif( extra ) {\r\n\t\t\t\t$.extend(data, extra);\r\n\t\t\t}\r\n\t\t\tmodifyChild({type: \"modifyChild\"}, data);\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * Trigger `modifyChild` event on node.parent(!).\r\n\t * @param {string} operation Type of change: 'add', 'remove', 'rename', 'move', 'data', ...\r\n\t * @param {object} [extra]\r\n\t */\r\n\ttriggerModify: function(operation, extra){\r\n\t\tthis.parent.triggerModifyChild(operation, this, extra);\r\n\t},\r\n\t/** Call fn(node) for all child nodes.<br>\r\n\t * Stop iteration, if fn() returns false. Skip current branch, if fn() returns \"skip\".<br>\r\n\t * Return false if iteration was stopped.\r\n\t *\r\n\t * @param {function} fn the callback function.\r\n\t *     Return false to stop iteration, return \"skip\" to skip this node and\r\n\t *     its children only.\r\n\t * @param {boolean} [includeSelf=false]\r\n\t * @returns {boolean}\r\n\t */\r\n\tvisit: function(fn, includeSelf) {\r\n\t\tvar i, l,\r\n\t\t\tres = true,\r\n\t\t\tchildren = this.children;\r\n\r\n\t\tif( includeSelf === true ) {\r\n\t\t\tres = fn(this);\r\n\t\t\tif( res === false || res === \"skip\" ){\r\n\t\t\t\treturn res;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(children){\r\n\t\t\tfor(i=0, l=children.length; i<l; i++){\r\n\t\t\t\tres = children[i].visit(fn, true);\r\n\t\t\t\tif( res === false ){\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/** Call fn(node) for all child nodes and recursively load lazy children.<br>\r\n\t * <b>Note:</b> If you need this method, you probably should consider to review\r\n\t * your architecture! Recursivley loading nodes is a perfect way for lazy\r\n\t * programmers to flood the server with requests ;-)\r\n\t *\r\n\t * @param {function} [fn] optional callback function.\r\n\t *     Return false to stop iteration, return \"skip\" to skip this node and\r\n\t *     its children only.\r\n\t * @param {boolean} [includeSelf=false]\r\n\t * @returns {$.Promise}\r\n\t * @since 2.4\r\n\t */\r\n\tvisitAndLoad: function(fn, includeSelf, _recursion) {\r\n\t\tvar dfd, res, loaders,\r\n\t\t\tnode = this;\r\n\r\n\t\t// node.debug(\"visitAndLoad\");\r\n\t\tif( fn && includeSelf === true ) {\r\n\t\t\tres = fn(node);\r\n\t\t\tif( res === false || res === \"skip\" ) {\r\n\t\t\t\treturn _recursion ? res : _getResolvedPromise();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( !node.children && !node.lazy ) {\r\n\t\t\treturn _getResolvedPromise();\r\n\t\t}\r\n\t\tdfd = new $.Deferred();\r\n\t\tloaders = [];\r\n\t\t// node.debug(\"load()...\");\r\n\t\tnode.load().done(function(){\r\n\t\t\t// node.debug(\"load()... done.\");\r\n\t\t\tfor(var i=0, l=node.children.length; i<l; i++){\r\n\t\t\t\tres = node.children[i].visitAndLoad(fn, true, true);\r\n\t\t\t\tif( res === false ) {\r\n\t\t\t\t\tdfd.reject();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else if ( res !== \"skip\" ) {\r\n\t\t\t\t\tloaders.push(res); // Add promise to the list\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$.when.apply(this, loaders).then(function(){\r\n\t\t\t\tdfd.resolve();\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn dfd.promise();\r\n\t},\r\n\t/** Call fn(node) for all parent nodes, bottom-up, including invisible system root.<br>\r\n\t * Stop iteration, if fn() returns false.<br>\r\n\t * Return false if iteration was stopped.\r\n\t *\r\n\t * @param {function} fn the callback function.\r\n\t *     Return false to stop iteration, return \"skip\" to skip this node and children only.\r\n\t * @param {boolean} [includeSelf=false]\r\n\t * @returns {boolean}\r\n\t */\r\n\tvisitParents: function(fn, includeSelf) {\r\n\t\t// Visit parent nodes (bottom up)\r\n\t\tif(includeSelf && fn(this) === false){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar p = this.parent;\r\n\t\twhile( p ) {\r\n\t\t\tif(fn(p) === false){\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tp = p.parent;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t/** Call fn(node) for all sibling nodes.<br>\r\n\t * Stop iteration, if fn() returns false.<br>\r\n\t * Return false if iteration was stopped.\r\n\t *\r\n\t * @param {function} fn the callback function.\r\n\t *     Return false to stop iteration.\r\n\t * @param {boolean} [includeSelf=false]\r\n\t * @returns {boolean}\r\n\t */\r\n\tvisitSiblings: function(fn, includeSelf) {\r\n\t\tvar i, l, n,\r\n\t\t\tac = this.parent.children;\r\n\r\n\t\tfor (i=0, l=ac.length; i<l; i++) {\r\n\t\t\tn = ac[i];\r\n\t\t\tif ( includeSelf || n !== this ){\r\n\t\t\t\tif( fn(n) === false ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t/** Write warning to browser console (prepending node info)\r\n\t *\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\twarn: function(msg){\r\n\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\tconsoleApply(\"warn\", arguments);\r\n\t}\r\n};\r\n\r\n\r\n/* *****************************************************************************\r\n * Fancytree\r\n */\r\n/**\r\n * Construct a new tree object.\r\n *\r\n * @class Fancytree\r\n * @classdesc The controller behind a fancytree.\r\n * This class also contains 'hook methods': see {@link Fancytree_Hooks}.\r\n *\r\n * @param {Widget} widget\r\n *\r\n * @property {string} _id Automatically generated unique tree instance ID, e.g. \"1\".\r\n * @property {string} _ns Automatically generated unique tree namespace, e.g. \".fancytree-1\".\r\n * @property {FancytreeNode} activeNode Currently active node or null.\r\n * @property {string} ariaPropName Property name of FancytreeNode that contains the element which will receive the aria attributes.\r\n *     Typically \"li\", but \"tr\" for table extension.\r\n * @property {jQueryObject} $container Outer &lt;ul> element (or &lt;table> element for ext-table).\r\n * @property {jQueryObject} $div A jQuery object containing the element used to instantiate the tree widget (`widget.element`)\r\n * @property {object|array} columns Recommended place to store shared column meta data. @since 2.27\r\n * @property {object} data Metadata, i.e. properties that may be passed to `source` in addition to a children array.\r\n * @property {object} ext Hash of all active plugin instances.\r\n * @property {FancytreeNode} focusNode Currently focused node or null.\r\n * @property {FancytreeNode} lastSelectedNode Used to implement selectMode 1 (single select)\r\n * @property {string} nodeContainerAttrName Property name of FancytreeNode that contains the outer element of single nodes.\r\n *     Typically \"li\", but \"tr\" for table extension.\r\n * @property {FancytreeOptions} options Current options, i.e. default options + options passed to constructor.\r\n * @property {FancytreeNode} rootNode Invisible system root node.\r\n * @property {string} statusClassPropName Property name of FancytreeNode that contains the element which will receive the status classes.\r\n *     Typically \"span\", but \"tr\" for table extension.\r\n * @property {object} types Map for shared type specific meta data, used with node.type attribute. @since 2.27\r\n * @property {object} widget Base widget instance.\r\n */\r\nfunction Fancytree(widget) {\r\n\tthis.widget = widget;\r\n\tthis.$div = widget.element;\r\n\tthis.options = widget.options;\r\n\tif( this.options ) {\r\n\t\tif(  $.isFunction(this.options.lazyload ) && !$.isFunction(this.options.lazyLoad) ) {\r\n\t\t\tthis.options.lazyLoad = function() {\r\n\t\t\t\tFT.warn(\"The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead.\");\r\n\t\t\t\treturn widget.options.lazyload.apply(this, arguments);\r\n\t\t\t};\r\n\t\t}\r\n\t\tif( $.isFunction(this.options.loaderror) ) {\r\n\t\t\t$.error(\"The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead.\");\r\n\t\t}\r\n\t\tif( this.options.fx !== undefined ) {\r\n\t\t\tFT.warn(\"The 'fx' option was replaced by 'toggleEffect' since 2014-11-30.\");\r\n\t\t}\r\n\t\tif( this.options.removeNode !== undefined ) {\r\n\t\t\t$.error(\"The 'removeNode' event was replaced by 'modifyChild' since 2.20 (2016-09-10).\");\r\n\t\t}\r\n\t}\r\n\tthis.ext = {}; // Active extension instances\r\n\tthis.types = {};\r\n\tthis.columns = {};\r\n\t// allow to init tree.data.foo from <div data-foo=''>\r\n\tthis.data = _getElementDataAsDict(this.$div);\r\n\t// TODO: use widget.uuid instead?\r\n\tthis._id = $.ui.fancytree._nextId++;\r\n\t// TODO: use widget.eventNamespace instead?\r\n\tthis._ns = \".fancytree-\" + this._id; // append for namespaced events\r\n\tthis.activeNode = null;\r\n\tthis.focusNode = null;\r\n\tthis._hasFocus = null;\r\n\tthis._tempCache = {};\r\n\tthis._lastMousedownNode = null;\r\n\tthis._enableUpdate = true;\r\n\tthis.lastSelectedNode = null;\r\n\tthis.systemFocusElement = null;\r\n\tthis.lastQuicksearchTerm = \"\";\r\n\tthis.lastQuicksearchTime = 0;\r\n\r\n\tthis.statusClassPropName = \"span\";\r\n\tthis.ariaPropName = \"li\";\r\n\tthis.nodeContainerAttrName = \"li\";\r\n\r\n\t// Remove previous markup if any\r\n\tthis.$div.find(\">ul.fancytree-container\").remove();\r\n\r\n\t// Create a node without parent.\r\n\tvar fakeParent = { tree: this },\r\n\t\t$ul;\r\n\tthis.rootNode = new FancytreeNode(fakeParent, {\r\n\t\ttitle: \"root\",\r\n\t\tkey: \"root_\" + this._id,\r\n\t\tchildren: null,\r\n\t\texpanded: true\r\n\t});\r\n\tthis.rootNode.parent = null;\r\n\r\n\t// Create root markup\r\n\t$ul = $(\"<ul>\", {\r\n\t\t\"class\": \"ui-fancytree fancytree-container fancytree-plain\"\r\n\t}).appendTo(this.$div);\r\n\tthis.$container = $ul;\r\n\tthis.rootNode.ul = $ul[0];\r\n\r\n\tif(this.options.debugLevel == null){\r\n\t\tthis.options.debugLevel = FT.debugLevel;\r\n\t}\r\n\t// // Add container to the TAB chain\r\n\t// // See http://www.w3.org/TR/wai-aria-practices/#focus_activedescendant\r\n\t// // #577: Allow to set tabindex to \"0\", \"-1\" and \"\"\r\n\t// this.$container.attr(\"tabindex\", this.options.tabindex);\r\n\r\n\t// if( this.options.rtl ) {\r\n\t// \tthis.$container.attr(\"DIR\", \"RTL\").addClass(\"fancytree-rtl\");\r\n\t// // }else{\r\n\t// //\tthis.$container.attr(\"DIR\", null).removeClass(\"fancytree-rtl\");\r\n\t// }\r\n\t// if(this.options.aria){\r\n\t// \tthis.$container.attr(\"role\", \"tree\");\r\n\t// \tif( this.options.selectMode !== 1 ) {\r\n\t// \t\tthis.$container.attr(\"aria-multiselectable\", true);\r\n\t// \t}\r\n\t// }\r\n}\r\n\r\n\r\nFancytree.prototype = /** @lends Fancytree# */{\r\n\t/* Return a context object that can be re-used for _callHook().\r\n\t * @param {Fancytree | FancytreeNode | EventData} obj\r\n\t * @param {Event} originalEvent\r\n\t * @param {Object} extra\r\n\t * @returns {EventData}\r\n\t */\r\n\t_makeHookContext: function(obj, originalEvent, extra) {\r\n\t\tvar ctx, tree;\r\n\t\tif(obj.node !== undefined){\r\n\t\t\t// obj is already a context object\r\n\t\t\tif(originalEvent && obj.originalEvent !== originalEvent){\r\n\t\t\t\t$.error(\"invalid args\");\r\n\t\t\t}\r\n\t\t\tctx = obj;\r\n\t\t}else if(obj.tree){\r\n\t\t\t// obj is a FancytreeNode\r\n\t\t\ttree = obj.tree;\r\n\t\t\tctx = { node: obj, tree: tree, widget: tree.widget, options: tree.widget.options, originalEvent: originalEvent,\r\n\t\t\t\t\ttypeInfo: tree.types[obj.type] || {}};\r\n\t\t}else if(obj.widget){\r\n\t\t\t// obj is a Fancytree\r\n\t\t\tctx = { node: null, tree: obj, widget: obj.widget, options: obj.widget.options, originalEvent: originalEvent };\r\n\t\t}else{\r\n\t\t\t$.error(\"invalid args\");\r\n\t\t}\r\n\t\tif(extra){\r\n\t\t\t$.extend(ctx, extra);\r\n\t\t}\r\n\t\treturn ctx;\r\n\t},\r\n\t/* Trigger a hook function: funcName(ctx, [...]).\r\n\t *\r\n\t * @param {string} funcName\r\n\t * @param {Fancytree|FancytreeNode|EventData} contextObject\r\n\t * @param {any}  [_extraArgs] optional additional arguments\r\n\t * @returns {any}\r\n\t */\r\n\t_callHook: function(funcName, contextObject, _extraArgs) {\r\n\t\tvar ctx = this._makeHookContext(contextObject),\r\n\t\t\tfn = this[funcName],\r\n\t\t\targs = Array.prototype.slice.call(arguments, 2);\r\n\t\tif(!$.isFunction(fn)){\r\n\t\t\t$.error(\"_callHook('\" + funcName + \"') is not a function\");\r\n\t\t}\r\n\t\targs.unshift(ctx);\r\n//\t\tthis.debug(\"_hook\", funcName, ctx.node && ctx.node.toString() || ctx.tree.toString(), args);\r\n\t\treturn fn.apply(this, args);\r\n\t},\r\n\t_setExpiringValue: function(key, value, ms){\r\n\t\tthis._tempCache[key] = {value: value, expire: Date.now() + (+ms || 50)};\r\n\t},\r\n\t_getExpiringValue: function(key){\r\n\t\tvar entry = this._tempCache[key];\r\n\t\tif( entry && entry.expire > Date.now() ) {\r\n\t\t\treturn entry.value;\r\n\t\t}\r\n\t\tdelete this._tempCache[key];\r\n\t\treturn null;\r\n\t},\r\n\t/* Check if current extensions dependencies are met and throw an error if not.\r\n\t *\r\n\t * This method may be called inside the `treeInit` hook for custom extensions.\r\n\t *\r\n\t * @param {string} extension name of the required extension\r\n\t * @param {boolean} [required=true] pass `false` if the extension is optional, but we want to check for order if it is present\r\n\t * @param {boolean} [before] `true` if `name` must be included before this, `false` otherwise (use `null` if order doesn't matter)\r\n\t * @param {string} [message] optional error message (defaults to a descriptve error message)\r\n\t */\r\n\t_requireExtension: function(name, required, before, message) {\r\n\t\tbefore = !!before;\r\n\t\tvar thisName = this._local.name,\r\n\t\t\textList = this.options.extensions,\r\n\t\t\tisBefore = $.inArray(name, extList) < $.inArray(thisName, extList),\r\n\t\t\tisMissing = required && this.ext[name] == null,\r\n\t\t\tbadOrder = !isMissing && before != null && (before !== isBefore);\r\n\r\n\t\t_assert(thisName && thisName !== name, \"invalid or same name\");\r\n\r\n\t\tif( isMissing || badOrder ){\r\n\t\t\tif( !message ){\r\n\t\t\t\tif( isMissing || required ){\r\n\t\t\t\t\tmessage = \"'\" + thisName + \"' extension requires '\" + name + \"'\";\r\n\t\t\t\t\tif( badOrder ){\r\n\t\t\t\t\t\tmessage += \" to be registered \" + (before ? \"before\" : \"after\") + \" itself\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}else{\r\n\t\t\t\t\tmessage = \"If used together, `\" + name + \"` must be registered \" + (before ? \"before\" : \"after\") + \" `\" + thisName + \"`\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t$.error(message);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\t/** Activate node with a given key and fire focus and activate events.\r\n\t *\r\n\t * A previously activated node will be deactivated.\r\n\t * If activeVisible option is set, all parents will be expanded as necessary.\r\n\t * Pass key = false, to deactivate the current node only.\r\n\t * @param {string} key\r\n\t * @returns {FancytreeNode} activated node (null, if not found)\r\n\t */\r\n\tactivateKey: function(key) {\r\n\t\tvar node = this.getNodeByKey(key);\r\n\t\tif(node){\r\n\t\t\tnode.setActive();\r\n\t\t}else if(this.activeNode){\r\n\t\t\tthis.activeNode.setActive(false);\r\n\t\t}\r\n\t\treturn node;\r\n\t},\r\n\t/** (experimental) Add child status nodes that indicate 'More...', ....\r\n\t * @param {boolean|object} node optional node definition. Pass `false` to remove all paging nodes.\r\n\t * @param {string} [mode='append'] 'child'|firstChild'\r\n\t * @since 2.15\r\n\t */\r\n\taddPagingNode: function(node, mode){\r\n\t\treturn this.rootNode.addPagingNode(node, mode);\r\n\t},\r\n\t/** (experimental) Modify existing data model.\r\n\t *\r\n\t * @param {Array} patchList array of [key, NodePatch] arrays\r\n\t * @returns {$.Promise} resolved, when all patches have been applied\r\n\t * @see TreePatch\r\n\t */\r\n\tapplyPatch: function(patchList) {\r\n\t\tvar dfd, i, p2, key, patch, node,\r\n\t\t\tpatchCount = patchList.length,\r\n\t\t\tdeferredList = [];\r\n\r\n\t\tfor(i=0; i<patchCount; i++){\r\n\t\t\tp2 = patchList[i];\r\n\t\t\t_assert(p2.length === 2, \"patchList must be an array of length-2-arrays\");\r\n\t\t\tkey = p2[0];\r\n\t\t\tpatch = p2[1];\r\n\t\t\tnode = (key === null) ? this.rootNode : this.getNodeByKey(key);\r\n\t\t\tif(node){\r\n\t\t\t\tdfd = new $.Deferred();\r\n\t\t\t\tdeferredList.push(dfd);\r\n\t\t\t\tnode.applyPatch(patch).always(_makeResolveFunc(dfd, node));\r\n\t\t\t}else{\r\n\t\t\t\tthis.warn(\"could not find node with key '\" + key + \"'\");\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Return a promise that is resolved, when ALL patches were applied\r\n\t\treturn $.when.apply($, deferredList).promise();\r\n\t},\r\n\t/* TODO: implement in dnd extension\r\n\tcancelDrag: function() {\r\n\t\tvar dd = $.ui.ddmanager.current;\r\n\t\tif(dd){\r\n\t\t\tdd.cancel();\r\n\t\t}\r\n\t},\r\n   */\r\n\t/** Remove all nodes.\r\n\t * @since 2.14\r\n\t */\r\n\tclear: function(source) {\r\n\t\tthis._callHook(\"treeClear\", this);\r\n\t},\r\n   /** Return the number of nodes.\r\n\t* @returns {integer}\r\n\t*/\r\n\tcount: function() {\r\n\t\treturn this.rootNode.countChildren();\r\n\t},\r\n\t/** Write to browser console if debugLevel >= 2 (prepending tree name)\r\n\t *\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\tdebug: function(msg){\r\n\t\tif( this.options.debugLevel >= 2 ) {\r\n\t\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\t\tconsoleApply(\"log\", arguments);\r\n\t\t}\r\n\t},\r\n\t// TODO: disable()\r\n\t// TODO: enable()\r\n\t/** Temporarily suppress rendering to improve performance on bulk-updates.\r\n\t *\r\n\t * @param {boolean} flag\r\n\t * @returns {boolean} previous status\r\n\t * @since 2.19\r\n\t */\r\n\tenableUpdate: function(flag) {\r\n\t\tflag = ( flag !== false );\r\n\t\t/*jshint -W018 */  // Confusing use of '!'\r\n\t\tif ( !!this._enableUpdate === !!flag ) {\r\n\t\t\treturn flag;\r\n\t\t}\r\n\t\t/*jshint +W018 */\r\n\t\tthis._enableUpdate = flag;\r\n\t\tif ( flag ) {\r\n\t\t\tthis.debug(\"enableUpdate(true): redraw \");  //, this._dirtyRoots);\r\n\t\t\tthis.render();\r\n\t\t} else {\r\n\t\t// \tthis._dirtyRoots = null;\r\n\t\t\tthis.debug(\"enableUpdate(false)...\");\r\n\t\t}\r\n\t\treturn !flag; // return previous value\r\n\t},\r\n\t/** Write warning to browser console (prepending tree info)\r\n\t *\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\terror: function(msg){\r\n\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\tconsoleApply(\"error\", arguments);\r\n\t},\r\n\t/**Find all nodes that matches condition.\r\n\t *\r\n\t * @param {string | function(node)} match title string to search for, or a\r\n\t *     callback function that returns `true` if a node is matched.\r\n\t * @returns {FancytreeNode[]} array of nodes (may be empty)\r\n\t * @see FancytreeNode#findAll\r\n\t * @since 2.12\r\n\t */\r\n\tfindAll: function(match) {\r\n\t\treturn this.rootNode.findAll(match);\r\n\t},\r\n\t/**Find first node that matches condition.\r\n\t *\r\n\t * @param {string | function(node)} match title string to search for, or a\r\n\t *     callback function that returns `true` if a node is matched.\r\n\t * @returns {FancytreeNode} matching node or null\r\n\t * @see FancytreeNode#findFirst\r\n\t * @since 2.12\r\n\t */\r\n\tfindFirst: function(match) {\r\n\t\treturn this.rootNode.findFirst(match);\r\n\t},\r\n\t/** Find the next visible node that starts with `match`, starting at `startNode`\r\n\t * and wrap-around at the end.\r\n\t *\r\n\t * @param {string|function} match\r\n\t * @param {FancytreeNode} [startNode] defaults to first node\r\n\t * @returns {FancytreeNode} matching node or null\r\n\t */\r\n\tfindNextNode: function(match, startNode, visibleOnly) {\r\n\t\tmatch = (typeof match === \"string\") ? _makeNodeTitleStartMatcher(match) : match;\r\n\t\tstartNode = startNode || this.getFirstChild();\r\n\r\n\t\tvar stopNode = null,\r\n\t\t\tparentChildren = startNode.parent.children,\r\n\t\t\tmatchingNode = null,\r\n\t\t\twalkVisible = function(parent, idx, fn) {\r\n\t\t\t\tvar i, grandParent,\r\n\t\t\t\t\tparentChildren = parent.children,\r\n\t\t\t\t\tsiblingCount = parentChildren.length,\r\n\t\t\t\t\tnode = parentChildren[idx];\r\n\t\t\t\t// visit node itself\r\n\t\t\t\tif( node && fn(node) === false ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\t// visit descendants\r\n\t\t\t\tif( node && node.children && node.expanded ) {\r\n\t\t\t\t\tif( walkVisible(node, 0, fn) === false ) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// visit subsequent siblings\r\n\t\t\t\tfor( i = idx + 1; i < siblingCount; i++ ) {\r\n\t\t\t\t\tif( walkVisible(parent, i, fn) === false ) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// visit parent's subsequent siblings\r\n\t\t\t\tgrandParent = parent.parent;\r\n\t\t\t\tif( grandParent ) {\r\n\t\t\t\t\treturn walkVisible(grandParent, grandParent.children.indexOf(parent) + 1, fn);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// wrap-around: restart with first node\r\n\t\t\t\t\treturn walkVisible(parent, 0, fn);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\twalkVisible(startNode.parent, parentChildren.indexOf(startNode), function(node){\r\n\t\t\t// Stop iteration if we see the start node a second time\r\n\t\t\tif( node === stopNode ) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tstopNode = stopNode || node;\r\n\t\t\t// Ignore nodes hidden by a filter\r\n\t\t\tif( ! $(node.span).is(\":visible\") ) {\r\n\t\t\t\tnode.debug(\"quicksearch: skipping hidden node\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Test if we found a match, but search for a second match if this\r\n\t\t\t// was the currently active node\r\n\t\t\tif( match(node) ) {\r\n\t\t\t\t// node.debug(\"quicksearch match \" + node.title, startNode);\r\n\t\t\t\tmatchingNode = node;\r\n\t\t\t\tif( matchingNode !== startNode ) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn matchingNode;\r\n\t},\r\n\t// TODO: fromDict\r\n\t/**\r\n\t * Generate INPUT elements that can be submitted with html forms.\r\n\t *\r\n\t * In selectMode 3 only the topmost selected nodes are considered, unless\r\n\t * `opts.stopOnParents: false` is passed.\r\n\t *\r\n\t * @example\r\n\t * // Generate input elements for active and selected nodes\r\n\t * tree.generateFormElements();\r\n\t * // Generate input elements selected nodes, using a custom `name` attribute\r\n\t * tree.generateFormElements(\"cust_sel\", false);\r\n\t * // Generate input elements using a custom filter\r\n\t * tree.generateFormElements(true, true, { filter: function(node) {\r\n\t *     return node.isSelected() && node.data.yes;\r\n\t * }});\r\n\t *\r\n\t * @param {boolean | string} [selected=true] Pass false to disable, pass a string to override the field name (default: 'ft_ID[]')\r\n\t * @param {boolean | string} [active=true] Pass false to disable, pass a string to override the field name (default: 'ft_ID_active')\r\n\t * @param {object} [opts] default { filter: null, stopOnParents: true }\r\n\t */\r\n\tgenerateFormElements: function(selected, active, opts) {\r\n\t\topts = opts || {};\r\n\r\n\t\tvar nodeList,\r\n\t\t\tselectedName = (typeof selected === \"string\") ? selected : \"ft_\" + this._id + \"[]\",\r\n\t\t\tactiveName = (typeof active === \"string\") ? active : \"ft_\" + this._id + \"_active\",\r\n\t\t\tid = \"fancytree_result_\" + this._id,\r\n\t\t\t$result = $(\"#\" + id),\r\n\t\t\tstopOnParents = this.options.selectMode === 3 && opts.stopOnParents !== false;\r\n\r\n\t\tif($result.length){\r\n\t\t\t$result.empty();\r\n\t\t}else{\r\n\t\t\t$result = $(\"<div>\", {\r\n\t\t\t\tid: id\r\n\t\t\t}).hide().insertAfter(this.$container);\r\n\t\t}\r\n\t\tif(active !== false && this.activeNode){\r\n\t\t\t$result.append($(\"<input>\", {\r\n\t\t\t\ttype: \"radio\",\r\n\t\t\t\tname: activeName,\r\n\t\t\t\tvalue: this.activeNode.key,\r\n\t\t\t\tchecked: true\r\n\t\t\t}));\r\n\t\t}\r\n\t\tfunction _appender( node ) {\r\n\t\t\t$result.append($(\"<input>\", {\r\n\t\t\t\ttype: \"checkbox\",\r\n\t\t\t\tname: selectedName,\r\n\t\t\t\tvalue: node.key,\r\n\t\t\t\tchecked: true\r\n\t\t\t}));\r\n\t\t}\r\n\t\tif ( opts.filter ) {\r\n\t\t\tthis.visit(function(node) {\r\n\t\t\t\tvar res = opts.filter(node);\r\n\t\t\t\tif( res === \"skip\" ) { return res; }\r\n\t\t\t\tif ( res !== false ) {\r\n\t\t\t\t\t_appender(node);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else if ( selected !== false ) {\r\n\t\t\tnodeList = this.getSelectedNodes(stopOnParents);\r\n\t\t\t$.each(nodeList, function(idx, node) {\r\n\t\t\t\t_appender(node);\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * Return the currently active node or null.\r\n\t * @returns {FancytreeNode}\r\n\t */\r\n\tgetActiveNode: function() {\r\n\t\treturn this.activeNode;\r\n\t},\r\n\t/** Return the first top level node if any (not the invisible root node).\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetFirstChild: function() {\r\n\t\treturn this.rootNode.getFirstChild();\r\n\t},\r\n\t/**\r\n\t * Return node that has keyboard focus or null.\r\n\t * @returns {FancytreeNode}\r\n\t */\r\n\tgetFocusNode: function() {\r\n\t\treturn this.focusNode;\r\n\t},\r\n\t/**\r\n\t * Return node with a given key or null if not found.\r\n\t * @param {string} key\r\n\t * @param {FancytreeNode} [searchRoot] only search below this node\r\n\t * @returns {FancytreeNode | null}\r\n\t */\r\n\tgetNodeByKey: function(key, searchRoot) {\r\n\t\t// Search the DOM by element ID (assuming this is faster than traversing all nodes).\r\n\t\t// $(\"#...\") has problems, if the key contains '.', so we use getElementById()\r\n\t\tvar el, match;\r\n\t\tif(!searchRoot){\r\n\t\t\tel = document.getElementById(this.options.idPrefix + key);\r\n\t\t\tif( el ){\r\n\t\t\t\treturn el.ftnode ? el.ftnode : null;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Not found in the DOM, but still may be in an unrendered part of tree\r\n\t\t// TODO: optimize with specialized loop\r\n\t\t// TODO: consider keyMap?\r\n\t\tsearchRoot = searchRoot || this.rootNode;\r\n\t\tmatch = null;\r\n\t\tsearchRoot.visit(function(node){\r\n//            window.console.log(\"getNodeByKey(\" + key + \"): \", node.key);\r\n\t\t\tif(node.key === key) {\r\n\t\t\t\tmatch = node;\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}, true);\r\n\t\treturn match;\r\n\t},\r\n\t/** Return the invisible system root node.\r\n\t * @returns {FancytreeNode}\r\n\t */\r\n\tgetRootNode: function() {\r\n\t\treturn this.rootNode;\r\n\t},\r\n\t/**\r\n\t * Return an array of selected nodes.\r\n\t * @param {boolean} [stopOnParents=false] only return the topmost selected\r\n\t *     node (useful with selectMode 3)\r\n\t * @returns {FancytreeNode[]}\r\n\t */\r\n\tgetSelectedNodes: function(stopOnParents) {\r\n\t\treturn this.rootNode.getSelectedNodes(stopOnParents);\r\n\t},\r\n\t/** Return true if the tree control has keyboard focus\r\n\t * @returns {boolean}\r\n\t */\r\n\thasFocus: function(){\r\n\t\treturn !!this._hasFocus;\r\n\t},\r\n\t/** Write to browser console if debugLevel >= 1 (prepending tree name)\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\tinfo: function(msg){\r\n\t\tif( this.options.debugLevel >= 1 ) {\r\n\t\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\t\tconsoleApply(\"info\", arguments);\r\n\t\t}\r\n\t},\r\n/*\r\n\tTODO: isInitializing: function() {\r\n\t\treturn ( this.phase==\"init\" || this.phase==\"postInit\" );\r\n\t},\r\n\tTODO: isReloading: function() {\r\n\t\treturn ( this.phase==\"init\" || this.phase==\"postInit\" ) && this.options.persist && this.persistence.cookiesFound;\r\n\t},\r\n\tTODO: isUserEvent: function() {\r\n\t\treturn ( this.phase==\"userEvent\" );\r\n\t},\r\n*/\r\n\r\n\t/**\r\n\t * Make sure that a node with a given ID is loaded, by traversing - and\r\n\t * loading - its parents. This method is meant for lazy hierarchies.\r\n\t * A callback is executed for every node as we go.\r\n\t * @example\r\n\t * // Resolve using node.key:\r\n\t * tree.loadKeyPath(\"/_3/_23/_26/_27\", function(node, status){\r\n\t *   if(status === \"loaded\") {\r\n\t *     console.log(\"loaded intermediate node \" + node);\r\n\t *   }else if(status === \"ok\") {\r\n\t *     node.activate();\r\n\t *   }\r\n\t * });\r\n\t * // Use deferred promise:\r\n\t * tree.loadKeyPath(\"/_3/_23/_26/_27\").progress(function(data){\r\n\t *   if(data.status === \"loaded\") {\r\n\t *     console.log(\"loaded intermediate node \" + data.node);\r\n\t *   }else if(data.status === \"ok\") {\r\n\t *     node.activate();\r\n\t *   }\r\n\t * }).done(function(){\r\n\t *    ...\r\n\t * });\r\n\t * // Custom path segment resolver:\r\n\t * tree.loadKeyPath(\"/321/431/21/2\", {\r\n\t *   matchKey: function(node, key){\r\n\t *     return node.data.refKey === key;\r\n\t *   },\r\n\t *   callback: function(node, status){\r\n\t *     if(status === \"loaded\") {\r\n\t *       console.log(\"loaded intermediate node \" + node);\r\n\t *     }else if(status === \"ok\") {\r\n\t *       node.activate();\r\n\t *     }\r\n\t *   }\r\n\t * });\r\n\t * @param {string | string[]} keyPathList one or more key paths (e.g. '/3/2_1/7')\r\n\t * @param {function | object} optsOrCallback callback(node, status) is called for every visited node ('loading', 'loaded', 'ok', 'error').\r\n\t *     Pass an object to define custom key matchers for the path segments: {callback: function, matchKey: function}.\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tloadKeyPath: function(keyPathList, optsOrCallback) {\r\n\t\tvar callback, i, path,\r\n\t\t\tself = this,\r\n\t\t\tdfd = new $.Deferred(),\r\n\t\t\tparent = this.getRootNode(),\r\n\t\t\tsep = this.options.keyPathSeparator,\r\n\t\t\tpathSegList = [],\r\n\t\t\topts = $.extend({}, optsOrCallback);\r\n\r\n\t\t// Prepare options\r\n\t\tif( typeof optsOrCallback === \"function\" ) {\r\n\t\t\tcallback = optsOrCallback;\r\n\t\t} else if ( optsOrCallback && optsOrCallback.callback ) {\r\n\t\t\tcallback = optsOrCallback.callback;\r\n\t\t}\r\n\t\topts.callback = function(ctx, node, status){\r\n\t\t\tif( callback ) {\r\n\t\t\t\tcallback.call(ctx, node, status);\r\n\t\t\t}\r\n\t\t\tdfd.notifyWith(ctx, [{node: node, status: status}]);\r\n\t\t};\r\n\t\tif( opts.matchKey == null ) {\r\n\t\t\topts.matchKey = function(node, key) { return node.key === key; };\r\n\t\t}\r\n\t\t// Convert array of path strings to array of segment arrays\r\n\t\tif(!$.isArray(keyPathList)){\r\n\t\t\tkeyPathList = [keyPathList];\r\n\t\t}\r\n\t\tfor(i=0; i<keyPathList.length; i++){\r\n\t\t\tpath = keyPathList[i];\r\n\t\t\t// strip leading slash\r\n\t\t\tif(path.charAt(0) === sep){\r\n\t\t\t\tpath = path.substr(1);\r\n\t\t\t}\r\n\t\t\t// segListMap[path] = { parent: parent, segList: path.split(sep) };\r\n\t\t\tpathSegList.push(path.split(sep));\r\n\t\t\t// targetList.push({ parent: parent, segList: path.split(sep)/* , path: path*/});\r\n\t\t}\r\n\t\t// The timeout forces async behavior always (even if nodes are all loaded)\r\n\t\t// This way a potential progress() event will fire.\r\n\t\tsetTimeout(function(){\r\n\t\t\tself._loadKeyPathImpl(dfd, opts, parent, pathSegList).done(function(){\r\n\t\t\t\tdfd.resolve();\r\n\t\t\t});\r\n\t\t}, 0);\r\n\t\treturn dfd.promise();\r\n\t},\r\n\t/*\r\n\t * Resolve a list of paths, relative to one parent node.\r\n\t */\r\n\t_loadKeyPathImpl: function(dfd, opts, parent, pathSegList) {\r\n\t\tvar deferredList, i, key, node, remainMap, tmpParent, segList, subDfd,\r\n\t\t\tself = this;\r\n\r\n\t\tfunction __findChild(parent, key){\r\n\t\t\t// console.log(\"__findChild\", key, parent);\r\n\t\t\tvar i, l,\r\n\t\t\t\tcl = parent.children;\r\n\r\n\t\t\tif( cl ) {\r\n\t\t\t\tfor(i=0, l=cl.length; i<l; i++){\r\n\t\t\t\t\tif( opts.matchKey(cl[i], key)) { return cl[i]; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\t// console.log(\"_loadKeyPathImpl, parent=\", parent, \", pathSegList=\", pathSegList);\r\n\r\n\t\t// Pass 1:\r\n\t\t// Handle all path segments for nodes that are already loaded.\r\n\t\t// Collect distinct top-most lazy nodes in a map.\r\n\t\t// Note that we can use node.key to de-dupe entries, even if a custom matcher would\r\n\t\t// look for other node attributes.\r\n\t\t// map[node.key] => {node: node, pathList: [list of remaining rest-paths]}\r\n\t\tremainMap = {};\r\n\r\n\t\tfor(i=0; i<pathSegList.length; i++){\r\n\t\t\tsegList = pathSegList[i];\r\n\t\t\t// target = targetList[i];\r\n\r\n\t\t\t// Traverse and pop path segments (i.e. keys), until we hit a lazy, unloaded node\r\n\t\t\ttmpParent = parent;\r\n\t\t\twhile(segList.length){\r\n\t\t\t\tkey = segList.shift();\r\n\t\t\t\tnode = __findChild(tmpParent, key);\r\n\t\t\t\tif(!node){\r\n\t\t\t\t\tthis.warn(\"loadKeyPath: key not found: \" + key + \" (parent: \" + tmpParent + \")\");\r\n\t\t\t\t\topts.callback(this, key, \"error\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}else if(segList.length === 0){\r\n\t\t\t\t\topts.callback(this, node, \"ok\");\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}else if(!node.lazy || (node.hasChildren() !== undefined )){\r\n\t\t\t\t\topts.callback(this, node, \"loaded\");\r\n\t\t\t\t\ttmpParent = node;\r\n\t\t\t\t}else{\r\n\t\t\t\t\topts.callback(this, node, \"loaded\");\r\n\t\t\t\t\tkey = node.key;  //target.segList.join(sep);\r\n\t\t\t\t\tif(remainMap[key]){\r\n\t\t\t\t\t\tremainMap[key].pathSegList.push(segList);\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tremainMap[key] = {parent: node, pathSegList: [segList]};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// console.log(\"_loadKeyPathImpl AFTER pass 1, remainMap=\", remainMap);\r\n\r\n\t\t// Now load all lazy nodes and continue iteration for remaining paths\r\n\t\tdeferredList = [];\r\n\r\n\t\t// Avoid jshint warning 'Don't make functions within a loop.':\r\n\t\tfunction __lazyload(dfd, parent, pathSegList){\r\n\t\t\t// console.log(\"__lazyload\", parent, \"pathSegList=\", pathSegList);\r\n\t\t\topts.callback(self, parent, \"loading\");\r\n\t\t\tparent.load().done(function(){\r\n\t\t\t\tself._loadKeyPathImpl.call(self, dfd, opts, parent, pathSegList)\r\n\t\t\t\t\t.always(_makeResolveFunc(dfd, self));\r\n\t\t\t}).fail(function(errMsg){\r\n\t\t\t\tself.warn(\"loadKeyPath: error loading lazy \" + parent);\r\n\t\t\t\topts.callback(self, node, \"error\");\r\n\t\t\t\tdfd.rejectWith(self);\r\n\t\t\t});\r\n\t\t}\r\n\t\t// remainMap contains parent nodes, each with a list of relative sub-paths.\r\n\t\t// We start loading all of them now, and pass the the list to each loader.\r\n\t\tfor(var nodeKey in remainMap){\r\n\t\t\tvar remain = remainMap[nodeKey];\r\n\t\t\t// console.log(\"for(): remain=\", remain, \"remainMap=\", remainMap);\r\n\t\t\t// key = remain.segList.shift();\r\n\t\t\t// node = __findChild(remain.parent, key);\r\n\t\t\t// if (node == null) {  // #576\r\n\t\t\t// \t// Issue #576, refactored for v2.27:\r\n\t\t\t// \t// The root cause was, that sometimes the wrong parent was used here\r\n\t\t\t// \t// to find the next segment.\r\n\t\t\t// \t// Falling back to getNodeByKey() was a hack that no longer works if a custom\r\n\t\t\t// \t// matcher is used, because we cannot assume that a single segment-key is unique\r\n\t\t\t// \t// throughout the tree.\r\n\t\t\t// \tself.error(\"loadKeyPath: error loading child by key '\" + key + \"' (parent: \" + target.parent + \")\", target);\r\n\t\t\t// \t// \tnode = self.getNodeByKey(key);\r\n\t\t\t// \tcontinue;\r\n\t\t\t// }\r\n\t\t\tsubDfd = new $.Deferred();\r\n\t\t\tdeferredList.push(subDfd);\r\n\t\t\t__lazyload(subDfd, remain.parent, remain.pathSegList);\r\n\t\t}\r\n\t\t// Return a promise that is resolved, when ALL paths were loaded\r\n\t\treturn $.when.apply($, deferredList).promise();\r\n\t},\r\n\t/** Re-fire beforeActivate, activate, and (optional) focus events.\r\n\t * Calling this method in the `init` event, will activate the node that\r\n\t * was marked 'active' in the source data, and optionally set the keyboard\r\n\t * focus.\r\n\t * @param [setFocus=false]\r\n\t */\r\n\treactivate: function(setFocus) {\r\n\t\tvar res,\r\n\t\t\tnode = this.activeNode;\r\n\r\n\t\tif( !node ) {\r\n\t\t\treturn _getResolvedPromise();\r\n\t\t}\r\n\t\tthis.activeNode = null; // Force re-activating\r\n\t\tres = node.setActive(true, {noFocus: true});\r\n\t\tif( setFocus ){\r\n\t\t\tnode.setFocus();\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/** Reload tree from source and return a promise.\r\n\t * @param [source] optional new source (defaults to initial source data)\r\n\t * @returns {$.Promise}\r\n\t */\r\n\treload: function(source) {\r\n\t\tthis._callHook(\"treeClear\", this);\r\n\t\treturn this._callHook(\"treeLoad\", this, source);\r\n\t},\r\n\t/**Render tree (i.e. create DOM elements for all top-level nodes).\r\n\t * @param {boolean} [force=false] create DOM elemnts, even if parent is collapsed\r\n\t * @param {boolean} [deep=false]\r\n\t */\r\n\trender: function(force, deep) {\r\n\t\treturn this.rootNode.render(force, deep);\r\n\t},\r\n\t// TODO: selectKey: function(key, select)\r\n\t// TODO: serializeArray: function(stopOnParents)\r\n\t/**\r\n\t * @param {boolean} [flag=true]\r\n\t */\r\n\tsetFocus: function(flag) {\r\n\t\treturn this._callHook(\"treeSetFocus\", this, flag);\r\n\t},\r\n\t/**\r\n\t * Return all nodes as nested list of {@link NodeData}.\r\n\t *\r\n\t * @param {boolean} [includeRoot=false] Returns the hidden system root node (and its children)\r\n\t * @param {function} [callback] callback(dict, node) is called for every node, in order to allow modifications\r\n\t * @returns {Array | object}\r\n\t * @see FancytreeNode#toDict\r\n\t */\r\n\ttoDict: function(includeRoot, callback){\r\n\t\tvar res = this.rootNode.toDict(true, callback);\r\n\t\treturn includeRoot ? res : res.children;\r\n\t},\r\n\t/* Implicitly called for string conversions.\r\n\t * @returns {string}\r\n\t */\r\n\ttoString: function(){\r\n\t\treturn \"Fancytree@\" + this._id;\r\n\t\t// return \"<Fancytree(#\" + this._id + \")>\";\r\n\t},\r\n\t/* _trigger a widget event with additional node ctx.\r\n\t * @see EventData\r\n\t */\r\n\t_triggerNodeEvent: function(type, node, originalEvent, extra) {\r\n//\t\tthis.debug(\"_trigger(\" + type + \"): '\" + ctx.node.title + \"'\", ctx);\r\n\t\tvar ctx = this._makeHookContext(node, originalEvent, extra),\r\n\t\t\tres = this.widget._trigger(type, originalEvent, ctx);\r\n\t\tif(res !== false && ctx.result !== undefined){\r\n\t\t\treturn ctx.result;\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/* _trigger a widget event with additional tree data. */\r\n\t_triggerTreeEvent: function(type, originalEvent, extra) {\r\n//\t\tthis.debug(\"_trigger(\" + type + \")\", ctx);\r\n\t\tvar ctx = this._makeHookContext(this, originalEvent, extra),\r\n\t\t\tres = this.widget._trigger(type, originalEvent, ctx);\r\n\r\n\t\tif(res !== false && ctx.result !== undefined){\r\n\t\t\treturn ctx.result;\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/** Call fn(node) for all nodes.\r\n\t *\r\n\t * @param {function} fn the callback function.\r\n\t *     Return false to stop iteration, return \"skip\" to skip this node and children only.\r\n\t * @returns {boolean} false, if the iterator was stopped.\r\n\t */\r\n\tvisit: function(fn) {\r\n\t\treturn this.rootNode.visit(fn, false);\r\n\t},\r\n\t/** Write warning to browser console (prepending tree info)\r\n\t *\r\n\t * @param {*} msg string or object or array of such\r\n\t */\r\n\twarn: function(msg){\r\n\t\tArray.prototype.unshift.call(arguments, this.toString());\r\n\t\tconsoleApply(\"warn\", arguments);\r\n\t}\r\n};\r\n\r\n/**\r\n * These additional methods of the {@link Fancytree} class are 'hook functions'\r\n * that can be used and overloaded by extensions.\r\n * (See <a href=\"https://github.com/mar10/fancytree/wiki/TutorialExtensions\">writing extensions</a>.)\r\n * @mixin Fancytree_Hooks\r\n */\r\n$.extend(Fancytree.prototype,\r\n\t/** @lends Fancytree_Hooks# */\r\n\t{\r\n\t/** Default handling for mouse click events.\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeClick: function(ctx) {\r\n\t\tvar activate, expand,\r\n\t\t\t// event = ctx.originalEvent,\r\n\t\t\ttargetType = ctx.targetType,\r\n\t\t\tnode = ctx.node;\r\n\r\n//\t    this.debug(\"ftnode.onClick(\" + event.type + \"): ftnode:\" + this + \", button:\" + event.button + \", which: \" + event.which, ctx);\r\n\t\t// TODO: use switch\r\n\t\t// TODO: make sure clicks on embedded <input> doesn't steal focus (see table sample)\r\n\t\tif( targetType === \"expander\" ) {\r\n\t\t\tif( node.isLoading() ) {\r\n\t\t\t\t// #495: we probably got a click event while a lazy load is pending.\r\n\t\t\t\t// The 'expanded' state is not yet set, so 'toggle' would expand\r\n\t\t\t\t// and trigger lazyLoad again.\r\n\t\t\t\t// It would be better to allow to collapse/expand the status node\r\n\t\t\t\t// while loading (instead of ignoring), but that would require some\r\n\t\t\t\t// more work.\r\n\t\t\t\tnode.debug(\"Got 2nd click while loading: ignored\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t// Clicking the expander icon always expands/collapses\r\n\t\t\tthis._callHook(\"nodeToggleExpanded\", ctx);\r\n\r\n\t\t} else if( targetType === \"checkbox\" ) {\r\n\t\t\t// Clicking the checkbox always (de)selects\r\n\t\t\tthis._callHook(\"nodeToggleSelected\", ctx);\r\n\t\t\tif( ctx.options.focusOnSelect ) { // #358\r\n\t\t\t\tthis._callHook(\"nodeSetFocus\", ctx, true);\r\n\t\t\t}\r\n\r\n\t\t} else {\r\n\t\t\t// Honor `clickFolderMode` for\r\n\t\t\texpand = false;\r\n\t\t\tactivate = true;\r\n\t\t\tif( node.folder ) {\r\n\t\t\t\tswitch( ctx.options.clickFolderMode ) {\r\n\t\t\t\tcase 2: // expand only\r\n\t\t\t\t\texpand = true;\r\n\t\t\t\t\tactivate = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 3: // expand and activate\r\n\t\t\t\t\tactivate = true;\r\n\t\t\t\t\texpand = true; //!node.isExpanded();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// else 1 or 4: just activate\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif( activate ) {\r\n\t\t\t\tthis.nodeSetFocus(ctx);\r\n\t\t\t\tthis._callHook(\"nodeSetActive\", ctx, true);\r\n\t\t\t}\r\n\t\t\tif( expand ) {\r\n\t\t\t\tif(!activate){\r\n//                    this._callHook(\"nodeSetFocus\", ctx);\r\n\t\t\t\t}\r\n//\t\t\t\tthis._callHook(\"nodeSetExpanded\", ctx, true);\r\n\t\t\t\tthis._callHook(\"nodeToggleExpanded\", ctx);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Make sure that clicks stop, otherwise <a href='#'> jumps to the top\r\n\t\t// if(event.target.localName === \"a\" && event.target.className === \"fancytree-title\"){\r\n\t\t// \tevent.preventDefault();\r\n\t\t// }\r\n\t\t// TODO: return promise?\r\n\t},\r\n\t/** Collapse all other  children of same parent.\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t * @param {object} callOpts\r\n\t */\r\n\tnodeCollapseSiblings: function(ctx, callOpts) {\r\n\t\t// TODO: return promise?\r\n\t\tvar ac, i, l,\r\n\t\t\tnode = ctx.node;\r\n\r\n\t\tif( node.parent ){\r\n\t\t\tac = node.parent.children;\r\n\t\t\tfor (i=0, l=ac.length; i<l; i++) {\r\n\t\t\t\tif ( ac[i] !== node && ac[i].expanded ){\r\n\t\t\t\t\tthis._callHook(\"nodeSetExpanded\", ac[i], false, callOpts);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/** Default handling for mouse douleclick events.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeDblclick: function(ctx) {\r\n\t\t// TODO: return promise?\r\n\t\tif( ctx.targetType === \"title\" && ctx.options.clickFolderMode === 4) {\r\n//\t\t\tthis.nodeSetFocus(ctx);\r\n//\t\t\tthis._callHook(\"nodeSetActive\", ctx, true);\r\n\t\t\tthis._callHook(\"nodeToggleExpanded\", ctx);\r\n\t\t}\r\n\t\t// TODO: prevent text selection on dblclicks\r\n\t\tif( ctx.targetType === \"title\" ) {\r\n\t\t\tctx.originalEvent.preventDefault();\r\n\t\t}\r\n\t},\r\n\t/** Default handling for mouse keydown events.\r\n\t *\r\n\t * NOTE: this may be called with node == null if tree (but no node) has focus.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeKeydown: function(ctx) {\r\n\t\t// TODO: return promise?\r\n\t\tvar matchNode, stamp, res, focusNode,\r\n\t\t\tevent = ctx.originalEvent,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\twhich = event.which,\r\n\t\t\twhichChar = String.fromCharCode(which),\r\n\t\t\tclean = !(event.altKey || event.ctrlKey || event.metaKey || event.shiftKey),\r\n\t\t\t$target = $(event.target),\r\n\t\t\thandled = true,\r\n\t\t\tactivate = !(event.ctrlKey || !opts.autoActivate );\r\n\r\n\t\t// (node || FT).debug(\"ftnode.nodeKeydown(\" + event.type + \"): ftnode:\" + this + \", charCode:\" + event.charCode + \", keyCode: \" + event.keyCode + \", which: \" + event.which);\r\n\t\t// FT.debug(\"eventToString\", which, '\"' + String.fromCharCode(which) + '\"', '\"' + FT.eventToString(event) + '\"');\r\n\r\n\t\t// Set focus to active (or first node) if no other node has the focus yet\r\n\t\tif( !node ){\r\n\t\t\tfocusNode = (this.getActiveNode() || this.getFirstChild());\r\n\t\t\tif (focusNode){\r\n\t\t\t\tfocusNode.setFocus();\r\n\t\t\t\tnode = ctx.node = this.focusNode;\r\n\t\t\t\tnode.debug(\"Keydown force focus on active node\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( opts.quicksearch && clean && /\\w/.test(whichChar) &&\r\n\t\t\t\t!SPECIAL_KEYCODES[which] &&  // #659\r\n\t\t\t\t!$target.is(\":input:enabled\") ) {\r\n\t\t\t// Allow to search for longer streaks if typed in quickly\r\n\t\t\tstamp = new Date().getTime();\r\n\t\t\tif( stamp - tree.lastQuicksearchTime > 500 ) {\r\n\t\t\t\ttree.lastQuicksearchTerm = \"\";\r\n\t\t\t}\r\n\t\t\ttree.lastQuicksearchTime = stamp;\r\n\t\t\ttree.lastQuicksearchTerm += whichChar;\r\n\t\t\t// tree.debug(\"quicksearch find\", tree.lastQuicksearchTerm);\r\n\t\t\tmatchNode = tree.findNextNode(tree.lastQuicksearchTerm, tree.getActiveNode());\r\n\t\t\tif( matchNode ) {\r\n\t\t\t\tmatchNode.setActive();\r\n\t\t\t}\r\n\t\t\tevent.preventDefault();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tswitch( FT.eventToString(event) ) {\r\n\t\t\tcase \"+\":\r\n\t\t\tcase \"=\": // 187: '+' @ Chrome, Safari\r\n\t\t\t\ttree.nodeSetExpanded(ctx, true);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"-\":\r\n\t\t\t\ttree.nodeSetExpanded(ctx, false);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"space\":\r\n\t\t\t\tif( node.isPagingNode() ) {\r\n\t\t\t\t\ttree._triggerNodeEvent(\"clickPaging\", ctx, event);\r\n\t\t\t\t} else if( FT.evalOption(\"checkbox\", node, node, opts, false) ) {  // #768\r\n\t\t\t\t\ttree.nodeToggleSelected(ctx);\r\n\t\t\t\t}else{\r\n\t\t\t\t\ttree.nodeSetActive(ctx, true);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"return\":\r\n\t\t\t\ttree.nodeSetActive(ctx, true);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"home\":\r\n\t\t\tcase \"end\":\r\n\t\t\tcase \"backspace\":\r\n\t\t\tcase \"left\":\r\n\t\t\tcase \"right\":\r\n\t\t\tcase \"up\":\r\n\t\t\tcase \"down\":\r\n\t\t\t\tres = node.navigate(event.which, activate, true);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\thandled = false;\r\n\t\t}\r\n\t\tif(handled){\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\t},\r\n\r\n\r\n\t// /** Default handling for mouse keypress events. */\r\n\t// nodeKeypress: function(ctx) {\r\n\t//     var event = ctx.originalEvent;\r\n\t// },\r\n\r\n\t// /** Trigger lazyLoad event (async). */\r\n\t// nodeLazyLoad: function(ctx) {\r\n\t//     var node = ctx.node;\r\n\t//     if(this._triggerNodeEvent())\r\n\t// },\r\n\t/** Load child nodes (async).\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t * @param {object[]|object|string|$.Promise|function} source\r\n\t * @returns {$.Promise} The deferred will be resolved as soon as the (ajax)\r\n\t *     data was rendered.\r\n\t */\r\n\tnodeLoadChildren: function(ctx, source) {\r\n\t\tvar ajax, delay, dfd,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\tnode = ctx.node,\r\n\t\t\trequestId = new Date().getTime();\r\n\r\n\t\tif($.isFunction(source)){\r\n\t\t\tsource = source.call(tree, {type: \"source\"}, ctx);\r\n\t\t\t_assert(!$.isFunction(source), \"source callback must not return another function\");\r\n\t\t}\r\n\t\tif(source.url){\r\n\t\t\tif( node._requestId ) {\r\n\t\t\t\tnode.warn(\"Recursive load request #\" + requestId + \" while #\" + node._requestId + \" is pending.\");\r\n\t\t\t// } else {\r\n\t\t\t// \tnode.debug(\"Send load request #\" + requestId);\r\n\t\t\t}\r\n\t\t\t// `source` is an Ajax options object\r\n\t\t\tajax = $.extend({}, ctx.options.ajax, source);\r\n\t\t\tnode._requestId = requestId;\r\n\t\t\tif(ajax.debugDelay){\r\n\t\t\t\t// simulate a slow server\r\n\t\t\t\tdelay = ajax.debugDelay;\r\n\t\t\t\tif($.isArray(delay)){ // random delay range [min..max]\r\n\t\t\t\t\tdelay = delay[0] + Math.random() * (delay[1] - delay[0]);\r\n\t\t\t\t}\r\n\t\t\t\tnode.warn(\"nodeLoadChildren waiting debugDelay \" + Math.round(delay) + \" ms ...\");\r\n\t\t\t\tajax.debugDelay = false;\r\n\t\t\t\tdfd = $.Deferred(function (dfd) {\r\n\t\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t\t$.ajax(ajax)\r\n\t\t\t\t\t\t\t.done(function () {\tdfd.resolveWith(this, arguments); })\r\n\t\t\t\t\t\t\t.fail(function () {\tdfd.rejectWith(this, arguments); });\r\n\t\t\t\t\t}, delay);\r\n\t\t\t\t});\r\n\t\t\t}else{\r\n\t\t\t\tdfd = $.ajax(ajax);\r\n\t\t\t}\r\n\r\n\t\t\t// Defer the deferred: we want to be able to reject, even if ajax\r\n\t\t\t// resolved ok.\r\n\t\t\tsource = new $.Deferred();\r\n\t\t\tdfd.done(function (data, textStatus, jqXHR) {\r\n\t\t\t\tvar errorObj, res;\r\n\r\n\t\t\t\tif((this.dataType === \"json\" || this.dataType === \"jsonp\") && typeof data === \"string\"){\r\n\t\t\t\t\t$.error(\"Ajax request returned a string (did you get the JSON dataType wrong?).\");\r\n\t\t\t\t}\r\n\t\t\t\tif( node._requestId && node._requestId > requestId ) {\r\n\t\t\t\t\t// The expected request time stamp is later than `requestId`\r\n\t\t\t\t\t// (which was kept as as closure variable to this handler function)\r\n\t\t\t\t\t// node.warn(\"Ignored load response for obsolete request #\" + requestId + \" (expected #\" + node._requestId + \")\");\r\n\t\t\t\t\tsource.rejectWith(this, [RECURSIVE_REQUEST_ERROR]);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t// } else {\r\n\t\t\t\t// \tnode.debug(\"Response returned for load request #\" + requestId);\r\n\t\t\t\t}\r\n\t\t\t\t// postProcess is similar to the standard ajax dataFilter hook,\r\n\t\t\t\t// but it is also called for JSONP\r\n\t\t\t\tif( ctx.options.postProcess ){\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tres = tree._triggerNodeEvent(\"postProcess\", ctx, ctx.originalEvent, {\r\n\t\t\t\t\t\t\tresponse: data, error: null, dataType: this.dataType\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\tres = { error: e, message: \"\" + e, details: \"postProcess failed\"};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( res.error ) {\r\n\t\t\t\t\t\terrorObj = $.isPlainObject(res.error) ? res.error : {message: res.error};\r\n\t\t\t\t\t\terrorObj = tree._makeHookContext(node, null, errorObj);\r\n\t\t\t\t\t\tsource.rejectWith(this, [errorObj]);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdata = $.isArray(res) ? res : data;\r\n\r\n\t\t\t\t} else if (data && data.hasOwnProperty(\"d\") && ctx.options.enableAspx ) {\r\n\t\t\t\t\t// Process ASPX WebMethod JSON object inside \"d\" property\r\n\t\t\t\t\tdata = (typeof data.d === \"string\") ? $.parseJSON(data.d) : data.d;\r\n\t\t\t\t}\r\n\t\t\t\tsource.resolveWith(this, [data]);\r\n\t\t\t}).fail(function (jqXHR, textStatus, errorThrown) {\r\n\t\t\t\tvar errorObj = tree._makeHookContext(node, null, {\r\n\t\t\t\t\terror: jqXHR,\r\n\t\t\t\t\targs: Array.prototype.slice.call(arguments),\r\n\t\t\t\t\tmessage: errorThrown,\r\n\t\t\t\t\tdetails: jqXHR.status + \": \" + errorThrown\r\n\t\t\t\t});\r\n\t\t\t\tsource.rejectWith(this, [errorObj]);\r\n\t\t\t});\r\n\t\t}\r\n\t\t// #383: accept and convert ECMAScript 6 Promise\r\n\t\tif( $.isFunction(source.then) && $.isFunction(source[\"catch\"]) ) {\r\n\t\t\tdfd = source;\r\n\t\t\tsource = new $.Deferred();\r\n\t\t\tdfd.then(function(value){\r\n\t\t\t\tsource.resolve(value);\r\n\t\t\t}, function(reason){\r\n\t\t\t\tsource.reject(reason);\r\n\t\t\t});\r\n\t\t}\r\n\t\tif($.isFunction(source.promise)){\r\n\t\t\t// `source` is a deferred, i.e. ajax request\r\n\t\t\t// _assert(!node.isLoading(), \"recursive load\");\r\n\t\t\ttree.nodeSetStatus(ctx, \"loading\");\r\n\r\n\t\t\tsource.done(function (children) {\r\n\t\t\t\ttree.nodeSetStatus(ctx, \"ok\");\r\n\t\t\t\tnode._requestId = null;\r\n\t\t\t}).fail(function(error){\r\n\t\t\t\tvar ctxErr;\r\n\r\n\t\t\t\tif ( error === RECURSIVE_REQUEST_ERROR ) {\r\n\t\t\t\t\tnode.warn(\"Ignored response for obsolete load request #\" + requestId + \" (expected #\" + node._requestId + \")\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t} else if (error.node && error.error && error.message) {\r\n\t\t\t\t\t// error is already a context object\r\n\t\t\t\t\tctxErr = error;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctxErr = tree._makeHookContext(node, null, {\r\n\t\t\t\t\t\terror: error, // it can be jqXHR or any custom error\r\n\t\t\t\t\t\targs: Array.prototype.slice.call(arguments),\r\n\t\t\t\t\t\tmessage: error ? (error.message || error.toString()) : \"\"\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif( ctxErr.message === \"[object Object]\" ) {\r\n\t\t\t\t\t\tctxErr.message = \"\";\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tnode.warn(\"Load children failed (\" + ctxErr.message + \")\", ctxErr);\r\n\t\t\t\tif( tree._triggerNodeEvent(\"loadError\", ctxErr, null) !== false ) {\r\n\t\t\t\t\ttree.nodeSetStatus(ctx, \"error\", ctxErr.message, ctxErr.details);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tif( ctx.options.postProcess ){\r\n\t\t\t\t// #792: Call postProcess for non-deferred source\r\n\t\t\t\tvar res = tree._triggerNodeEvent(\"postProcess\", ctx, ctx.originalEvent, {\r\n\t\t\t\t\tresponse: source, error: null, dataType: typeof source\r\n\t\t\t\t});\r\n\r\n\t\t\t\tsource = $.isArray(res) ? res : source;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// $.when(source) resolves also for non-deferreds\r\n\t\treturn $.when(source).done(function(children){\r\n\t\t\tvar metaData;\r\n\r\n\t\t\tif( $.isPlainObject(children) ){\r\n\t\t\t\t// We got {foo: 'abc', children: [...]}\r\n\t\t\t\t// Copy extra properties to tree.data.foo\r\n\t\t\t\t_assert(node.isRootNode(), \"source may only be an object for root nodes (expecting an array of child objects otherwise)\");\r\n\t\t\t\t_assert($.isArray(children.children), \"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')\");\r\n\t\t\t\tmetaData = children;\r\n\t\t\t\tchildren = children.children;\r\n\t\t\t\tdelete metaData.children;\r\n\t\t\t\t// Copy some attributes to tree.data\r\n\t\t\t\t$.each(TREE_ATTRS, function(i, attr) {\r\n\t\t\t\t\tif( metaData[attr] !== undefined ){\r\n\t\t\t\t\t\ttree[attr] = metaData[attr];\r\n\t\t\t\t\t\tdelete metaData[attr];\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// Copy all other attributes to tree.data.NAME\r\n\t\t\t\t$.extend(tree.data, metaData);\r\n\t\t\t}\r\n\t\t\t_assert($.isArray(children), \"expected array of children\");\r\n\t\t\tnode._setChildren(children);\r\n\t\t\t// trigger fancytreeloadchildren\r\n\t\t\ttree._triggerNodeEvent(\"loadChildren\", node);\r\n\t\t});\r\n\t},\r\n\t/** [Not Implemented]  */\r\n\tnodeLoadKeyPath: function(ctx, keyPathList) {\r\n\t\t// TODO: implement and improve\r\n\t\t// http://code.google.com/p/dynatree/issues/detail?id=222\r\n\t},\r\n\t/**\r\n\t * Remove a single direct child of ctx.node.\r\n\t * @param {EventData} ctx\r\n\t * @param {FancytreeNode} childNode dircect child of ctx.node\r\n\t */\r\n\tnodeRemoveChild: function(ctx, childNode) {\r\n\t\tvar idx,\r\n\t\t\tnode = ctx.node,\r\n\t\t\t// opts = ctx.options,\r\n\t\t\tsubCtx = $.extend({}, ctx, {node: childNode}),\r\n\t\t\tchildren = node.children;\r\n\r\n\t\t// FT.debug(\"nodeRemoveChild()\", node.toString(), childNode.toString());\r\n\r\n\t\tif( children.length === 1 ) {\r\n\t\t\t_assert(childNode === children[0], \"invalid single child\");\r\n\t\t\treturn this.nodeRemoveChildren(ctx);\r\n\t\t}\r\n\t\tif( this.activeNode && (childNode === this.activeNode || this.activeNode.isDescendantOf(childNode))){\r\n\t\t\tthis.activeNode.setActive(false); // TODO: don't fire events\r\n\t\t}\r\n\t\tif( this.focusNode && (childNode === this.focusNode || this.focusNode.isDescendantOf(childNode))){\r\n\t\t\tthis.focusNode = null;\r\n\t\t}\r\n\t\t// TODO: persist must take care to clear select and expand cookies\r\n\t\tthis.nodeRemoveMarkup(subCtx);\r\n\t\tthis.nodeRemoveChildren(subCtx);\r\n\t\tidx = $.inArray(childNode, children);\r\n\t\t_assert(idx >= 0, \"invalid child\");\r\n\t\t// Notify listeners\r\n\t\tnode.triggerModifyChild(\"remove\", childNode);\r\n\t\t// Unlink to support GC\r\n\t\tchildNode.visit(function(n){\r\n\t\t\tn.parent = null;\r\n\t\t}, true);\r\n\t\tthis._callHook(\"treeRegisterNode\", this, false, childNode);\r\n\t\t// remove from child list\r\n\t\tchildren.splice(idx, 1);\r\n\t},\r\n\t/**Remove HTML markup for all descendents of ctx.node.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeRemoveChildMarkup: function(ctx) {\r\n\t\tvar node = ctx.node;\r\n\r\n\t\t// FT.debug(\"nodeRemoveChildMarkup()\", node.toString());\r\n\t\t// TODO: Unlink attr.ftnode to support GC\r\n\t\tif(node.ul){\r\n\t\t\tif( node.isRootNode() ) {\r\n\t\t\t\t$(node.ul).empty();\r\n\t\t\t} else {\r\n\t\t\t\t$(node.ul).remove();\r\n\t\t\t\tnode.ul = null;\r\n\t\t\t}\r\n\t\t\tnode.visit(function(n){\r\n\t\t\t\tn.li = n.ul = null;\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\t/**Remove all descendants of ctx.node.\r\n\t* @param {EventData} ctx\r\n\t*/\r\n\tnodeRemoveChildren: function(ctx) {\r\n\t\tvar subCtx,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\tnode = ctx.node,\r\n\t\t\tchildren = node.children;\r\n\t\t\t// opts = ctx.options;\r\n\r\n\t\t// FT.debug(\"nodeRemoveChildren()\", node.toString());\r\n\t\tif(!children){\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif( this.activeNode && this.activeNode.isDescendantOf(node)){\r\n\t\t\tthis.activeNode.setActive(false); // TODO: don't fire events\r\n\t\t}\r\n\t\tif( this.focusNode && this.focusNode.isDescendantOf(node)){\r\n\t\t\tthis.focusNode = null;\r\n\t\t}\r\n\t\t// TODO: persist must take care to clear select and expand cookies\r\n\t\tthis.nodeRemoveChildMarkup(ctx);\r\n\t\t// Unlink children to support GC\r\n\t\t// TODO: also delete this.children (not possible using visit())\r\n\t\tsubCtx = $.extend({}, ctx);\r\n\t\tnode.triggerModifyChild(\"remove\", null);\r\n\t\tnode.visit(function(n){\r\n\t\t\tn.parent = null;\r\n\t\t\ttree._callHook(\"treeRegisterNode\", tree, false, n);\r\n\t\t});\r\n\t\tif( node.lazy ){\r\n\t\t\t// 'undefined' would be interpreted as 'not yet loaded' for lazy nodes\r\n\t\t\tnode.children = [];\r\n\t\t} else{\r\n\t\t\tnode.children = null;\r\n\t\t}\r\n\t\tif( !node.isRootNode() ) {\r\n\t\t\tnode.expanded = false;  // #449, #459\r\n\t\t}\r\n\t\tthis.nodeRenderStatus(ctx);\r\n\t},\r\n\t/**Remove HTML markup for ctx.node and all its descendents.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeRemoveMarkup: function(ctx) {\r\n\t\tvar node = ctx.node;\r\n\t\t// FT.debug(\"nodeRemoveMarkup()\", node.toString());\r\n\t\t// TODO: Unlink attr.ftnode to support GC\r\n\t\tif(node.li){\r\n\t\t\t$(node.li).remove();\r\n\t\t\tnode.li = null;\r\n\t\t}\r\n\t\tthis.nodeRemoveChildMarkup(ctx);\r\n\t},\r\n\t/**\r\n\t * Create `&lt;li>&lt;span>..&lt;/span> .. &lt;/li>` tags for this node.\r\n\t *\r\n\t * This method takes care that all HTML markup is created that is required\r\n\t * to display this node in its current state.\r\n\t *\r\n\t * Call this method to create new nodes, or after the strucuture\r\n\t * was changed (e.g. after moving this node or adding/removing children)\r\n\t * nodeRenderTitle() and nodeRenderStatus() are implied.\r\n\t *\r\n\t * &lt;code>\r\n\t * &lt;li id='KEY' ftnode=NODE>\r\n\t *     &lt;span class='fancytree-node fancytree-expanded fancytree-has-children fancytree-lastsib fancytree-exp-el fancytree-ico-e'>\r\n\t *         &lt;span class=\"fancytree-expander\">&lt;/span>\r\n\t *         &lt;span class=\"fancytree-checkbox\">&lt;/span> // only present in checkbox mode\r\n\t *         &lt;span class=\"fancytree-icon\">&lt;/span>\r\n\t *         &lt;a href=\"#\" class=\"fancytree-title\"> Node 1 &lt;/a>\r\n\t *     &lt;/span>\r\n\t *     &lt;ul> // only present if node has children\r\n\t *         &lt;li id='KEY' ftnode=NODE> child1 ... &lt;/li>\r\n\t *         &lt;li id='KEY' ftnode=NODE> child2 ... &lt;/li>\r\n\t *     &lt;/ul>\r\n\t * &lt;/li>\r\n\t * &lt;/code>\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} [force=false] re-render, even if html markup was already created\r\n\t * @param {boolean} [deep=false] also render all descendants, even if parent is collapsed\r\n\t * @param {boolean} [collapsed=false] force root node to be collapsed, so we can apply animated expand later\r\n\t */\r\n\tnodeRender: function(ctx, force, deep, collapsed, _recursive) {\r\n\t\t/* This method must take care of all cases where the current data mode\r\n\t\t * (i.e. node hierarchy) does not match the current markup.\r\n\t\t *\r\n\t\t * - node was not yet rendered:\r\n\t\t *   create markup\r\n\t\t * - node was rendered: exit fast\r\n\t\t * - children have been added\r\n\t\t * - children have been removed\r\n\t\t */\r\n\t\tvar childLI, childNode1, childNode2, i, l, next, subCtx,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\taria = opts.aria,\r\n\t\t\tfirstTime = false,\r\n\t\t\tparent = node.parent,\r\n\t\t\tisRootNode = !parent,\r\n\t\t\tchildren = node.children,\r\n\t\t\tsuccessorLi = null;\r\n\t\t// FT.debug(\"nodeRender(\" + !!force + \", \" + !!deep + \")\", node.toString());\r\n\r\n\t\tif( tree._enableUpdate === false ) {\r\n\t\t\t// tree.debug(\"no render\", tree._enableUpdate);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif( ! isRootNode && ! parent.ul ) {\r\n\t\t\t// Calling node.collapse on a deep, unrendered node\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t_assert(isRootNode || parent.ul, \"parent UL must exist\");\r\n\r\n\t\t// Render the node\r\n\t\tif( !isRootNode ){\r\n\t\t\t// Discard markup on force-mode, or if it is not linked to parent <ul>\r\n\t\t\tif(node.li && (force || (node.li.parentNode !== node.parent.ul) ) ){\r\n\t\t\t\tif( node.li.parentNode === node.parent.ul ){\r\n\t\t\t\t\t// #486: store following node, so we can insert the new markup there later\r\n\t\t\t\t\tsuccessorLi = node.li.nextSibling;\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// May happen, when a top-level node was dropped over another\r\n\t\t\t\t\tthis.debug(\"Unlinking \" + node + \" (must be child of \" + node.parent + \")\");\r\n\t\t\t\t}\r\n//\t            this.debug(\"nodeRemoveMarkup...\");\r\n\t\t\t\tthis.nodeRemoveMarkup(ctx);\r\n\t\t\t}\r\n\t\t\t// Create <li><span /> </li>\r\n//\t\t\tnode.debug(\"render...\");\r\n\t\t\tif( !node.li ) {\r\n//\t            node.debug(\"render... really\");\r\n\t\t\t\tfirstTime = true;\r\n\t\t\t\tnode.li = document.createElement(\"li\");\r\n\t\t\t\tnode.li.ftnode = node;\r\n\r\n\t\t\t\tif( node.key && opts.generateIds ){\r\n\t\t\t\t\tnode.li.id = opts.idPrefix + node.key;\r\n\t\t\t\t}\r\n\t\t\t\tnode.span = document.createElement(\"span\");\r\n\t\t\t\tnode.span.className = \"fancytree-node\";\r\n\t\t\t\tif( aria && !node.tr ) {\r\n\t\t\t\t\t$(node.li).attr(\"role\", \"treeitem\");\r\n\t\t\t\t}\r\n\t\t\t\tnode.li.appendChild(node.span);\r\n\r\n\t\t\t\t// Create inner HTML for the <span> (expander, checkbox, icon, and title)\r\n\t\t\t\tthis.nodeRenderTitle(ctx);\r\n\r\n\t\t\t\t// Allow tweaking and binding, after node was created for the first time\r\n\t\t\t\tif ( opts.createNode ){\r\n\t\t\t\t\topts.createNode.call(tree, {type: \"createNode\"}, ctx);\r\n\t\t\t\t}\r\n\t\t\t}else{\r\n//\t\t\t\tthis.nodeRenderTitle(ctx);\r\n\t\t\t\tthis.nodeRenderStatus(ctx);\r\n\t\t\t}\r\n\t\t\t// Allow tweaking after node state was rendered\r\n\t\t\tif ( opts.renderNode ){\r\n\t\t\t\topts.renderNode.call(tree, {type: \"renderNode\"}, ctx);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Visit child nodes\r\n\t\tif( children ){\r\n\t\t\tif( isRootNode || node.expanded || deep === true ) {\r\n\t\t\t\t// Create a UL to hold the children\r\n\t\t\t\tif( !node.ul ){\r\n\t\t\t\t\tnode.ul = document.createElement(\"ul\");\r\n\t\t\t\t\tif((collapsed === true && !_recursive) || !node.expanded){\r\n\t\t\t\t\t\t// hide top UL, so we can use an animation to show it later\r\n\t\t\t\t\t\tnode.ul.style.display = \"none\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(aria){\r\n\t\t\t\t\t\t$(node.ul).attr(\"role\", \"group\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ( node.li ) { // issue #67\r\n\t\t\t\t\t\tnode.li.appendChild(node.ul);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnode.tree.$div.append(node.ul);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Add child markup\r\n\t\t\t\tfor(i=0, l=children.length; i<l; i++) {\r\n\t\t\t\t\tsubCtx = $.extend({}, ctx, {node: children[i]});\r\n\t\t\t\t\tthis.nodeRender(subCtx, force, deep, false, true);\r\n\t\t\t\t}\r\n\t\t\t\t// Remove <li> if nodes have moved to another parent\r\n\t\t\t\tchildLI = node.ul.firstChild;\r\n\t\t\t\twhile( childLI ){\r\n\t\t\t\t\tchildNode2 = childLI.ftnode;\r\n\t\t\t\t\tif( childNode2 && childNode2.parent !== node ) {\r\n\t\t\t\t\t\tnode.debug(\"_fixParent: remove missing \" + childNode2, childLI);\r\n\t\t\t\t\t\tnext = childLI.nextSibling;\r\n\t\t\t\t\t\tchildLI.parentNode.removeChild(childLI);\r\n\t\t\t\t\t\tchildLI = next;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tchildLI = childLI.nextSibling;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Make sure, that <li> order matches node.children order.\r\n\t\t\t\tchildLI = node.ul.firstChild;\r\n\t\t\t\tfor(i=0, l=children.length-1; i<l; i++) {\r\n\t\t\t\t\tchildNode1 = children[i];\r\n\t\t\t\t\tchildNode2 = childLI.ftnode;\r\n\t\t\t\t\tif( childNode1 !== childNode2 ) {\r\n\t\t\t\t\t\t// node.debug(\"_fixOrder: mismatch at index \" + i + \": \" + childNode1 + \" != \" + childNode2);\r\n\t\t\t\t\t\tnode.ul.insertBefore(childNode1.li, childNode2.li);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tchildLI = childLI.nextSibling;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t// No children: remove markup if any\r\n\t\t\tif( node.ul ){\r\n//\t\t\t\talert(\"remove child markup for \" + node);\r\n\t\t\t\tthis.warn(\"remove child markup for \" + node);\r\n\t\t\t\tthis.nodeRemoveChildMarkup(ctx);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( !isRootNode ){\r\n\t\t\t// Update element classes according to node state\r\n\t\t\t// this.nodeRenderStatus(ctx);\r\n\t\t\t// Finally add the whole structure to the DOM, so the browser can render\r\n\t\t\tif( firstTime ){\r\n\t\t\t\t// #486: successorLi is set, if we re-rendered (i.e. discarded)\r\n\t\t\t\t// existing markup, which  we want to insert at the same position.\r\n\t\t\t\t// (null is equivalent to append)\r\n//\t\t\t\tparent.ul.appendChild(node.li);\r\n\t\t\t\tparent.ul.insertBefore(node.li, successorLi);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/** Create HTML inside the node's outer &lt;span> (i.e. expander, checkbox,\r\n\t * icon, and title).\r\n\t *\r\n\t * nodeRenderStatus() is implied.\r\n\t * @param {EventData} ctx\r\n\t * @param {string} [title] optinal new title\r\n\t */\r\n\tnodeRenderTitle: function(ctx, title) {\r\n\t\t// set node connector images, links and text\r\n\t\tvar checkbox, className, icon, nodeTitle, role, tabindex, tooltip, iconTooltip,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\taria = opts.aria,\r\n\t\t\tlevel = node.getLevel(),\r\n\t\t\tares = [];\r\n\r\n\t\tif(title !== undefined){\r\n\t\t\tnode.title = title;\r\n\t\t}\r\n\t\tif ( !node.span || tree._enableUpdate === false ) {\r\n\t\t\t// Silently bail out if node was not rendered yet, assuming\r\n\t\t\t// node.render() will be called as the node becomes visible\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t// Connector (expanded, expandable or simple)\r\n\t\trole = (aria && node.hasChildren() !== false) ? \" role='button'\" : \"\";\r\n\t\tif( level < opts.minExpandLevel ) {\r\n\t\t\tif( !node.lazy ) {\r\n\t\t\t\tnode.expanded = true;\r\n\t\t\t}\r\n\t\t\tif(level > 1){\r\n\t\t\t\tares.push(\"<span \" + role + \" class='fancytree-expander fancytree-expander-fixed'></span>\");\r\n\t\t\t}\r\n\t\t\t// .. else (i.e. for root level) skip expander/connector alltogether\r\n\t\t} else {\r\n\t\t\tares.push(\"<span \" + role + \" class='fancytree-expander'></span>\");\r\n\t\t}\r\n\t\t// Checkbox mode\r\n\t\tcheckbox = FT.evalOption(\"checkbox\", node, node, opts, false);\r\n\r\n\t\tif( checkbox && !node.isStatusNode() ) {\r\n\t\t\trole = aria ? \" role='checkbox'\" : \"\";\r\n\t\t\tclassName = \"fancytree-checkbox\";\r\n\t\t\tif( checkbox === \"radio\" || (node.parent && node.parent.radiogroup) ) {\r\n\t\t\t\tclassName += \" fancytree-radio\";\r\n\t\t\t}\r\n\t\t\tares.push(\"<span \" + role + \" class='\" + className + \"'></span>\");\r\n\t\t}\r\n\t\t// Folder or doctype icon\r\n\t\tif( node.data.iconClass !== undefined ) {  // 2015-11-16\r\n\t\t\t// Handle / warn about backward compatibility\r\n\t\t\tif( node.icon ) {\r\n\t\t\t\t$.error(\"'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead\");\r\n\t\t\t} else {\r\n\t\t\t\tnode.warn(\"'iconClass' node option is deprecated since v2.14.0: use 'icon' instead\");\r\n\t\t\t\tnode.icon = node.data.iconClass;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// If opts.icon is a callback and returns something other than undefined, use that\r\n\t\t// else if node.icon is a boolean or string, use that\r\n\t\t// else if opts.icon is a boolean or string, use that\r\n\t\t// else show standard icon (which may be different for folders or documents)\r\n\t\ticon = FT.evalOption(\"icon\", node, node, opts, true);\r\n\t\t// if( typeof icon !== \"boolean\" ) {\r\n\t\t// \t// icon is defined, but not true/false: must be a string\r\n\t\t// \ticon = \"\" + icon;\r\n\t\t// }\r\n\t\tif( icon !== false ) {\r\n\t\t\trole = aria ? \" role='presentation'\" : \"\";\r\n\r\n\t\t\ticonTooltip = FT.evalOption(\"iconTooltip\", node, node, opts, null);\r\n\t\t\ticonTooltip = iconTooltip ? \" title='\" + _escapeTooltip(iconTooltip) + \"'\" : \"\";\r\n\r\n\t\t\tif ( typeof icon === \"string\" ) {\r\n\t\t\t\tif( TEST_IMG.test(icon) ) {\r\n\t\t\t\t\t// node.icon is an image url. Prepend imagePath\r\n\t\t\t\t\ticon = (icon.charAt(0) === \"/\") ? icon : ((opts.imagePath || \"\") + icon);\r\n\t\t\t\t\tares.push(\"<img src='\" + icon + \"' class='fancytree-icon'\" + iconTooltip + \" alt='' />\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tares.push(\"<span \" + role + \" class='fancytree-custom-icon \" + icon +  \"'\" + iconTooltip + \"></span>\");\r\n\t\t\t\t}\r\n\t\t\t} else if ( icon.text ) {\r\n\t\t\t\tares.push(\"<span \" + role + \" class='fancytree-custom-icon \" +\r\n\t\t\t\t\t(icon.addClass || \"\") + \"'\" + iconTooltip + \">\" + icon.text + \"</span>\");\r\n\t\t\t} else {\r\n\t\t\t\t// standard icon: theme css will take care of this\r\n\t\t\t\tares.push(\"<span \" + role + \" class='fancytree-icon'\" + iconTooltip + \"></span>\");\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Node title\r\n\t\tnodeTitle = \"\";\r\n\t\tif ( opts.renderTitle ){\r\n\t\t\tnodeTitle = opts.renderTitle.call(tree, {type: \"renderTitle\"}, ctx) || \"\";\r\n\t\t}\r\n\t\tif ( !nodeTitle ) {\r\n\t\t\ttooltip = FT.evalOption(\"tooltip\", node, node, opts, null);\r\n\t\t\tif( tooltip === true ) {\r\n\t\t\t\ttooltip = node.title;\r\n\t\t\t}\r\n\t\t\t// if( node.tooltip ) {\r\n\t\t\t// \ttooltip = node.tooltip;\r\n\t\t\t// } else if ( opts.tooltip ) {\r\n\t\t\t// \ttooltip = opts.tooltip === true ? node.title : opts.tooltip.call(tree, node);\r\n\t\t\t// }\r\n\t\t\ttooltip = tooltip ? \" title='\" + _escapeTooltip(tooltip) + \"'\" : \"\";\r\n\t\t\ttabindex = opts.titlesTabbable ? \" tabindex='0'\" : \"\";\r\n\r\n\t\t\tnodeTitle = \"<span class='fancytree-title'\" +\r\n\t\t\t\ttooltip + tabindex + \">\" +\r\n\t\t\t\t(opts.escapeTitles ? FT.escapeHtml(node.title) : node.title) +\r\n\t\t\t\t\"</span>\";\r\n\t\t}\r\n\t\tares.push(nodeTitle);\r\n\t\t// Note: this will trigger focusout, if node had the focus\r\n\t\t//$(node.span).html(ares.join(\"\")); // it will cleanup the jQuery data currently associated with SPAN (if any), but it executes more slowly\r\n\t\tnode.span.innerHTML = ares.join(\"\");\r\n\t\t// Update CSS classes\r\n\t\tthis.nodeRenderStatus(ctx);\r\n\t\tif ( opts.enhanceTitle ){\r\n\t\t\tctx.$title = $(\">span.fancytree-title\", node.span);\r\n\t\t\tnodeTitle = opts.enhanceTitle.call(tree, {type: \"enhanceTitle\"}, ctx) || \"\";\r\n\t\t}\r\n\t},\r\n\t/** Update element classes according to node state.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeRenderStatus: function(ctx) {\r\n\t\t// Set classes for current status\r\n\t\tvar $ariaElem,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n//\t\t\tnodeContainer = node[tree.nodeContainerAttrName],\r\n\t\t\thasChildren = node.hasChildren(),\r\n\t\t\tisLastSib = node.isLastSibling(),\r\n\t\t\taria = opts.aria,\r\n\t\t\tcn = opts._classNames,\r\n\t\t\tcnList = [],\r\n\t\t\tstatusElem = node[tree.statusClassPropName];\r\n\r\n\t\tif( !statusElem || tree._enableUpdate === false ){\r\n\t\t\t// if this function is called for an unrendered node, ignore it (will be updated on nect render anyway)\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif( aria ) {\r\n\t\t\t$ariaElem = $(node.tr || node.li);\r\n\t\t}\r\n\t\t// Build a list of class names that we will add to the node <span>\r\n\t\tcnList.push(cn.node);\r\n\t\tif( tree.activeNode === node ){\r\n\t\t\tcnList.push(cn.active);\r\n//\t\t\t$(\">span.fancytree-title\", statusElem).attr(\"tabindex\", \"0\");\r\n//\t\t\ttree.$container.removeAttr(\"tabindex\");\r\n\t\t// }else{\r\n//\t\t\t$(\">span.fancytree-title\", statusElem).removeAttr(\"tabindex\");\r\n//\t\t\ttree.$container.attr(\"tabindex\", \"0\");\r\n\t\t}\r\n\t\tif( tree.focusNode === node ){\r\n\t\t\tcnList.push(cn.focused);\r\n\t\t}\r\n\t\tif( node.expanded ){\r\n\t\t\tcnList.push(cn.expanded);\r\n\t\t}\r\n\t\tif( aria ){\r\n\t\t\tif (hasChildren !== false) {\r\n\t\t\t\t$ariaElem.attr(\"aria-expanded\", Boolean(node.expanded));\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t$ariaElem.removeAttr(\"aria-expanded\");\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( node.folder ){\r\n\t\t\tcnList.push(cn.folder);\r\n\t\t}\r\n\t\tif( hasChildren !== false ){\r\n\t\t\tcnList.push(cn.hasChildren);\r\n\t\t}\r\n\t\t// TODO: required?\r\n\t\tif( isLastSib ){\r\n\t\t\tcnList.push(cn.lastsib);\r\n\t\t}\r\n\t\tif( node.lazy && node.children == null ){\r\n\t\t\tcnList.push(cn.lazy);\r\n\t\t}\r\n\t\tif( node.partload ){\r\n\t\t\tcnList.push(cn.partload);\r\n\t\t}\r\n\t\tif( node.partsel ){\r\n\t\t\tcnList.push(cn.partsel);\r\n\t\t}\r\n\t\tif( FT.evalOption(\"unselectable\", node, node, opts, false) ){\r\n\t\t\tcnList.push(cn.unselectable);\r\n\t\t}\r\n\t\tif( node._isLoading ){\r\n\t\t\tcnList.push(cn.loading);\r\n\t\t}\r\n\t\tif( node._error ){\r\n\t\t\tcnList.push(cn.error);\r\n\t\t}\r\n\t\tif( node.statusNodeType ) {\r\n\t\t\tcnList.push(cn.statusNodePrefix + node.statusNodeType);\r\n\t\t}\r\n\t\tif( node.selected ){\r\n\t\t\tcnList.push(cn.selected);\r\n\t\t\tif(aria){\r\n\t\t\t\t$ariaElem.attr(\"aria-selected\", true);\r\n\t\t\t}\r\n\t\t}else if(aria){\r\n\t\t\t$ariaElem.attr(\"aria-selected\", false);\r\n\t\t}\r\n\t\tif( node.extraClasses ){\r\n\t\t\tcnList.push(node.extraClasses);\r\n\t\t}\r\n\t\t// IE6 doesn't correctly evaluate multiple class names,\r\n\t\t// so we create combined class names that can be used in the CSS\r\n\t\tif( hasChildren === false ){\r\n\t\t\tcnList.push(cn.combinedExpanderPrefix + \"n\" +\r\n\t\t\t\t\t(isLastSib ? \"l\" : \"\")\r\n\t\t\t\t\t);\r\n\t\t}else{\r\n\t\t\tcnList.push(cn.combinedExpanderPrefix +\r\n\t\t\t\t\t(node.expanded ? \"e\" : \"c\") +\r\n\t\t\t\t\t(node.lazy && node.children == null ? \"d\" : \"\") +\r\n\t\t\t\t\t(isLastSib ? \"l\" : \"\")\r\n\t\t\t\t\t);\r\n\t\t}\r\n\t\tcnList.push(cn.combinedIconPrefix +\r\n\t\t\t\t(node.expanded ? \"e\" : \"c\") +\r\n\t\t\t\t(node.folder ? \"f\" : \"\")\r\n\t\t\t\t);\r\n//        node.span.className = cnList.join(\" \");\r\n\t\tstatusElem.className = cnList.join(\" \");\r\n\r\n\t\t// TODO: we should not set this in the <span> tag also, if we set it here:\r\n\t\t// Maybe most (all) of the classes should be set in LI instead of SPAN?\r\n\t\tif(node.li){\r\n\t\t\t// #719: we have to consider that there may be already other classes:\r\n\t\t\t$(node.li).toggleClass(cn.lastsib, isLastSib);\r\n\t\t}\r\n\t},\r\n\t/** Activate node.\r\n\t * flag defaults to true.\r\n\t * If flag is true, the node is activated (must be a synchronous operation)\r\n\t * If flag is false, the node is deactivated (must be a synchronous operation)\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} [flag=true]\r\n\t * @param {object} [opts] additional options. Defaults to {noEvents: false, noFocus: false}\r\n\t * @returns {$.Promise}\r\n\t */\r\n\tnodeSetActive: function(ctx, flag, callOpts) {\r\n\t\t// Handle user click / [space] / [enter], according to clickFolderMode.\r\n\t\tcallOpts = callOpts || {};\r\n\t\tvar subCtx,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\tnoEvents = (callOpts.noEvents === true),\r\n\t\t\tnoFocus = (callOpts.noFocus === true),\r\n\t\t\tisActive = (node === tree.activeNode);\r\n\r\n\t\t// flag defaults to true\r\n\t\tflag = (flag !== false);\r\n\t\t// node.debug(\"nodeSetActive\", flag);\r\n\r\n\t\tif(isActive === flag){\r\n\t\t\t// Nothing to do\r\n\t\t\treturn _getResolvedPromise(node);\r\n\t\t}else if(flag && !noEvents && this._triggerNodeEvent(\"beforeActivate\", node, ctx.originalEvent) === false ){\r\n\t\t\t// Callback returned false\r\n\t\t\treturn _getRejectedPromise(node, [\"rejected\"]);\r\n\t\t}\r\n\t\tif(flag){\r\n\t\t\tif(tree.activeNode){\r\n\t\t\t\t_assert(tree.activeNode !== node, \"node was active (inconsistency)\");\r\n\t\t\t\tsubCtx = $.extend({}, ctx, {node: tree.activeNode});\r\n\t\t\t\ttree.nodeSetActive(subCtx, false);\r\n\t\t\t\t_assert(tree.activeNode === null, \"deactivate was out of sync?\");\r\n\t\t\t}\r\n\t\t\tif(opts.activeVisible){\r\n\t\t\t\t// If no focus is set (noFocus: true) and there is no focused node, this node is made visible.\r\n\t\t\t\tnode.makeVisible({scrollIntoView: noFocus && tree.focusNode == null});\r\n\t\t\t}\r\n\t\t\ttree.activeNode = node;\r\n\t\t\ttree.nodeRenderStatus(ctx);\r\n\t\t\tif( !noFocus ) {\r\n\t\t\t\ttree.nodeSetFocus(ctx);\r\n\t\t\t}\r\n\t\t\tif( !noEvents ) {\r\n\t\t\t\ttree._triggerNodeEvent(\"activate\", node, ctx.originalEvent);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\t_assert(tree.activeNode === node, \"node was not active (inconsistency)\");\r\n\t\t\ttree.activeNode = null;\r\n\t\t\tthis.nodeRenderStatus(ctx);\r\n\t\t\tif( !noEvents ) {\r\n\t\t\t\tctx.tree._triggerNodeEvent(\"deactivate\", node, ctx.originalEvent);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn _getResolvedPromise(node);\r\n\t},\r\n\t/** Expand or collapse node, return Deferred.promise.\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} [flag=true]\r\n\t * @param {object} [opts] additional options. Defaults to {noAnimation: false, noEvents: false}\r\n\t * @returns {$.Promise} The deferred will be resolved as soon as the (lazy)\r\n\t *     data was retrieved, rendered, and the expand animation finshed.\r\n\t */\r\n\tnodeSetExpanded: function(ctx, flag, callOpts) {\r\n\t\tcallOpts = callOpts || {};\r\n\t\tvar _afterLoad, dfd, i, l, parents, prevAC,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\tnoAnimation = (callOpts.noAnimation === true),\r\n\t\t\tnoEvents = (callOpts.noEvents === true);\r\n\r\n\t\t// flag defaults to true\r\n\t\tflag = (flag !== false);\r\n\r\n\t\t// node.debug(\"nodeSetExpanded(\" + flag + \")\");\r\n\r\n\t\tif((node.expanded && flag) || (!node.expanded && !flag)){\r\n\t\t\t// Nothing to do\r\n\t\t\t// node.debug(\"nodeSetExpanded(\" + flag + \"): nothing to do\");\r\n\t\t\treturn _getResolvedPromise(node);\r\n\t\t}else if(flag && !node.lazy && !node.hasChildren() ){\r\n\t\t\t// Prevent expanding of empty nodes\r\n\t\t\t// return _getRejectedPromise(node, [\"empty\"]);\r\n\t\t\treturn _getResolvedPromise(node);\r\n\t\t}else if( !flag && node.getLevel() < opts.minExpandLevel ) {\r\n\t\t\t// Prevent collapsing locked levels\r\n\t\t\treturn _getRejectedPromise(node, [\"locked\"]);\r\n\t\t}else if ( /*!noEvents &&*/ this._triggerNodeEvent(\"beforeExpand\", node, ctx.originalEvent) === false ){ // iob fix\r\n\t\t\t// Callback returned false\r\n\t\t\treturn _getRejectedPromise(node, [\"rejected\"]);\r\n\t\t}\r\n\t\t// If this node inside a collpased node, no animation and scrolling is needed\r\n\t\tif( !noAnimation && !node.isVisible() ) {\r\n\t\t\tnoAnimation = callOpts.noAnimation = true;\r\n\t\t}\r\n\r\n\t\tdfd = new $.Deferred();\r\n\r\n\t\t// Auto-collapse mode: collapse all siblings\r\n\t\tif( flag && !node.expanded && opts.autoCollapse ) {\r\n\t\t\tparents = node.getParentList(false, true);\r\n\t\t\tprevAC = opts.autoCollapse;\r\n\t\t\ttry{\r\n\t\t\t\topts.autoCollapse = false;\r\n\t\t\t\tfor(i=0, l=parents.length; i<l; i++){\r\n\t\t\t\t\t// TODO: should return promise?\r\n\t\t\t\t\tthis._callHook(\"nodeCollapseSiblings\", parents[i], callOpts);\r\n\t\t\t\t}\r\n\t\t\t}finally{\r\n\t\t\t\topts.autoCollapse = prevAC;\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Trigger expand/collapse after expanding\r\n\t\tdfd.done(function(){\r\n\t\t\tvar\tlastChild = node.getLastChild();\r\n\r\n\t\t\tif( flag && opts.autoScroll && !noAnimation && lastChild ) {\r\n\t\t\t\t// Scroll down to last child, but keep current node visible\r\n\t\t\t\tlastChild.scrollIntoView(true, {topNode: node}).always(function(){\r\n\t\t\t\t\tif( !noEvents ) {\r\n\t\t\t\t\t\tctx.tree._triggerNodeEvent(flag ? \"expand\" : \"collapse\", ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tif( !noEvents ) {\r\n\t\t\t\t\tctx.tree._triggerNodeEvent(flag ? \"expand\" : \"collapse\", ctx);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\t// vvv Code below is executed after loading finished:\r\n\t\t_afterLoad = function(callback){\r\n\t\t\tvar cn = opts._classNames,\r\n\t\t\t\tisVisible, isExpanded,\r\n\t\t\t\teffect = opts.toggleEffect;\r\n\r\n\t\t\tnode.expanded = flag;\r\n\t\t\t// Create required markup, but make sure the top UL is hidden, so we\r\n\t\t\t// can animate later\r\n\t\t\ttree._callHook(\"nodeRender\", ctx, false, false, true);\r\n\r\n\t\t\t// Hide children, if node is collapsed\r\n\t\t\tif( node.ul ) {\r\n\t\t\t\tisVisible = (node.ul.style.display !== \"none\");\r\n\t\t\t\tisExpanded = !!node.expanded;\r\n\t\t\t\tif ( isVisible === isExpanded ) {\r\n\t\t\t\t\tnode.warn(\"nodeSetExpanded: UL.style.display already set\");\r\n\r\n\t\t\t\t} else if ( !effect || noAnimation ) {\r\n\t\t\t\t\tnode.ul.style.display = ( node.expanded || !parent ) ? \"\" : \"none\";\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// The UI toggle() effect works with the ext-wide extension,\r\n\t\t\t\t\t// while jQuery.animate() has problems when the title span\r\n\t\t\t\t\t// has positon: absolute.\r\n\t\t\t\t\t// Since jQuery UI 1.12, the blind effect requires the parent\r\n\t\t\t\t\t// element to have 'position: relative'.\r\n\t\t\t\t\t// See #716, #717\r\n\t\t\t\t\t$(node.li).addClass(cn.animating);  // #717\r\n//\t\t\t\t\tnode.info(\"fancytree-animating start: \" + node.li.className);\r\n\t\t\t\t\t$(node.ul)\r\n\t\t\t\t\t\t.addClass(cn.animating)  // # 716\r\n\t\t\t\t\t\t.toggle(effect.effect, effect.options, effect.duration, function(){\r\n//\t\t\t\t\t\t\tnode.info(\"fancytree-animating end: \" + node.li.className);\r\n\t\t\t\t\t\t\t$(this).removeClass(cn.animating);  // #716\r\n\t\t\t\t\t\t\t$(node.li).removeClass(cn.animating);  // #717\r\n\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcallback();\r\n\t\t};\r\n\t\t// ^^^ Code above is executed after loading finshed.\r\n\r\n\t\t// Load lazy nodes, if any. Then continue with _afterLoad()\r\n\t\tif(flag && node.lazy && node.hasChildren() === undefined){\r\n\t\t\t// node.debug(\"nodeSetExpanded: load start...\");\r\n\t\t\tnode.load().done(function(){\r\n\t\t\t\t// node.debug(\"nodeSetExpanded: load done\");\r\n\t\t\t\tif(dfd.notifyWith){ // requires jQuery 1.6+\r\n\t\t\t\t\tdfd.notifyWith(node, [\"loaded\"]);\r\n\t\t\t\t}\r\n\t\t\t\t_afterLoad(function () { dfd.resolveWith(node); });\r\n\t\t\t}).fail(function(errMsg){\r\n\t\t\t\t_afterLoad(function () { dfd.rejectWith(node, [\"load failed (\" + errMsg + \")\"]); });\r\n\t\t\t});\r\n/*\r\n\t\t\tvar source = tree._triggerNodeEvent(\"lazyLoad\", node, ctx.originalEvent);\r\n\t\t\t_assert(typeof source !== \"boolean\", \"lazyLoad event must return source in data.result\");\r\n\t\t\tnode.debug(\"nodeSetExpanded: load start...\");\r\n\t\t\tthis._callHook(\"nodeLoadChildren\", ctx, source).done(function(){\r\n\t\t\t\tnode.debug(\"nodeSetExpanded: load done\");\r\n\t\t\t\tif(dfd.notifyWith){ // requires jQuery 1.6+\r\n\t\t\t\t\tdfd.notifyWith(node, [\"loaded\"]);\r\n\t\t\t\t}\r\n\t\t\t\t_afterLoad.call(tree);\r\n\t\t\t}).fail(function(errMsg){\r\n\t\t\t\tdfd.rejectWith(node, [\"load failed (\" + errMsg + \")\"]);\r\n\t\t\t});\r\n*/\r\n\t\t}else{\r\n\t\t\t_afterLoad(function () { dfd.resolveWith(node); });\r\n\t\t}\r\n\t\t// node.debug(\"nodeSetExpanded: returns\");\r\n\t\treturn dfd.promise();\r\n\t},\r\n\t/** Focus or blur this node.\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} [flag=true]\r\n\t */\r\n\tnodeSetFocus: function(ctx, flag) {\r\n\t\t// ctx.node.debug(\"nodeSetFocus(\" + flag + \")\");\r\n\t\tvar ctx2,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\tnode = ctx.node,\r\n\t\t\topts = tree.options,\r\n\t\t\t// et = ctx.originalEvent && ctx.originalEvent.type,\r\n\t\t\tisInput = ctx.originalEvent ? $(ctx.originalEvent.target).is(\":input\") : false;\r\n\r\n\t\tflag = (flag !== false);\r\n\r\n\t\t// (node || tree).debug(\"nodeSetFocus(\" + flag + \"), event: \" + et + \", isInput: \"+ isInput);\r\n\t\t// Blur previous node if any\r\n\t\tif(tree.focusNode){\r\n\t\t\tif(tree.focusNode === node && flag){\r\n\t\t\t\t// node.debug(\"nodeSetFocus(\" + flag + \"): nothing to do\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tctx2 = $.extend({}, ctx, {node: tree.focusNode});\r\n\t\t\ttree.focusNode = null;\r\n\t\t\tthis._triggerNodeEvent(\"blur\", ctx2);\r\n\t\t\tthis._callHook(\"nodeRenderStatus\", ctx2);\r\n\t\t}\r\n\t\t// Set focus to container and node\r\n\t\tif(flag){\r\n\t\t\tif( !this.hasFocus() ){\r\n\t\t\t\tnode.debug(\"nodeSetFocus: forcing container focus\");\r\n\t\t\t\tthis._callHook(\"treeSetFocus\", ctx, true, {calledByNode: true});\r\n\t\t\t}\r\n\t\t\tnode.makeVisible({scrollIntoView: false});\r\n\t\t\ttree.focusNode = node;\r\n\t\t\tif( opts.titlesTabbable ) {\r\n\t\t\t\tif( !isInput ) { // #621\r\n\t\t\t\t\t$(node.span).find(\".fancytree-title\").focus();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// We cannot set KB focus to a node, so use the tree container\r\n\t\t\t\t// #563, #570: IE scrolls on every call to .focus(), if the container\r\n\t\t\t\t// is partially outside the viewport. So do it only, when absolutely\r\n\t\t\t\t// neccessary:\r\n\t\t\t\tif( $(document.activeElement).closest(\".fancytree-container\").length === 0 ) {\r\n\t\t\t\t\t$(tree.$container).focus();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif( opts.aria ){\r\n\t\t\t\t// Set active descendant to node's span ID (create one, if needed)\r\n\t\t\t\t$(tree.$container).attr(\"aria-activedescendant\",\r\n\t\t\t\t\t$( node.tr || node.li ).uniqueId().attr(\"id\"));\r\n\t\t\t\t\t// \"ftal_\" + opts.idPrefix + node.key);\r\n\t\t\t}\r\n//\t\t\t$(node.span).find(\".fancytree-title\").focus();\r\n\t\t\tthis._triggerNodeEvent(\"focus\", ctx);\r\n//          if( opts.autoActivate ){\r\n//              tree.nodeSetActive(ctx, true);\r\n//          }\r\n\t\t\tif( opts.autoScroll ){\r\n\t\t\t\tnode.scrollIntoView();\r\n\t\t\t}\r\n\t\t\tthis._callHook(\"nodeRenderStatus\", ctx);\r\n\t\t}\r\n\t},\r\n\t/** (De)Select node, return new status (sync).\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} [flag=true]\r\n\t * @param {object} [opts] additional options. Defaults to {noEvents: false,\r\n\t *     propagateDown: null, propagateUp: null,\r\n\t *     callback: null,\r\n\t *     }\r\n\t * @returns {boolean} previous status\r\n\t */\r\n\tnodeSetSelected: function(ctx, flag, callOpts) {\r\n\t\tcallOpts = callOpts || {};\r\n\t\tvar node = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\tnoEvents = (callOpts.noEvents === true),\r\n\t\t\tparent = node.parent;\r\n\r\n\t\t// flag defaults to true\r\n\t\tflag = (flag !== false);\r\n\r\n\t\t// node.debug(\"nodeSetSelected(\" + flag + \")\", ctx);\r\n\r\n\t\t// Cannot (de)select unselectable nodes directly (only by propagation or\r\n\t\t// by setting the `.selected` property)\r\n\t\tif( FT.evalOption(\"unselectable\", node, node, opts, false) ){\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Remember the user's intent, in case down -> up propagation prevents\r\n\t\t// applying it to node.selected\r\n\t\tnode._lastSelectIntent = flag;\r\n\r\n\t\t// Nothing to do?\r\n\t\t/*jshint -W018 */  // Confusing use of '!'\r\n\t\tif( !!node.selected === flag ){\r\n\t\t\tif( opts.selectMode === 3 && node.partsel && !flag ){\r\n\t\t\t\t// If propagation prevented selecting this node last time, we still\r\n\t\t\t\t// want to allow to apply setSelected(false) now\r\n\t\t\t}else{\r\n\t\t\t\treturn flag;\r\n\t\t\t}\r\n\t\t}\r\n\t\t/*jshint +W018 */\r\n\r\n\t\tif( !noEvents &&\r\n\t\t\tthis._triggerNodeEvent(\"beforeSelect\", node, ctx.originalEvent) === false ) {\r\n\t\t\t\treturn !!node.selected;\r\n\t\t}\r\n\t\tif(flag && opts.selectMode === 1){\r\n\t\t\t// single selection mode (we don't uncheck all tree nodes, for performance reasons)\r\n\t\t\tif(tree.lastSelectedNode){\r\n\t\t\t\ttree.lastSelectedNode.setSelected(false);\r\n\t\t\t}\r\n\t\t\tnode.selected = flag;\r\n\t\t}else if(opts.selectMode === 3 && parent && !parent.radiogroup && !node.radiogroup){\r\n\t\t\t// multi-hierarchical selection mode\r\n\t\t\tnode.selected = flag;\r\n\t\t\tnode.fixSelection3AfterClick(callOpts);\r\n\t\t}else if(parent && parent.radiogroup){\r\n\t\t\tnode.visitSiblings(function(n){\r\n\t\t\t\tn._changeSelectStatusAttrs(flag && n === node);\r\n\t\t\t}, true);\r\n\t\t}else{\r\n\t\t\t// default: selectMode: 2, multi selection mode\r\n\t\t\tnode.selected = flag;\r\n\t\t}\r\n\t\tthis.nodeRenderStatus(ctx);\r\n\t\ttree.lastSelectedNode = flag ? node : null;\r\n\t\tif( !noEvents ) {\r\n\t\t\ttree._triggerNodeEvent(\"select\", ctx);\r\n\t\t}\r\n\t},\r\n\t/** Show node status (ok, loading, error, nodata) using styles and a dummy child node.\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t * @param status\r\n\t * @param message\r\n\t * @param details\r\n\t * @since 2.3\r\n\t */\r\n\tnodeSetStatus: function(ctx, status, message, details) {\r\n\t\tvar node = ctx.node,\r\n\t\t\ttree = ctx.tree;\r\n\r\n\t\tfunction _clearStatusNode() {\r\n\t\t\t// Remove dedicated dummy node, if any\r\n\t\t\tvar firstChild = ( node.children ? node.children[0] : null );\r\n\t\t\tif ( firstChild && firstChild.isStatusNode() ) {\r\n\t\t\t\ttry{\r\n\t\t\t\t\t// I've seen exceptions here with loadKeyPath...\r\n\t\t\t\t\tif(node.ul){\r\n\t\t\t\t\t\tnode.ul.removeChild(firstChild.li);\r\n\t\t\t\t\t\tfirstChild.li = null; // avoid leaks (DT issue 215)\r\n\t\t\t\t\t}\r\n\t\t\t\t}catch(e){}\r\n\t\t\t\tif( node.children.length === 1 ){\r\n\t\t\t\t\tnode.children = [];\r\n\t\t\t\t}else{\r\n\t\t\t\t\tnode.children.shift();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction _setStatusNode(data, type) {\r\n\t\t\t// Create/modify the dedicated dummy node for 'loading...' or\r\n\t\t\t// 'error!' status. (only called for direct child of the invisible\r\n\t\t\t// system root)\r\n\t\t\tvar firstChild = ( node.children ? node.children[0] : null );\r\n\t\t\tif ( firstChild && firstChild.isStatusNode() ) {\r\n\t\t\t\t$.extend(firstChild, data);\r\n\t\t\t\tfirstChild.statusNodeType = type;\r\n\t\t\t\ttree._callHook(\"nodeRenderTitle\", firstChild);\r\n\t\t\t} else {\r\n\t\t\t\tnode._setChildren([data]);\r\n\t\t\t\tnode.children[0].statusNodeType = type;\r\n\t\t\t\ttree.render();\r\n\t\t\t}\r\n\t\t\treturn node.children[0];\r\n\t\t}\r\n\r\n\t\tswitch( status ){\r\n\t\tcase \"ok\":\r\n\t\t\t_clearStatusNode();\r\n\t\t\tnode._isLoading = false;\r\n\t\t\tnode._error = null;\r\n\t\t\tnode.renderStatus();\r\n\t\t\tbreak;\r\n\t\tcase \"loading\":\r\n\t\t\tif( !node.parent ) {\r\n\t\t\t\t_setStatusNode({\r\n\t\t\t\t\ttitle: tree.options.strings.loading + (message ? \" (\" + message + \")\" : \"\"),\r\n\t\t\t\t\t// icon: true,  // needed for 'loding' icon\r\n\t\t\t\t\tcheckbox: false,\r\n\t\t\t\t\ttooltip: details\r\n\t\t\t\t}, status);\r\n\t\t\t}\r\n\t\t\tnode._isLoading = true;\r\n\t\t\tnode._error = null;\r\n\t\t\tnode.renderStatus();\r\n\t\t\tbreak;\r\n\t\tcase \"error\":\r\n\t\t\t_setStatusNode({\r\n\t\t\t\ttitle: tree.options.strings.loadError + (message ? \" (\" + message + \")\" : \"\"),\r\n\t\t\t\t// icon: false,\r\n\t\t\t\tcheckbox: false,\r\n\t\t\t\ttooltip: details\r\n\t\t\t}, status);\r\n\t\t\tnode._isLoading = false;\r\n\t\t\tnode._error = { message: message, details: details };\r\n\t\t\tnode.renderStatus();\r\n\t\t\tbreak;\r\n\t\tcase \"nodata\":\r\n\t\t\t_setStatusNode({\r\n\t\t\t\ttitle: tree.options.strings.noData,\r\n\t\t\t\t// icon: false,\r\n\t\t\t\tcheckbox: false,\r\n\t\t\t\ttooltip: details\r\n\t\t\t}, status);\r\n\t\t\tnode._isLoading = false;\r\n\t\t\tnode._error = null;\r\n\t\t\tnode.renderStatus();\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\t$.error(\"invalid node status \" + status);\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t *\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeToggleExpanded: function(ctx) {\r\n\t\treturn this.nodeSetExpanded(ctx, !ctx.node.expanded);\r\n\t},\r\n\t/**\r\n\t * @param {EventData} ctx\r\n\t */\r\n\tnodeToggleSelected: function(ctx) {\r\n\t\tvar node = ctx.node,\r\n\t\t\tflag = !node.selected;\r\n\r\n\t\t// In selectMode: 3 this node may be unselected+partsel, even if\r\n\t\t// setSelected(true) was called before, due to `unselectable` children.\r\n\t\t// In this case, we now toggle as `setSelected(false)`\r\n\t\tif( node.partsel && !node.selected && node._lastSelectIntent === true ) {\r\n\t\t\tflag = false;\r\n\t\t\tnode.selected = true;  // so it is not considered 'nothing to do'\r\n\t\t}\r\n\t\tnode._lastSelectIntent = flag;\r\n\t\treturn this.nodeSetSelected(ctx, flag);\r\n\t},\r\n\t/** Remove all nodes.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\ttreeClear: function(ctx) {\r\n\t\tvar tree = ctx.tree;\r\n\t\ttree.activeNode = null;\r\n\t\ttree.focusNode = null;\r\n\t\ttree.$div.find(\">ul.fancytree-container\").empty();\r\n\t\t// TODO: call destructors and remove reference loops\r\n\t\ttree.rootNode.children = null;\r\n\t},\r\n\t/** Widget was created (called only once, even it re-initialized).\r\n\t * @param {EventData} ctx\r\n\t */\r\n\ttreeCreate: function(ctx) {\r\n\t},\r\n\t/** Widget was destroyed.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\ttreeDestroy: function(ctx) {\r\n\t\tthis.$div.find(\">ul.fancytree-container\").remove();\r\n\t\tthis.$source && this.$source.removeClass(\"ui-helper-hidden\");\r\n\t},\r\n\t/** Widget was (re-)initialized.\r\n\t * @param {EventData} ctx\r\n\t */\r\n\ttreeInit: function(ctx) {\r\n\t\tvar tree = ctx.tree,\r\n\t\t\topts = tree.options;\r\n\r\n\t\t//this.debug(\"Fancytree.treeInit()\");\r\n\t\t// Add container to the TAB chain\r\n\t\t// See http://www.w3.org/TR/wai-aria-practices/#focus_activedescendant\r\n\t\t// #577: Allow to set tabindex to \"0\", \"-1\" and \"\"\r\n\t\ttree.$container.attr(\"tabindex\", opts.tabindex);\r\n\r\n\t\t// Copy some attributes to tree.data\r\n\t\t$.each(TREE_ATTRS, function(i, attr) {\r\n\t\t\tif( opts[attr] !== undefined ){\r\n\t\t\t\ttree.info(\"Move option \" + attr + \" to tree\");\r\n\t\t\t\ttree[attr] = opts[attr];\r\n\t\t\t\tdelete opts[attr];\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tif( opts.rtl ) {\r\n\t\t\ttree.$container.attr(\"DIR\", \"RTL\").addClass(\"fancytree-rtl\");\r\n\t\t}else{\r\n\t\t\ttree.$container.removeAttr(\"DIR\").removeClass(\"fancytree-rtl\");\r\n\t\t}\r\n\t\tif( opts.aria ){\r\n\t\t\ttree.$container.attr(\"role\", \"tree\");\r\n\t\t\tif( opts.selectMode !== 1 ) {\r\n\t\t\t\ttree.$container.attr(\"aria-multiselectable\", true);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.treeLoad(ctx);\r\n\t},\r\n\t/** Parse Fancytree from source, as configured in the options.\r\n\t * @param {EventData} ctx\r\n\t * @param {object} [source] optional new source (use last data otherwise)\r\n\t */\r\n\ttreeLoad: function(ctx, source) {\r\n\t\tvar metaData, type, $ul,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\t$container = ctx.widget.element,\r\n\t\t\tdfd,\r\n\t\t\t// calling context for root node\r\n\t\t\trootCtx = $.extend({}, ctx, {node: this.rootNode});\r\n\r\n\t\tif(tree.rootNode.children){\r\n\t\t\tthis.treeClear(ctx);\r\n\t\t}\r\n\t\tsource = source || this.options.source;\r\n\r\n\t\tif(!source){\r\n\t\t\ttype = $container.data(\"type\") || \"html\";\r\n\t\t\tswitch(type){\r\n\t\t\tcase \"html\":\r\n\t\t\t\t$ul = $container.find(\">ul:first\");\r\n\t\t\t\t$ul.addClass(\"ui-fancytree-source ui-helper-hidden\");\r\n\t\t\t\tsource = $.ui.fancytree.parseHtml($ul);\r\n\t\t\t\t// allow to init tree.data.foo from <ul data-foo=''>\r\n\t\t\t\tthis.data = $.extend(this.data, _getElementDataAsDict($ul));\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"json\":\r\n\t\t\t\tsource = $.parseJSON($container.text());\r\n\t\t\t\t// $container already contains the <ul>, but we remove the plain (json) text\r\n\t\t\t\t// $container.empty();\r\n\t\t\t\t$container.contents().filter(function(){\r\n\t\t\t\t\treturn (this.nodeType === 3);\r\n\t\t\t\t}).remove();\r\n\t\t\t\tif( $.isPlainObject(source) ){\r\n\t\t\t\t\t// We got {foo: 'abc', children: [...]}\r\n\t\t\t\t\t_assert($.isArray(source.children), \"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')\");\r\n\t\t\t\t\tmetaData = source;\r\n\t\t\t\t\tsource = source.children;\r\n\t\t\t\t\tdelete metaData.children;\r\n\t\t\t\t\t// Copy some attributes to tree.data\r\n\t\t\t\t\t$.each(TREE_ATTRS, function(i, attr) {\r\n\t\t\t\t\t\tif( metaData[attr] !== undefined ){\r\n\t\t\t\t\t\t\ttree[attr] = metaData[attr];\r\n\t\t\t\t\t\t\tdelete metaData[attr];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// Copy extra properties to tree.data.foo\r\n\t\t\t\t\t$.extend(tree.data, metaData);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\t$.error(\"Invalid data-type: \" + type);\r\n\t\t\t}\r\n\t\t}else if(typeof source === \"string\"){\r\n\t\t\t// TODO: source is an element ID\r\n\t\t\t$.error(\"Not implemented\");\r\n\t\t}\r\n\r\n\t\t// Trigger fancytreeinit after nodes have been loaded\r\n\t\tdfd = this.nodeLoadChildren(rootCtx, source).done(function(){\r\n\t\t\ttree.render();\r\n\t\t\tif( ctx.options.selectMode === 3 ){\r\n\t\t\t\ttree.rootNode.fixSelection3FromEndNodes();\r\n\t\t\t}\r\n\t\t\tif( tree.activeNode && tree.options.activeVisible ) {\r\n\t\t\t\ttree.activeNode.makeVisible();\r\n\t\t\t}\r\n\t\t\ttree._triggerTreeEvent(\"init\", null, { status: true });\r\n\t\t}).fail(function(){\r\n\t\t\ttree.render();\r\n\t\t\ttree._triggerTreeEvent(\"init\", null, { status: false });\r\n\t\t});\r\n\t\treturn dfd;\r\n\t},\r\n\t/** Node was inserted into or removed from the tree.\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} add\r\n\t * @param {FancytreeNode} node\r\n\t */\r\n\ttreeRegisterNode: function(ctx, add, node) {\r\n\t},\r\n\t/** Widget got focus.\r\n\t * @param {EventData} ctx\r\n\t * @param {boolean} [flag=true]\r\n\t */\r\n\ttreeSetFocus: function(ctx, flag, callOpts) {\r\n\t\tvar targetNode;\r\n\r\n\t\tflag = (flag !== false);\r\n\r\n\t\t// this.debug(\"treeSetFocus(\" + flag + \"), callOpts: \", callOpts, this.hasFocus());\r\n\t\t// this.debug(\"    focusNode: \" + this.focusNode);\r\n\t\t// this.debug(\"    activeNode: \" + this.activeNode);\r\n\t\tif( flag !== this.hasFocus() ){\r\n\t\t\tthis._hasFocus = flag;\r\n\t\t\tif( !flag && this.focusNode ) {\r\n\t\t\t\t// Node also looses focus if widget blurs\r\n\t\t\t\tthis.focusNode.setFocus(false);\r\n\t\t\t} else if ( flag && (!callOpts || !callOpts.calledByNode) ) {\r\n\t\t\t\t$(this.$container).focus();\r\n\t\t\t}\r\n\t\t\tthis.$container.toggleClass(\"fancytree-treefocus\", flag);\r\n\t\t\tthis._triggerTreeEvent(flag ? \"focusTree\" : \"blurTree\");\r\n\t\t\tif( flag && !this.activeNode ) {\r\n\t\t\t\t// #712: Use last mousedowned node ('click' event fires after focusin)\r\n\t\t\t\ttargetNode = this._lastMousedownNode || this.getFirstChild();\r\n\t\t\t\ttargetNode && targetNode.setFocus();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/** Widget option was set using `$().fancytree(\"option\", \"foo\", \"bar\")`.\r\n\t * @param {EventData} ctx\r\n\t * @param {string} key option name\r\n\t * @param {any} value option value\r\n\t */\r\n\ttreeSetOption: function(ctx, key, value) {\r\n\t\tvar tree = ctx.tree,\r\n\t\t\tcallDefault = true,\r\n\t\t\tcallCreate = false,\r\n\t\t\tcallRender = false;\r\n\r\n\t\tswitch( key ) {\r\n\t\tcase \"aria\":\r\n\t\tcase \"checkbox\":\r\n\t\tcase \"icon\":\r\n\t\tcase \"minExpandLevel\":\r\n\t\tcase \"tabindex\":\r\n\t\t\t// tree._callHook(\"treeCreate\", tree);\r\n\t\t\tcallCreate = true;\r\n\t\t\tcallRender = true;\r\n\t\t\tbreak;\r\n\t\tcase \"escapeTitles\":\r\n\t\tcase \"tooltip\":\r\n\t\t\tcallRender = true;\r\n\t\t\tbreak;\r\n\t\tcase \"rtl\":\r\n\t\t\tif( value === false ) {\r\n\t\t\t\ttree.$container.removeAttr(\"DIR\").removeClass(\"fancytree-rtl\");\r\n\t\t\t}else{\r\n\t\t\t\ttree.$container.attr(\"DIR\", \"RTL\").addClass(\"fancytree-rtl\");\r\n\t\t\t}\r\n\t\t\tcallRender = true;\r\n\t\t\tbreak;\r\n\t\tcase \"source\":\r\n\t\t\tcallDefault = false;\r\n\t\t\ttree._callHook(\"treeLoad\", tree, value);\r\n\t\t\tcallRender = true;\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\ttree.debug(\"set option \" + key + \"=\" + value + \" <\" + typeof(value) + \">\");\r\n\t\tif(callDefault){\r\n\t\t\tif( this.widget._super ) {\r\n\t\t\t\t// jQuery UI 1.9+\r\n\t\t\t\tthis.widget._super.call( this.widget, key, value );\r\n\t\t\t} else {\r\n\t\t\t\t// jQuery UI <= 1.8, we have to manually invoke the _setOption method from the base widget\r\n\t\t\t\t$.Widget.prototype._setOption.call(this.widget, key, value);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(callCreate){\r\n\t\t\ttree._callHook(\"treeCreate\", tree);\r\n\t\t}\r\n\t\tif(callRender){\r\n\t\t\ttree.render(true, false);  // force, not-deep\r\n\t\t}\r\n\t}\r\n});\r\n\r\n\r\n/* ******************************************************************************\r\n * jQuery UI widget boilerplate\r\n */\r\n\r\n/**\r\n * The plugin (derrived from <a href=\" http://api.jqueryui.com/jQuery.widget/\">jQuery.Widget</a>).<br>\r\n * This constructor is not called directly. Use `$(selector).fancytree({})`\r\n * to initialize the plugin instead.<br>\r\n * <pre class=\"sh_javascript sunlight-highlight-javascript\">// Access widget methods and members:\r\n * var tree = $(\"#tree\").fancytree(\"getTree\");\r\n * var node = $(\"#tree\").fancytree(\"getActiveNode\", \"1234\");\r\n * </pre>\r\n *\r\n * @mixin Fancytree_Widget\r\n */\r\n\r\n$.widget(\"ui.fancytree\",\r\n\t/** @lends Fancytree_Widget# */\r\n\t{\r\n\t/**These options will be used as defaults\r\n\t * @type {FancytreeOptions}\r\n\t */\r\n\toptions:\r\n\t{\r\n\t\tactiveVisible: true,\r\n\t\tajax: {\r\n\t\t\ttype: \"GET\",\r\n\t\t\tcache: false, // false: Append random '_' argument to the request url to prevent caching.\r\n//          timeout: 0, // >0: Make sure we get an ajax error if server is unreachable\r\n\t\t\tdataType: \"json\" // Expect json format and pass json object to callbacks.\r\n\t\t},  //\r\n\t\taria: true,\r\n\t\tautoActivate: true,\r\n\t\tautoCollapse: false,\r\n\t\tautoScroll: false,\r\n\t\tcheckbox: false,\r\n\t\tclickFolderMode: 4,\r\n\t\tdebugLevel: null, // 0..2 (null: use global setting $.ui.fancytree.debugInfo)\r\n\t\tdisabled: false, // TODO: required anymore?\r\n\t\tenableAspx: true,\r\n\t\tescapeTitles: false,\r\n\t\textensions: [],\r\n\t\t// fx: { height: \"toggle\", duration: 200 },\r\n\t\t// toggleEffect: { effect: \"drop\", options: {direction: \"left\"}, duration: 200 },\r\n\t\t// toggleEffect: { effect: \"slide\", options: {direction: \"up\"}, duration: 200 },\r\n\t\ttoggleEffect: { effect: \"blind\", options: {direction: \"vertical\", scale: \"box\"}, duration: 200 },\r\n\t\tgenerateIds: false,\r\n\t\ticon: true,\r\n\t\tidPrefix: \"ft_\",\r\n\t\tfocusOnSelect: false,\r\n\t\tkeyboard: true,\r\n\t\tkeyPathSeparator: \"/\",\r\n\t\tminExpandLevel: 1,\r\n\t\tquicksearch: false,\r\n\t\trtl: false,\r\n\t\tscrollOfs: {top: 0, bottom: 0},\r\n\t\tscrollParent: null,\r\n\t\tselectMode: 2,\r\n\t\tstrings: {\r\n\t\t\tloading: \"Loading...\",  // &#8230; would be escaped when escapeTitles is true\r\n\t\t\tloadError: \"Load error!\",\r\n\t\t\tmoreData: \"More...\",\r\n\t\t\tnoData: \"No data.\"\r\n\t\t},\r\n\t\ttabindex: \"0\",\r\n\t\ttitlesTabbable: false,\r\n\t\ttooltip: false,\r\n\t\t_classNames: {\r\n\t\t\tnode: \"fancytree-node\",\r\n\t\t\tfolder: \"fancytree-folder\",\r\n\t\t\tanimating: \"fancytree-animating\",\r\n\t\t\tcombinedExpanderPrefix: \"fancytree-exp-\",\r\n\t\t\tcombinedIconPrefix: \"fancytree-ico-\",\r\n\t\t\thasChildren: \"fancytree-has-children\",\r\n\t\t\tactive: \"fancytree-active\",\r\n\t\t\tselected: \"fancytree-selected\",\r\n\t\t\texpanded: \"fancytree-expanded\",\r\n\t\t\tlazy: \"fancytree-lazy\",\r\n\t\t\tfocused: \"fancytree-focused\",\r\n\t\t\tpartload: \"fancytree-partload\",\r\n\t\t\tpartsel: \"fancytree-partsel\",\r\n\t\t\tradio: \"fancytree-radio\",\r\n\t\t\t// radiogroup: \"fancytree-radiogroup\",\r\n\t\t\tunselectable: \"fancytree-unselectable\",\r\n\t\t\tlastsib: \"fancytree-lastsib\",\r\n\t\t\tloading: \"fancytree-loading\",\r\n\t\t\terror: \"fancytree-error\",\r\n\t\t\tstatusNodePrefix: \"fancytree-statusnode-\"\r\n\t\t},\r\n\t\t// events\r\n\t\tlazyLoad: null,\r\n\t\tpostProcess: null\r\n\t},\r\n\t/* Set up the widget, Called on first $().fancytree() */\r\n\t_create: function() {\r\n\t\tthis.tree = new Fancytree(this);\r\n\r\n\t\tthis.$source = this.source || this.element.data(\"type\") === \"json\" ? this.element\r\n\t\t\t: this.element.find(\">ul:first\");\r\n\t\t// Subclass Fancytree instance with all enabled extensions\r\n\t\tvar extension, extName, i,\r\n\t\t\topts = this.options,\r\n\t\t\textensions = opts.extensions,\r\n\t\t\tbase = this.tree;\r\n\r\n\t\tfor(i=0; i<extensions.length; i++){\r\n\t\t\textName = extensions[i];\r\n\t\t\textension = $.ui.fancytree._extensions[extName];\r\n\t\t\tif(!extension){\r\n\t\t\t\t$.error(\"Could not apply extension '\" + extName + \"' (it is not registered, did you forget to include it?)\");\r\n\t\t\t}\r\n\t\t\t// Add extension options as tree.options.EXTENSION\r\n//\t\t\t_assert(!this.tree.options[extName], \"Extension name must not exist as option name: \" + extName);\r\n\t\t\tthis.tree.options[extName] = $.extend(true, {}, extension.options, this.tree.options[extName]);\r\n\t\t\t// Add a namespace tree.ext.EXTENSION, to hold instance data\r\n\t\t\t_assert(this.tree.ext[extName] === undefined, \"Extension name must not exist as Fancytree.ext attribute: '\" + extName + \"'\");\r\n//\t\t\tthis.tree[extName] = extension;\r\n\t\t\tthis.tree.ext[extName] = {};\r\n\t\t\t// Subclass Fancytree methods using proxies.\r\n\t\t\t_subclassObject(this.tree, base, extension, extName);\r\n\t\t\t// current extension becomes base for the next extension\r\n\t\t\tbase = extension;\r\n\t\t}\r\n\t\t//\r\n\t\tif( opts.icons !== undefined ) {  // 2015-11-16\r\n\t\t\tif( opts.icon !== true ) {\r\n\t\t\t\t$.error(\"'icons' tree option is deprecated since v2.14.0: use 'icon' only instead\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.tree.warn(\"'icons' tree option is deprecated since v2.14.0: use 'icon' instead\");\r\n\t\t\t\topts.icon = opts.icons;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( opts.iconClass !== undefined ) {  // 2015-11-16\r\n\t\t\tif( opts.icon ) {\r\n\t\t\t\t$.error(\"'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead\");\r\n\t\t\t} else {\r\n\t\t\t\tthis.tree.warn(\"'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead\");\r\n\t\t\t\topts.icon = opts.iconClass;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( opts.tabbable !== undefined ) {  // 2016-04-04\r\n\t\t\topts.tabindex = opts.tabbable ? \"0\" : \"-1\";\r\n\t\t\tthis.tree.warn(\"'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='\" + opts.tabindex + \"' instead\");\r\n\t\t}\r\n\t\t//\r\n\t\tthis.tree._callHook(\"treeCreate\", this.tree);\r\n\t\t// Note: 'fancytreecreate' event is fired by widget base class\r\n//        this.tree._triggerTreeEvent(\"create\");\r\n\t},\r\n\r\n\t/* Called on every $().fancytree() */\r\n\t_init: function() {\r\n\t\tthis.tree._callHook(\"treeInit\", this.tree);\r\n\t\t// TODO: currently we call bind after treeInit, because treeInit\r\n\t\t// might change tree.$container.\r\n\t\t// It would be better, to move event binding into hooks altogether\r\n\t\tthis._bind();\r\n\t},\r\n\r\n\t/* Use the _setOption method to respond to changes to options */\r\n\t_setOption: function(key, value) {\r\n\t\treturn this.tree._callHook(\"treeSetOption\", this.tree, key, value);\r\n\t},\r\n\r\n\t/** Use the destroy method to clean up any modifications your widget has made to the DOM */\r\n\tdestroy: function() {\r\n\t\tthis._unbind();\r\n\t\tthis.tree._callHook(\"treeDestroy\", this.tree);\r\n\t\t// In jQuery UI 1.8, you must invoke the destroy method from the base widget\r\n\t\t$.Widget.prototype.destroy.call(this);\r\n\t\t// TODO: delete tree and nodes to make garbage collect easier?\r\n\t\t// TODO: In jQuery UI 1.9 and above, you would define _destroy instead of destroy and not call the base method\r\n\t},\r\n\r\n\t// -------------------------------------------------------------------------\r\n\r\n\t/* Remove all event handlers for our namespace */\r\n\t_unbind: function() {\r\n\t\tvar ns = this.tree._ns;\r\n\t\tthis.element.off(ns);\r\n\t\tthis.tree.$container.off(ns);\r\n\t\t$(document).off(ns);\r\n\t},\r\n\t/* Add mouse and kyboard handlers to the container */\r\n\t_bind: function() {\r\n\t\tvar that = this,\r\n\t\t\topts = this.options,\r\n\t\t\ttree = this.tree,\r\n\t\t\tns = tree._ns\r\n\t\t\t// selstartEvent = ( $.support.selectstart ? \"selectstart\" : \"mousedown\" )\r\n\t\t\t;\r\n\r\n\t\t// Remove all previuous handlers for this tree\r\n\t\tthis._unbind();\r\n\r\n\t\t//alert(\"keydown\" + ns + \"foc=\" + tree.hasFocus() + tree.$container);\r\n\t\t// tree.debug(\"bind events; container: \", tree.$container);\r\n\t\ttree.$container.on(\"focusin\" + ns + \" focusout\" + ns, function(event){\r\n\t\t\tvar node = FT.getNode(event),\r\n\t\t\t\tflag = (event.type === \"focusin\");\r\n\r\n\t\t\t// tree.treeOnFocusInOut.call(tree, event);\r\n\t\t\t// tree.debug(\"Tree container got event \" + event.type, node, event, FT.getEventTarget(event));\r\n\t\t\tif( flag && tree._getExpiringValue(\"focusin\") ) {\r\n\t\t\t\t// #789: IE 11 may send duplicate focusin events\r\n\t\t\t\tFT.info(\"Ignored double focusin.\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\ttree._setExpiringValue(\"focusin\", true, 50);\r\n\r\n\t\t\tif( flag && !node ) {\r\n\t\t\t\t// #789: IE 11 may send focusin before mousdown(?)\r\n\t\t\t\tnode = tree._getExpiringValue(\"mouseDownNode\");\r\n\t\t\t\tif( node ) { FT.info(\"Reconstruct mouse target for focusin from recent event.\"); }\r\n\t\t\t}\r\n\t\t\tif(node){\r\n\t\t\t\t// For example clicking into an <input> that is part of a node\r\n\t\t\t\ttree._callHook(\"nodeSetFocus\", tree._makeHookContext(node, event), flag);\r\n\t\t\t}else{\r\n\t\t\t\tif( tree.tbody && $(event.target).parents(\"table.fancytree-container > thead\").length ) {\r\n\t\t\t\t\t// #767: ignore events in the table's header\r\n\t\t\t\t\ttree.debug(\"Ignore focus event outside table body.\", event);\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttree._callHook(\"treeSetFocus\", tree, flag);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}).on(\"selectstart\" + ns, \"span.fancytree-title\", function(event){\r\n\t\t\t// prevent mouse-drags to select text ranges\r\n\t\t\t// tree.debug(\"<span title> got event \" + event.type);\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t}).on(\"keydown\" + ns, function(event){\r\n\t\t\t// TODO: also bind keyup and keypress\r\n\t\t\t// tree.debug(\"got event \" + event.type + \", hasFocus:\" + tree.hasFocus());\r\n\t\t\t// if(opts.disabled || opts.keyboard === false || !tree.hasFocus() ){\r\n\t\t\tif(opts.disabled || opts.keyboard === false ){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar res,\r\n\t\t\t\tnode = tree.focusNode, // node may be null\r\n\t\t\t\tctx = tree._makeHookContext(node || tree, event),\r\n\t\t\t\tprevPhase = tree.phase;\r\n\r\n\t\t\ttry {\r\n\t\t\t\ttree.phase = \"userEvent\";\r\n\t\t\t\t// If a 'fancytreekeydown' handler returns false, skip the default\r\n\t\t\t\t// handling (implemented by tree.nodeKeydown()).\r\n\t\t\t\tif(node){\r\n\t\t\t\t\tres = tree._triggerNodeEvent(\"keydown\", node, event);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tres = tree._triggerTreeEvent(\"keydown\", event);\r\n\t\t\t\t}\r\n\t\t\t\tif ( res === \"preventNav\" ){\r\n\t\t\t\t\tres = true; // prevent keyboard navigation, but don't prevent default handling of embedded input controls\r\n\t\t\t\t} else if ( res !== false ){\r\n\t\t\t\t\tres = tree._callHook(\"nodeKeydown\", ctx);\r\n\t\t\t\t}\r\n\t\t\t\treturn res;\r\n\t\t\t} finally {\r\n\t\t\t\ttree.phase = prevPhase;\r\n\t\t\t}\r\n\r\n\t\t}).on(\"mousedown\" + ns, function(event){\r\n\t\t\tvar et = FT.getEventTarget(event);\r\n\t\t\t// that.tree.debug(\"event(\" + event.type + \"): node: \", et.node);\r\n\t\t\t// #712: Store the clicked node, so we can use it when we get a focusin event\r\n\t\t\t//       ('click' event fires after focusin)\r\n\t\t\t// tree.debug(\"event(\" + event.type + \"): node: \", et.node);\r\n\t\t\ttree._lastMousedownNode = et ? et.node : null;\r\n\t\t\t// #789: Store the node also for a short period, so we can use it\r\n\t\t\t// in a *resulting* focusin event\r\n\t\t\ttree._setExpiringValue(\"mouseDownNode\", tree._lastMousedownNode);\r\n\r\n\t\t}).on(\"click\" + ns + \" dblclick\" + ns, function(event){\r\n\t\t\tif(opts.disabled){\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tvar ctx,\r\n\t\t\t\tet = FT.getEventTarget(event),\r\n\t\t\t\tnode = et.node,\r\n\t\t\t\ttree = that.tree,\r\n\t\t\t\tprevPhase = tree.phase;\r\n\r\n\t\t\t// that.tree.debug(\"event(\" + event.type + \"): node: \", node);\r\n\t\t\tif( !node ){\r\n\t\t\t\treturn true;  // Allow bubbling of other events\r\n\t\t\t}\r\n\t\t\tctx = tree._makeHookContext(node, event);\r\n\t\t\t// that.tree.debug(\"event(\" + event.type + \"): node: \", node);\r\n\t\t\ttry {\r\n\t\t\t\ttree.phase = \"userEvent\";\r\n\t\t\t\tswitch(event.type) {\r\n\t\t\t\tcase \"click\":\r\n\t\t\t\t\tctx.targetType = et.type;\r\n\t\t\t\t\tif( node.isPagingNode() ) {\r\n\t\t\t\t\t\treturn tree._triggerNodeEvent(\"clickPaging\", ctx, event) === true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( tree._triggerNodeEvent(\"click\", ctx, event) === false ) ? false : tree._callHook(\"nodeClick\", ctx);\r\n\t\t\t\tcase \"dblclick\":\r\n\t\t\t\t\tctx.targetType = et.type;\r\n\t\t\t\t\treturn ( tree._triggerNodeEvent(\"dblclick\", ctx, event) === false ) ? false : tree._callHook(\"nodeDblclick\", ctx);\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\ttree.phase = prevPhase;\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\t/** Return the active node or null.\r\n\t * @returns {FancytreeNode}\r\n\t */\r\n\tgetActiveNode: function() {\r\n\t\treturn this.tree.activeNode;\r\n\t},\r\n\t/** Return the matching node or null.\r\n\t * @param {string} key\r\n\t * @returns {FancytreeNode}\r\n\t */\r\n\tgetNodeByKey: function(key) {\r\n\t\treturn this.tree.getNodeByKey(key);\r\n\t},\r\n\t/** Return the invisible system root node.\r\n\t * @returns {FancytreeNode}\r\n\t */\r\n\tgetRootNode: function() {\r\n\t\treturn this.tree.rootNode;\r\n\t},\r\n\t/** Return the current tree instance.\r\n\t * @returns {Fancytree}\r\n\t */\r\n\tgetTree: function() {\r\n\t\treturn this.tree;\r\n\t}\r\n});\r\n\r\n// $.ui.fancytree was created by the widget factory. Create a local shortcut:\r\nFT = $.ui.fancytree;\r\n\r\n/**\r\n * Static members in the `$.ui.fancytree` namespace.<br>\r\n * <br>\r\n * <pre class=\"sh_javascript sunlight-highlight-javascript\">// Access static members:\r\n * var node = $.ui.fancytree.getNode(element);\r\n * alert($.ui.fancytree.version);\r\n * </pre>\r\n *\r\n * @mixin Fancytree_Static\r\n */\r\n$.extend($.ui.fancytree,\r\n\t/** @lends Fancytree_Static# */\r\n\t{\r\n\t/** @type {string} */\r\n\tversion: \"2.27.0\",      // Set to semver by 'grunt release'\r\n\t/** @type {string} */\r\n\tbuildType: \"production\", // Set to 'production' by 'grunt build'\r\n\t/** @type {int} */\r\n\tdebugLevel: 1,            // Set to 1 by 'grunt build'\r\n\t\t\t\t\t\t\t  // Used by $.ui.fancytree.debug() and as default for tree.options.debugLevel\r\n\r\n\t_nextId: 1,\r\n\t_nextNodeKey: 1,\r\n\t_extensions: {},\r\n\t// focusTree: null,\r\n\r\n\t/** Expose class object as $.ui.fancytree._FancytreeClass */\r\n\t_FancytreeClass: Fancytree,\r\n\t/** Expose class object as $.ui.fancytree._FancytreeNodeClass */\r\n\t_FancytreeNodeClass: FancytreeNode,\r\n\t/* Feature checks to provide backwards compatibility */\r\n\tjquerySupports: {\r\n\t\t// http://jqueryui.com/upgrade-guide/1.9/#deprecated-offset-option-merged-into-my-and-at\r\n\t\tpositionMyOfs: isVersionAtLeast($.ui.version, 1, 9)\r\n\t\t},\r\n\t/** Throw an error if condition fails (debug method).\r\n\t * @param {boolean} cond\r\n\t * @param {string} msg\r\n\t */\r\n\tassert: function(cond, msg){\r\n\t\treturn _assert(cond, msg);\r\n\t},\r\n\t/** Create a new Fancytree instance on a target element.\r\n\t *\r\n\t * @param {Element | jQueryObject | string} el Target DOM element or selector\r\n\t * @param {FancytreeOptions} [opts] Fancytree options\r\n\t * @returns {Fancytree} new tree instance\r\n\t * @example\r\n\t * var tree = $.ui.fancytree.createTree(\"#tree\", {\r\n\t *     source: {url: \"my/webservice\"}\r\n\t * }); // Create tree for this matching element\r\n\t *\r\n\t * @since 2.25\r\n\t */\r\n\tcreateTree: function(el, opts){\r\n\t\tvar tree = $(el).fancytree(opts).fancytree(\"getTree\");\r\n\t\treturn tree;\r\n\t},\r\n\t/** Return a function that executes *fn* at most every *timeout* ms.\r\n\t * @param {integer} timeout\r\n\t * @param {function} fn\r\n\t * @param {boolean} [invokeAsap=false]\r\n\t * @param {any} [ctx]\r\n\t */\r\n\tdebounce: function(timeout, fn, invokeAsap, ctx) {\r\n\t\tvar timer;\r\n\t\tif(arguments.length === 3 && typeof invokeAsap !== \"boolean\") {\r\n\t\t\tctx = invokeAsap;\r\n\t\t\tinvokeAsap = false;\r\n\t\t}\r\n\t\treturn function() {\r\n\t\t\tvar args = arguments;\r\n\t\t\tctx = ctx || this;\r\n\t\t\tinvokeAsap && !timer && fn.apply(ctx, args);\r\n\t\t\tclearTimeout(timer);\r\n\t\t\ttimer = setTimeout(function() {\r\n\t\t\t\tinvokeAsap || fn.apply(ctx, args);\r\n\t\t\t\ttimer = null;\r\n\t\t\t}, timeout);\r\n\t\t};\r\n\t},\r\n\t/** Write message to console if debugLevel >= 2\r\n\t * @param {string} msg\r\n\t */\r\n\tdebug: function(msg){\r\n\t\t/*jshint expr:true */\r\n\t\t($.ui.fancytree.debugLevel >= 2) && consoleApply(\"log\", arguments);\r\n\t},\r\n\t/** Write error message to console.\r\n\t * @param {string} msg\r\n\t */\r\n\terror: function(msg){\r\n\t\tconsoleApply(\"error\", arguments);\r\n\t},\r\n\t/** Convert &lt;, &gt;, &amp;, &quot;, &#39;, &#x2F; to the equivalent entities.\r\n\t *\r\n\t * @param {string} s\r\n\t * @returns {string}\r\n\t */\r\n\tescapeHtml: function(s){\r\n\t\treturn (\"\" + s).replace(REX_HTML, function(s) {\r\n\t\t\treturn ENTITY_MAP[s];\r\n\t\t});\r\n\t},\r\n\t/** Make jQuery.position() arguments backwards compatible, i.e. if\r\n\t * jQuery UI version <= 1.8, convert\r\n\t *   { my: \"left+3 center\", at: \"left bottom\", of: $target }\r\n\t * to\r\n\t *   { my: \"left center\", at: \"left bottom\", of: $target, offset: \"3  0\" }\r\n\t *\r\n\t * See http://jqueryui.com/upgrade-guide/1.9/#deprecated-offset-option-merged-into-my-and-at\r\n\t * and http://jsfiddle.net/mar10/6xtu9a4e/\r\n\t */\r\n\tfixPositionOptions: function(opts) {\r\n\t\tif( opts.offset || (\"\" + opts.my + opts.at ).indexOf(\"%\") >= 0 ) {\r\n\t\t   $.error(\"expected new position syntax (but '%' is not supported)\");\r\n\t\t}\r\n\t\tif( ! $.ui.fancytree.jquerySupports.positionMyOfs ) {\r\n\t\t\tvar // parse 'left+3 center' into ['left+3 center', 'left', '+3', 'center', undefined]\r\n\t\t\t\tmyParts = /(\\w+)([+-]?\\d+)?\\s+(\\w+)([+-]?\\d+)?/.exec(opts.my),\r\n\t\t\t\tatParts = /(\\w+)([+-]?\\d+)?\\s+(\\w+)([+-]?\\d+)?/.exec(opts.at),\r\n\t\t\t\t// convert to numbers\r\n\t\t\t\tdx = (myParts[2] ? (+myParts[2]) : 0) + (atParts[2] ? (+atParts[2]) : 0),\r\n\t\t\t\tdy = (myParts[4] ? (+myParts[4]) : 0) + (atParts[4] ? (+atParts[4]) : 0);\r\n\r\n\t\t\topts = $.extend({}, opts, { // make a copy and overwrite\r\n\t\t\t\tmy: myParts[1] + \" \" + myParts[3],\r\n\t\t\t\tat: atParts[1] + \" \" + atParts[3]\r\n\t\t\t});\r\n\t\t\tif( dx || dy ) {\r\n\t\t\t\topts.offset = \"\" + dx + \" \" + dy;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn opts;\r\n\t},\r\n\t/** Return a {node: FancytreeNode, type: TYPE} object for a mouse event.\r\n\t *\r\n\t * @param {Event} event Mouse event, e.g. click, ...\r\n\t * @returns {object} Return a {node: FancytreeNode, type: TYPE} object\r\n\t *     TYPE: 'title' | 'prefix' | 'expander' | 'checkbox' | 'icon' | undefined\r\n\t */\r\n\tgetEventTarget: function(event){\r\n\t\tvar tcn = event && event.target ? event.target.className : \"\",\r\n\t\t\tres = {node: this.getNode(event.target), type: undefined};\r\n\t\t// We use a fast version of $(res.node).hasClass()\r\n\t\t// See http://jsperf.com/test-for-classname/2\r\n\t\tif( /\\bfancytree-title\\b/.test(tcn) ){\r\n\t\t\tres.type = \"title\";\r\n\t\t}else if( /\\bfancytree-expander\\b/.test(tcn) ){\r\n\t\t\tres.type = (res.node.hasChildren() === false ? \"prefix\" : \"expander\");\r\n\t\t// }else if( /\\bfancytree-checkbox\\b/.test(tcn) || /\\bfancytree-radio\\b/.test(tcn) ){\r\n\t\t}else if( /\\bfancytree-checkbox\\b/.test(tcn) ){\r\n\t\t\tres.type = \"checkbox\";\r\n\t\t}else if( /\\bfancytree(-custom)?-icon\\b/.test(tcn) ){\r\n\t\t\tres.type = \"icon\";\r\n\t\t}else if( /\\bfancytree-node\\b/.test(tcn) ){\r\n\t\t\t// Somewhere near the title\r\n\t\t\tres.type = \"title\";\r\n\t\t}else if( event && $(event.target).is(\"ul[role=group]\") ) {\r\n\t\t\t// #nnn: Clicking right to a node may hit the surrounding UL\r\n\t\t\tFT.info(\"Ignoring click on outer UL.\");\r\n\t\t\tres.node = null;\r\n\t\t}else if( event && event.target && $(event.target).closest(\".fancytree-title\").length ) {\r\n\t\t\t// #228: clicking an embedded element inside a title\r\n\t\t\tres.type = \"title\";\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/** Return a string describing the affected node region for a mouse event.\r\n\t *\r\n\t * @param {Event} event Mouse event, e.g. click, mousemove, ...\r\n\t * @returns {string} 'title' | 'prefix' | 'expander' | 'checkbox' | 'icon' | undefined\r\n\t */\r\n\tgetEventTargetType: function(event){\r\n\t\treturn this.getEventTarget(event).type;\r\n\t},\r\n\t/** Return a FancytreeNode instance from element, event, or jQuery object.\r\n\t *\r\n\t * @param {Element | jQueryObject | Event} el\r\n\t * @returns {FancytreeNode} matching node or null\r\n\t */\r\n\tgetNode: function(el){\r\n\t\tif(el instanceof FancytreeNode){\r\n\t\t\treturn el; // el already was a FancytreeNode\r\n\t\t}else if( el instanceof $ ){\r\n\t\t\tel = el[0]; // el was a jQuery object: use the DOM element\r\n\t\t}else if(el.originalEvent !== undefined){\r\n\t\t\tel = el.target; // el was an Event\r\n\t\t}\r\n\t\twhile( el ) {\r\n\t\t\tif(el.ftnode) {\r\n\t\t\t\treturn el.ftnode;\r\n\t\t\t}\r\n\t\t\tel = el.parentNode;\r\n\t\t}\r\n\t\treturn null;\r\n\t},\r\n\t/** Return a Fancytree instance, from element, index, event, or jQueryObject.\r\n\t *\r\n\t * @param {Element | jQueryObject | Event | integer | string} [el]\r\n\t * @returns {Fancytree} matching tree or null\r\n\t * @example\r\n\t * $.ui.fancytree.getTree();   // Get first Fancytree instance on page\r\n\t * $.ui.fancytree.getTree(1);  // Get second Fancytree instance on page\r\n\t * $.ui.fancytree.getTree(\"#tree\"); // Get tree for this matching element\r\n\t *\r\n\t * @since 2.13\r\n\t */\r\n\tgetTree: function(el){\r\n\t\tvar widget;\r\n\r\n\t\tif( el instanceof Fancytree ) {\r\n\t\t\treturn el; // el already was a Fancytree\r\n\t\t}\r\n\t\tif( el === undefined ) {\r\n\t\t\tel = 0;  // get first tree\r\n\t\t}\r\n\t\tif( typeof el === \"number\" ) {\r\n\t\t\tel = $(\".fancytree-container\").eq(el); // el was an integer: return nth instance\r\n\t\t} else if( typeof el === \"string\" ) {\r\n\t\t\tel = $(el).eq(0); // el was a selector: use first match\r\n\t\t} else if( el.selector !== undefined ) {\r\n\t\t\tel = el.eq(0); // el was a jQuery object: use the first DOM element\r\n\t\t} else if( el.originalEvent !== undefined ) {\r\n\t\t\tel = $(el.target); // el was an Event\r\n\t\t}\r\n\t\tel = el.closest(\":ui-fancytree\");\r\n\t\twidget = el.data(\"ui-fancytree\") || el.data(\"fancytree\"); // the latter is required by jQuery <= 1.8\r\n\t\treturn widget ? widget.tree : null;\r\n\t},\r\n\t/** Return an option value that has a default, but may be overridden by a\r\n\t * callback or a node instance attribute.\r\n\t *\r\n\t * Evaluation sequence:<br>\r\n\t *\r\n\t * If tree.options.<optionName> is a callback that returns something, use that.<br>\r\n\t * Else if node.<optionName> is defined, use that.<br>\r\n\t * Else if tree.options.<optionName> is a value, use that.<br>\r\n\t * Else use `defaultValue`.\r\n\t *\r\n\t * @param {string} optionName name of the option property (on node and tree)\r\n\t * @param {FancytreeNode} node passed to the callback\r\n\t * @param {object} nodeObject where to look for the local option property, e.g. `node` or `node.data`\r\n\t * @param {object} treeOption where to look for the tree option, e.g. `tree.options` or `tree.options.dnd5`\r\n\t * @param {any} [defaultValue]\r\n\t * @returns {any}\r\n\t *\r\n\t * @example\r\n\t * // Check for node.foo, tree,options.foo(), and tree.options.foo:\r\n\t * $.ui.fancytree.evalOption(\"foo\", node, node, tree.options);\r\n\t * // Check for node.data.bar, tree,options.qux.bar(), and tree.options.qux.bar:\r\n\t * $.ui.fancytree.evalOption(\"bar\", node, node.data, tree.options.qux);\r\n\t *\r\n\t * @since 2.22\r\n\t */\r\n\tevalOption: function(optionName, node, nodeObject, treeOptions, defaultValue) {\r\n\t\tvar ctx, res,\r\n\t\t\ttree = node.tree,\r\n\t\t\ttreeOpt = treeOptions[optionName],\r\n\t\t\tnodeOpt = nodeObject[optionName];\r\n\r\n\t\tif( $.isFunction(treeOpt) ) {\r\n\t\t\tctx = {\r\n\t\t\t\tnode: node, tree: tree, widget: tree.widget, options: tree.widget.options,\r\n\t\t\t\ttypeInfo: tree.types[node.type] || {}\r\n\t\t\t\t};\r\n\t\t\tres = treeOpt.call(tree, {type: optionName}, ctx);\r\n\t\t\tif( res == null ) {\r\n\t\t\t\tres = nodeOpt;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tres = (nodeOpt != null) ? nodeOpt : treeOpt;\r\n\t\t}\r\n\t\tif( res == null ) {\r\n\t\t\tres = defaultValue;  // no option set at all: return default\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\t/** Set expander, checkbox, or node icon, supporting string and object format.\r\n\t *\r\n\t * @param {Element | jQueryObject} span\r\n\t * @param {string} baseClass\r\n\t * @param {string | object} icon\r\n\t * @since 2.27\r\n\t */\r\n\tsetSpanIcon: function( span, baseClass, icon ) {\r\n\t\tvar $span = $( span );\r\n\r\n\t\tif( typeof icon === \"string\" ) {\r\n\t\t\t$span.attr( \"class\", baseClass + \" \" + icon );\r\n\t\t} else {  // support object syntax: { text: ligature, addClasse: classname }\r\n\t\t\tif( icon.text ) {\r\n\t\t\t\t$span.text( \"\" + icon.text );\r\n\t\t\t}\r\n\t\t\t$span.attr( \"class\", baseClass + \" \" + ( icon.addClass || \"\" ) );\r\n\t\t}\r\n\t},\r\n\t/** Convert a keydown or mouse event to a canonical string like 'ctrl+a',\r\n\t * 'ctrl+shift+f2', 'shift+leftdblclick'.\r\n\t *\r\n\t * This is especially handy for switch-statements in event handlers.\r\n\t *\r\n\t * @param {event}\r\n\t * @returns {string}\r\n\t *\r\n\t * @example\r\n\r\n\tswitch( $.ui.fancytree.eventToString(event) ) {\r\n\t\tcase \"-\":\r\n\t\t\ttree.nodeSetExpanded(ctx, false);\r\n\t\t\tbreak;\r\n\t\tcase \"shift+return\":\r\n\t\t\ttree.nodeSetActive(ctx, true);\r\n\t\t\tbreak;\r\n\t\tcase \"down\":\r\n\t\t\tres = node.navigate(event.which, activate, true);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\thandled = false;\r\n\t}\r\n\tif( handled ){\r\n\t\tevent.preventDefault();\r\n\t}\r\n\t */\r\n\teventToString: function(event) {\r\n\t\t// Poor-man's hotkeys. See here for a complete implementation:\r\n\t\t//   https://github.com/jeresig/jquery.hotkeys\r\n\t\tvar which = event.which,\r\n\t\t\tet = event.type,\r\n\t\t\ts = [];\r\n\r\n\t\tif( event.altKey ) { s.push(\"alt\"); }\r\n\t\tif( event.ctrlKey ) { s.push(\"ctrl\"); }\r\n\t\tif( event.metaKey ) { s.push(\"meta\"); }\r\n\t\tif( event.shiftKey ) { s.push(\"shift\"); }\r\n\r\n\t\tif( et === \"click\" || et === \"dblclick\" ) {\r\n\t\t\ts.push(MOUSE_BUTTONS[event.button] + et);\r\n\t\t} else {\r\n\t\t\tif( !IGNORE_KEYCODES[which] ) {\r\n\t\t\t\ts.push( SPECIAL_KEYCODES[which] || String.fromCharCode(which).toLowerCase() );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn s.join(\"+\");\r\n\t},\r\n\t/** Write message to console if debugLevel >= 1\r\n\t * @param {string} msg\r\n\t */\r\n\tinfo: function(msg){\r\n\t\t/*jshint expr:true */\r\n\t\t($.ui.fancytree.debugLevel >= 1) && consoleApply(\"info\", arguments);\r\n\t},\r\n\t/* @deprecated: use eventToString(event) instead.\r\n\t */\r\n\tkeyEventToString: function(event) {\r\n\t\tthis.warn(\"keyEventToString() is deprecated: use eventToString()\");\r\n\t\treturn this.eventToString(event);\r\n\t},\r\n\t/** Return a wrapped handler method, that provides `this.super`.\r\n\t *\r\n\t * @example\r\n\t\t// Implement `opts.createNode` event to add the 'draggable' attribute\r\n\t\t$.ui.fancytree.overrideMethod(ctx.options, \"createNode\", function(event, data) {\r\n\t\t\t// Default processing if any\r\n\t\t\tthis._super.apply(this, arguments);\r\n\t\t\t// Add 'draggable' attribute\r\n\t\t\tdata.node.span.draggable = true;\r\n\t\t});\r\n\t *\r\n\t * @param {object} instance\r\n\t * @param {string} methodName\r\n\t * @param {function} handler\r\n\t */\r\n\toverrideMethod: function(instance, methodName, handler){\r\n\t\tvar prevSuper,\r\n\t\t\t_super = instance[methodName] || $.noop;\r\n\r\n\t\t// context = context || this;\r\n\r\n\t\tinstance[methodName] = function() {\r\n\t\t\ttry {\r\n\t\t\t\tprevSuper = this._super;\r\n\t\t\t\tthis._super = _super;\r\n\t\t\t\treturn handler.apply(this, arguments);\r\n\t\t\t} finally {\r\n\t\t\t\tthis._super = prevSuper;\r\n\t\t\t}\r\n\t\t};\r\n\t},\r\n\t/**\r\n\t * Parse tree data from HTML <ul> markup\r\n\t *\r\n\t * @param {jQueryObject} $ul\r\n\t * @returns {NodeData[]}\r\n\t */\r\n\tparseHtml: function($ul) {\r\n\t\t// TODO: understand this:\r\n\t\t/*jshint validthis:true */\r\n\t\tvar classes, className, extraClasses, i, iPos, l, tmp, tmp2,\r\n\t\t\t$children = $ul.find(\">li\"),\r\n\t\t\tchildren = [];\r\n\r\n\t\t$children.each(function() {\r\n\t\t\tvar allData, lowerCaseAttr,\r\n\t\t\t\t$li = $(this),\r\n\t\t\t\t$liSpan = $li.find(\">span:first\", this),\r\n\t\t\t\t$liA = $liSpan.length ? null : $li.find(\">a:first\"),\r\n\t\t\t\td = { tooltip: null, data: {} };\r\n\r\n\t\t\tif( $liSpan.length ) {\r\n\t\t\t\td.title = $liSpan.html();\r\n\r\n\t\t\t} else if( $liA && $liA.length ) {\r\n\t\t\t\t// If a <li><a> tag is specified, use it literally and extract href/target.\r\n\t\t\t\td.title = $liA.html();\r\n\t\t\t\td.data.href = $liA.attr(\"href\");\r\n\t\t\t\td.data.target = $liA.attr(\"target\");\r\n\t\t\t\td.tooltip = $liA.attr(\"title\");\r\n\r\n\t\t\t} else {\r\n\t\t\t\t// If only a <li> tag is specified, use the trimmed string up to\r\n\t\t\t\t// the next child <ul> tag.\r\n\t\t\t\td.title = $li.html();\r\n\t\t\t\tiPos = d.title.search(/<ul/i);\r\n\t\t\t\tif( iPos >= 0 ){\r\n\t\t\t\t\td.title = d.title.substring(0, iPos);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\td.title = $.trim(d.title);\r\n\r\n\t\t\t// Make sure all fields exist\r\n\t\t\tfor(i=0, l=CLASS_ATTRS.length; i<l; i++){\r\n\t\t\t\td[CLASS_ATTRS[i]] = undefined;\r\n\t\t\t}\r\n\t\t\t// Initialize to `true`, if class is set and collect extraClasses\r\n\t\t\tclasses = this.className.split(\" \");\r\n\t\t\textraClasses = [];\r\n\t\t\tfor(i=0, l=classes.length; i<l; i++){\r\n\t\t\t\tclassName = classes[i];\r\n\t\t\t\tif(CLASS_ATTR_MAP[className]){\r\n\t\t\t\t\td[className] = true;\r\n\t\t\t\t}else{\r\n\t\t\t\t\textraClasses.push(className);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\td.extraClasses = extraClasses.join(\" \");\r\n\r\n\t\t\t// Parse node options from ID, title and class attributes\r\n\t\t\ttmp = $li.attr(\"title\");\r\n\t\t\tif( tmp ){\r\n\t\t\t\td.tooltip = tmp; // overrides <a title='...'>\r\n\t\t\t}\r\n\t\t\ttmp = $li.attr(\"id\");\r\n\t\t\tif( tmp ){\r\n\t\t\t\td.key = tmp;\r\n\t\t\t}\r\n\t\t\t// Translate hideCheckbox -> checkbox:false\r\n\t\t\tif( $li.attr(\"hideCheckbox\") ){\r\n\t\t\t\td.checkbox = false;\r\n\t\t\t}\r\n\t\t\t// Add <li data-NAME='...'> as node.data.NAME\r\n\t\t\tallData = _getElementDataAsDict($li);\r\n\t\t\tif( allData && !$.isEmptyObject(allData) ) {\r\n\t\t\t\t// #507: convert data-hidecheckbox (lower case) to hideCheckbox\r\n\t\t\t\tfor( lowerCaseAttr in NODE_ATTR_LOWERCASE_MAP ) {\r\n\t\t\t\t\tif( allData.hasOwnProperty(lowerCaseAttr) ) {\r\n\t\t\t\t\t\tallData[NODE_ATTR_LOWERCASE_MAP[lowerCaseAttr]] = allData[lowerCaseAttr];\r\n\t\t\t\t\t\tdelete allData[lowerCaseAttr];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// #56: Allow to set special node.attributes from data-...\r\n\t\t\t\tfor(i=0, l=NODE_ATTRS.length; i<l; i++){\r\n\t\t\t\t\ttmp = NODE_ATTRS[i];\r\n\t\t\t\t\ttmp2 = allData[tmp];\r\n\t\t\t\t\tif( tmp2 != null ) {\r\n\t\t\t\t\t\tdelete allData[tmp];\r\n\t\t\t\t\t\td[tmp] = tmp2;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// All other data-... goes to node.data...\r\n\t\t\t\t$.extend(d.data, allData);\r\n\t\t\t}\r\n\t\t\t// Recursive reading of child nodes, if LI tag contains an UL tag\r\n\t\t\t$ul = $li.find(\">ul:first\");\r\n\t\t\tif( $ul.length ) {\r\n\t\t\t\td.children = $.ui.fancytree.parseHtml($ul);\r\n\t\t\t}else{\r\n\t\t\t\td.children = d.lazy ? undefined : null;\r\n\t\t\t}\r\n\t\t\tchildren.push(d);\r\n//            FT.debug(\"parse \", d, children);\r\n\t\t});\r\n\t\treturn children;\r\n\t},\r\n\t/** Add Fancytree extension definition to the list of globally available extensions.\r\n\t *\r\n\t * @param {object} definition\r\n\t */\r\n\tregisterExtension: function(definition){\r\n\t\t_assert(definition.name != null, \"extensions must have a `name` property.\");\r\n\t\t_assert(definition.version != null, \"extensions must have a `version` property.\");\r\n\t\t$.ui.fancytree._extensions[definition.name] = definition;\r\n\t},\r\n\t/** Inverse of escapeHtml().\r\n\t *\r\n\t * @param {string} s\r\n\t * @returns {string}\r\n\t */\r\n\tunescapeHtml: function(s){\r\n\t\tvar e = document.createElement(\"div\");\r\n\t\te.innerHTML = s;\r\n\t\treturn e.childNodes.length === 0 ? \"\" : e.childNodes[0].nodeValue;\r\n\t},\r\n\t/** Write warning message to console.\r\n\t * @param {string} msg\r\n\t */\r\n\twarn: function(msg){\r\n\t\tconsoleApply(\"warn\", arguments);\r\n\t}\r\n});\r\n\r\n// Value returned by `require('jquery.fancytree')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n// Extending Fancytree\r\n// ===================\r\n//\r\n// See also the [live demo](http://wwwendt.de/tech/fancytree/demo/sample-ext-childcounter.html) of this code.\r\n//\r\n// Every extension should have a comment header containing some information\r\n// about the author, copyright and licensing. Also a pointer to the latest\r\n// source code.\r\n// Prefix with `/*!` so the comment is not removed by the minifier.\r\n\r\n/*!\r\n * jquery.fancytree.childcounter.js\r\n *\r\n * Add a child counter bubble to tree nodes.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n// To keep the global namespace clean, we wrap everything in a closure.\r\n// The UMD wrapper pattern defines the dependencies on jQuery and the\r\n// Fancytree core module, and makes sure that we can use the `require()`\r\n// syntax with package loaders.\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n// Consider to use [strict mode](http://ejohn.org/blog/ecmascript-5-strict-mode-json-and-more/)\r\n\"use strict\";\r\n\r\n// The [coding guidelines](http://contribute.jquery.org/style-guide/js/)\r\n// require jshint compliance.\r\n// But for this sample, we want to allow unused variables for demonstration purpose.\r\n\r\n/*jshint unused:false */\r\n\r\n\r\n// Adding methods\r\n// --------------\r\n\r\n// New member functions can be added to the `Fancytree` class.\r\n// This function will be available for every tree instance:\r\n//\r\n//     var tree = $(\"#tree\").fancytree(\"getTree\");\r\n//     tree.countSelected(false);\r\n\r\n$.ui.fancytree._FancytreeClass.prototype.countSelected = function(topOnly){\r\n\tvar tree = this,\r\n\t\ttreeOptions = tree.options;\r\n\r\n\treturn tree.getSelectedNodes(topOnly).length;\r\n};\r\n\r\n\r\n// The `FancytreeNode` class can also be easily extended. This would be called\r\n// like\r\n//     node.updateCounters();\r\n//\r\n// It is also good practice to add a docstring comment.\r\n/**\r\n * [ext-childcounter] Update counter badges for `node` and its parents.\r\n * May be called in the `loadChildren` event, to update parents of lazy loaded\r\n * nodes.\r\n * @alias FancytreeNode#updateCounters\r\n * @requires jquery.fancytree.childcounters.js\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.updateCounters = function(){\r\n\tvar node = this,\r\n\t\t$badge = $(\"span.fancytree-childcounter\", node.span),\r\n\t\textOpts = node.tree.options.childcounter,\r\n\t\tcount = node.countChildren(extOpts.deep);\r\n\r\n\tnode.data.childCounter = count;\r\n\tif( (count || !extOpts.hideZeros) && (!node.isExpanded() || !extOpts.hideExpanded) ) {\r\n\t\tif( !$badge.length ) {\r\n\t\t\t$badge = $(\"<span class='fancytree-childcounter'/>\").appendTo($(\"span.fancytree-icon\", node.span));\r\n\t\t}\r\n\t\t$badge.text(count);\r\n\t} else {\r\n\t\t$badge.remove();\r\n\t}\r\n\tif( extOpts.deep && !node.isTopLevel() && !node.isRoot() ) {\r\n\t\tnode.parent.updateCounters();\r\n\t}\r\n};\r\n\r\n\r\n// Finally, we can extend the widget API and create functions that are called\r\n// like so:\r\n//\r\n//     $(\"#tree\").fancytree(\"widgetMethod1\", \"abc\");\r\n\r\n$.ui.fancytree.prototype.widgetMethod1 = function(arg1){\r\n\tvar tree = this.tree;\r\n\treturn arg1;\r\n};\r\n\r\n\r\n// Register a Fancytree extension\r\n// ------------------------------\r\n// A full blown extension, extension is available for all trees and can be\r\n// enabled like so (see also the [live demo](http://wwwendt.de/tech/fancytree/demo/sample-ext-childcounter.html)):\r\n//\r\n//    <script src=\"../src/jquery.fancytree.js\"></script>\r\n//    <script src=\"../src/jquery.fancytree.childcounter.js\"></script>\r\n//    ...\r\n//\r\n//     $(\"#tree\").fancytree({\r\n//         extensions: [\"childcounter\"],\r\n//         childcounter: {\r\n//             hideExpanded: true\r\n//         },\r\n//         ...\r\n//     });\r\n//\r\n\r\n\r\n/* 'childcounter' extension */\r\n$.ui.fancytree.registerExtension({\r\n// Every extension must be registered by a unique name.\r\n\tname: \"childcounter\",\r\n// Version information should be compliant with [semver](http://semver.org)\r\n\tversion: \"2.27.0\",\r\n\r\n// Extension specific options and their defaults.\r\n// This options will be available as `tree.options.childcounter.hideExpanded`\r\n\r\n\toptions: {\r\n\t\tdeep: true,\r\n\t\thideZeros: true,\r\n\t\thideExpanded: false\r\n\t},\r\n\r\n// Attributes other than `options` (or functions) can be defined here, and\r\n// will be added to the tree.ext.EXTNAME namespace, in this case `tree.ext.childcounter.foo`.\r\n// They can also be accessed as `this._local.foo` from within the extension\r\n// methods.\r\n\tfoo: 42,\r\n\r\n// Local functions are prefixed with an underscore '_'.\r\n// Callable as `this._local._appendCounter()`.\r\n\r\n\t_appendCounter: function(bar){\r\n\t\tvar tree = this;\r\n\t},\r\n\r\n// **Override virtual methods for this extension.**\r\n//\r\n// Fancytree implements a number of 'hook methods', prefixed by 'node...' or 'tree...'.\r\n// with a `ctx` argument (see [EventData](http://www.wwwendt.de/tech/fancytree/doc/jsdoc/global.html#EventData)\r\n// for details) and an extended calling context:<br>\r\n// `this`       : the Fancytree instance<br>\r\n// `this._local`: the namespace that contains extension attributes and private methods (same as this.ext.EXTNAME)<br>\r\n// `this._super`: the virtual function that was overridden (member of previous extension or Fancytree)\r\n//\r\n// See also the [complete list of available hook functions](http://www.wwwendt.de/tech/fancytree/doc/jsdoc/Fancytree_Hooks.html).\r\n\r\n\t/* Init */\r\n// `treeInit` is triggered when a tree is initalized. We can set up classes or\r\n// bind event handlers here...\r\n\ttreeInit: function(ctx){\r\n\t\tvar tree = this, // same as ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\textOpts = ctx.options.childcounter;\r\n// Optionally check for dependencies with other extensions\r\n\t\t/* this._requireExtension(\"glyph\", false, false); */\r\n// Call the base implementation\r\n\t\tthis._superApply(arguments);\r\n// Add a class to the tree container\r\n\t\tthis.$container.addClass(\"fancytree-ext-childcounter\");\r\n\t},\r\n\r\n// Destroy this tree instance (we only call the default implementation, so\r\n// this method could as well be omitted).\r\n\r\n\ttreeDestroy: function(ctx){\r\n\t\tthis._superApply(arguments);\r\n\t},\r\n\r\n// Overload the `renderTitle` hook, to append a counter badge\r\n\tnodeRenderTitle: function(ctx, title) {\r\n\t\tvar node = ctx.node,\r\n\t\t\textOpts = ctx.options.childcounter,\r\n\t\t\tcount = (node.data.childCounter == null) ? node.countChildren(extOpts.deep) : +node.data.childCounter;\r\n// Let the base implementation render the title\r\n// We use `_super()` instead of `_superApply()` here, since it is a little bit\r\n// more performant when called often\r\n\t\tthis._super(ctx, title);\r\n// Append a counter badge\r\n\t\tif( (count || ! extOpts.hideZeros) && (!node.isExpanded() || !extOpts.hideExpanded) ){\r\n\t\t\t$(\"span.fancytree-icon\", node.span).append($(\"<span class='fancytree-childcounter'/>\").text(count));\r\n\t\t}\r\n\t},\r\n// Overload the `setExpanded` hook, so the counters are updated\r\n\tnodeSetExpanded: function(ctx, flag, callOpts) {\r\n\t\tvar tree = ctx.tree,\r\n\t\t\tnode = ctx.node;\r\n// Let the base implementation expand/collapse the node, then redraw the title\r\n// after the animation has finished\r\n\t\treturn this._superApply(arguments).always(function(){\r\n\t\t\ttree.nodeRenderTitle(ctx);\r\n\t\t});\r\n\t}\r\n\r\n// End of extension definition\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n *\r\n * jquery.fancytree.clones.js\r\n * Support faster lookup of nodes by key and shared ref-ids.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n/*******************************************************************************\r\n * Private functions and variables\r\n */\r\nfunction _assert(cond, msg){\r\n\t// TODO: see qunit.js extractStacktrace()\r\n\tif(!cond){\r\n\t\tmsg = msg ? \": \" + msg : \"\";\r\n\t\t$.error(\"Assertion failed\" + msg);\r\n\t}\r\n}\r\n\r\n\r\n/* Return first occurrence of member from array. */\r\nfunction _removeArrayMember(arr, elem) {\r\n\t// TODO: use Array.indexOf for IE >= 9\r\n\tvar i;\r\n\tfor (i = arr.length - 1; i >= 0; i--) {\r\n\t\tif (arr[i] === elem) {\r\n\t\t\tarr.splice(i, 1);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\n\r\n// /**\r\n//  * Calculate a 32 bit FNV-1a hash\r\n//  * Found here: https://gist.github.com/vaiorabbit/5657561\r\n//  * Ref.: http://isthe.com/chongo/tech/comp/fnv/\r\n//  *\r\n//  * @param {string} str the input value\r\n//  * @param {boolean} [asString=false] set to true to return the hash value as\r\n//  *     8-digit hex string instead of an integer\r\n//  * @param {integer} [seed] optionally pass the hash of the previous chunk\r\n//  * @returns {integer | string}\r\n//  */\r\n// function hashFnv32a(str, asString, seed) {\r\n// \t/*jshint bitwise:false */\r\n// \tvar i, l,\r\n// \t\thval = (seed === undefined) ? 0x811c9dc5 : seed;\r\n\r\n// \tfor (i = 0, l = str.length; i < l; i++) {\r\n// \t\thval ^= str.charCodeAt(i);\r\n// \t\thval += (hval << 1) + (hval << 4) + (hval << 7) + (hval << 8) + (hval << 24);\r\n// \t}\r\n// \tif( asString ){\r\n// \t\t// Convert to 8 digit hex string\r\n// \t\treturn (\"0000000\" + (hval >>> 0).toString(16)).substr(-8);\r\n// \t}\r\n// \treturn hval >>> 0;\r\n// }\r\n\r\n\r\n/**\r\n * JS Implementation of MurmurHash3 (r136) (as of May 20, 2011)\r\n *\r\n * @author <a href=\"mailto:gary.court@gmail.com\">Gary Court</a>\r\n * @see http://github.com/garycourt/murmurhash-js\r\n * @author <a href=\"mailto:aappleby@gmail.com\">Austin Appleby</a>\r\n * @see http://sites.google.com/site/murmurhash/\r\n *\r\n * @param {string} key ASCII only\r\n * @param {boolean} [asString=false]\r\n * @param {number} seed Positive integer only\r\n * @return {number} 32-bit positive integer hash\r\n */\r\nfunction hashMurmur3(key, asString, seed) {\r\n\t/*jshint bitwise:false */\r\n\tvar h1b, k1,\r\n\t\tremainder = key.length & 3,\r\n\t\tbytes = key.length - remainder,\r\n\t\th1 = seed,\r\n\t\tc1 = 0xcc9e2d51,\r\n\t\tc2 = 0x1b873593,\r\n\t\ti = 0;\r\n\r\n\twhile (i < bytes) {\r\n\t\tk1 =\r\n\t\t\t((key.charCodeAt(i) & 0xff)) |\r\n\t\t\t((key.charCodeAt(++i) & 0xff) << 8) |\r\n\t\t\t((key.charCodeAt(++i) & 0xff) << 16) |\r\n\t\t\t((key.charCodeAt(++i) & 0xff) << 24);\r\n\t\t++i;\r\n\r\n\t\tk1 = ((((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16))) & 0xffffffff;\r\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\r\n\t\tk1 = ((((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16))) & 0xffffffff;\r\n\r\n\t\th1 ^= k1;\r\n\t\th1 = (h1 << 13) | (h1 >>> 19);\r\n\t\th1b = ((((h1 & 0xffff) * 5) + ((((h1 >>> 16) * 5) & 0xffff) << 16))) & 0xffffffff;\r\n\t\th1 = (((h1b & 0xffff) + 0x6b64) + ((((h1b >>> 16) + 0xe654) & 0xffff) << 16));\r\n\t}\r\n\r\n\tk1 = 0;\r\n\r\n\tswitch (remainder) {\r\n\t\t/*jshint -W086:true */\r\n\t\tcase 3: k1 ^= (key.charCodeAt(i + 2) & 0xff) << 16;\r\n\t\tcase 2: k1 ^= (key.charCodeAt(i + 1) & 0xff) << 8;\r\n\t\tcase 1: k1 ^= (key.charCodeAt(i) & 0xff);\r\n\r\n\t\tk1 = (((k1 & 0xffff) * c1) + ((((k1 >>> 16) * c1) & 0xffff) << 16)) & 0xffffffff;\r\n\t\tk1 = (k1 << 15) | (k1 >>> 17);\r\n\t\tk1 = (((k1 & 0xffff) * c2) + ((((k1 >>> 16) * c2) & 0xffff) << 16)) & 0xffffffff;\r\n\t\th1 ^= k1;\r\n\t}\r\n\r\n\th1 ^= key.length;\r\n\r\n\th1 ^= h1 >>> 16;\r\n\th1 = (((h1 & 0xffff) * 0x85ebca6b) + ((((h1 >>> 16) * 0x85ebca6b) & 0xffff) << 16)) & 0xffffffff;\r\n\th1 ^= h1 >>> 13;\r\n\th1 = ((((h1 & 0xffff) * 0xc2b2ae35) + ((((h1 >>> 16) * 0xc2b2ae35) & 0xffff) << 16))) & 0xffffffff;\r\n\th1 ^= h1 >>> 16;\r\n\r\n\tif( asString ){\r\n\t\t// Convert to 8 digit hex string\r\n\t\treturn (\"0000000\" + (h1 >>> 0).toString(16)).substr(-8);\r\n\t}\r\n\treturn h1 >>> 0;\r\n}\r\n\r\n// console.info(hashMurmur3(\"costarring\"));\r\n// console.info(hashMurmur3(\"costarring\", true));\r\n// console.info(hashMurmur3(\"liquid\"));\r\n// console.info(hashMurmur3(\"liquid\", true));\r\n\r\n\r\n/*\r\n * Return a unique key for node by calculationg the hash of the parents refKey-list\r\n */\r\nfunction calcUniqueKey(node) {\r\n\tvar key,\r\n\t\tpath = $.map(node.getParentList(false, true), function(e){ return e.refKey || e.key; });\r\n\tpath = path.join(\"/\");\r\n\tkey = \"id_\" + hashMurmur3(path, true);\r\n\t// node.debug(path + \" -> \" + key);\r\n\treturn key;\r\n}\r\n\r\n\r\n/**\r\n * [ext-clones] Return a list of clone-nodes or null.\r\n * @param {boolean} [includeSelf=false]\r\n * @returns {FancytreeNode[] | null}\r\n *\r\n * @alias FancytreeNode#getCloneList\r\n * @requires jquery.fancytree.clones.js\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.getCloneList = function(includeSelf){\r\n\tvar key,\r\n\t\ttree = this.tree,\r\n\t\trefList = tree.refMap[this.refKey] || null,\r\n\t\tkeyMap = tree.keyMap;\r\n\r\n\tif( refList ) {\r\n\t\tkey = this.key;\r\n\t\t// Convert key list to node list\r\n\t\tif( includeSelf ) {\r\n\t\t\trefList = $.map(refList, function(val){ return keyMap[val]; });\r\n\t\t} else {\r\n\t\t\trefList = $.map(refList, function(val){ return val === key ? null : keyMap[val]; });\r\n\t\t\tif( refList.length < 1 ) {\r\n\t\t\t\trefList = null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn refList;\r\n};\r\n\r\n\r\n/**\r\n * [ext-clones] Return true if this node has at least another clone with same refKey.\r\n * @returns {boolean}\r\n *\r\n * @alias FancytreeNode#isClone\r\n * @requires jquery.fancytree.clones.js\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.isClone = function(){\r\n\tvar refKey = this.refKey || null,\r\n\t\trefList = refKey && this.tree.refMap[refKey] || null;\r\n\treturn !!(refList && refList.length > 1);\r\n};\r\n\r\n\r\n/**\r\n * [ext-clones] Update key and/or refKey for an existing node.\r\n * @param {string} key\r\n * @param {string} refKey\r\n * @returns {boolean}\r\n *\r\n * @alias FancytreeNode#reRegister\r\n * @requires jquery.fancytree.clones.js\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.reRegister = function(key, refKey){\r\n\tkey = (key == null) ? null :  \"\" + key;\r\n\trefKey = (refKey == null) ? null :  \"\" + refKey;\r\n\t// this.debug(\"reRegister\", key, refKey);\r\n\r\n\tvar tree = this.tree,\r\n\t\tprevKey = this.key,\r\n\t\tprevRefKey = this.refKey,\r\n\t\tkeyMap = tree.keyMap,\r\n\t\trefMap = tree.refMap,\r\n\t\trefList = refMap[prevRefKey] || null,\r\n//\t\tcurCloneKeys = refList ? node.getCloneList(true),\r\n\t\tmodified = false;\r\n\r\n\t// Key has changed: update all references\r\n\tif( key != null && key !== this.key ) {\r\n\t\tif( keyMap[key] ) {\r\n\t\t\t$.error(\"[ext-clones] reRegister(\" + key + \"): already exists: \" + this);\r\n\t\t}\r\n\t\t// Update keyMap\r\n\t\tdelete keyMap[prevKey];\r\n\t\tkeyMap[key] = this;\r\n\t\t// Update refMap\r\n\t\tif( refList ) {\r\n\t\t\trefMap[prevRefKey] = $.map(refList, function(e){\r\n\t\t\t\treturn e === prevKey ? key : e;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis.key = key;\r\n\t\tmodified = true;\r\n\t}\r\n\r\n\t// refKey has changed\r\n\tif( refKey != null && refKey !== this.refKey ) {\r\n\t\t// Remove previous refKeys\r\n\t\tif( refList ){\r\n\t\t\tif( refList.length === 1 ){\r\n\t\t\t\tdelete refMap[prevRefKey];\r\n\t\t\t}else{\r\n\t\t\t\trefMap[prevRefKey] = $.map(refList, function(e){\r\n\t\t\t\t\treturn e === prevKey ? null : e;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Add refKey\r\n\t\tif( refMap[refKey] ) {\r\n\t\t\trefMap[refKey].append(key);\r\n\t\t}else{\r\n\t\t\trefMap[refKey] = [ this.key ];\r\n\t\t}\r\n\t\tthis.refKey = refKey;\r\n\t\tmodified = true;\r\n\t}\r\n\treturn modified;\r\n};\r\n\r\n\r\n/**\r\n * [ext-clones] Define a refKey for an existing node.\r\n * @param {string} refKey\r\n * @returns {boolean}\r\n *\r\n * @alias FancytreeNode#setRefKey\r\n * @requires jquery.fancytree.clones.js\r\n * @since 2.16\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.setRefKey = function(refKey){\r\n\treturn this.reRegister(null, refKey);\r\n};\r\n\r\n\r\n/**\r\n * [ext-clones] Return all nodes with a given refKey (null if not found).\r\n * @param {string} refKey\r\n * @param {FancytreeNode} [rootNode] optionally restrict results to descendants of this node\r\n * @returns {FancytreeNode[] | null}\r\n * @alias Fancytree#getNodesByRef\r\n * @requires jquery.fancytree.clones.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.getNodesByRef = function(refKey, rootNode){\r\n\tvar keyMap = this.keyMap,\r\n\t\trefList = this.refMap[refKey] || null;\r\n\r\n\tif( refList ) {\r\n\t\t// Convert key list to node list\r\n\t\tif( rootNode ) {\r\n\t\t\trefList = $.map(refList, function(val){\r\n\t\t\t\tvar node = keyMap[val];\r\n\t\t\t\treturn node.isDescendantOf(rootNode) ? node : null;\r\n\t\t\t});\r\n\t\t}else{\r\n\t\t\trefList = $.map(refList, function(val){ return keyMap[val]; });\r\n\t\t}\r\n\t\tif( refList.length < 1 ) {\r\n\t\t\trefList = null;\r\n\t\t}\r\n\t}\r\n\treturn refList;\r\n};\r\n\r\n\r\n/**\r\n * [ext-clones] Replace a refKey with a new one.\r\n * @param {string} oldRefKey\r\n * @param {string} newRefKey\r\n * @alias Fancytree#changeRefKey\r\n * @requires jquery.fancytree.clones.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.changeRefKey = function(oldRefKey, newRefKey) {\r\n\tvar i, node,\r\n\t\tkeyMap = this.keyMap,\r\n\t\trefList = this.refMap[oldRefKey] || null;\r\n\r\n\tif (refList) {\r\n\t\tfor (i = 0; i < refList.length; i++) {\r\n\t\t\tnode = keyMap[refList[i]];\r\n\t\t\tnode.refKey = newRefKey;\r\n\t\t}\r\n\t\tdelete this.refMap[oldRefKey];\r\n\t\tthis.refMap[newRefKey] = refList;\r\n\t}\r\n};\r\n\r\n\r\n/*******************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"clones\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\thighlightActiveClones: true, // set 'fancytree-active-clone' on active clones and all peers\r\n\t\thighlightClones: false       // set 'fancytree-clone' class on any node that has at least one clone\r\n\t},\r\n\r\n\ttreeCreate: function(ctx){\r\n\t\tthis._superApply(arguments);\r\n\t\tctx.tree.refMap = {};\r\n\t\tctx.tree.keyMap = {};\r\n\t},\r\n\ttreeInit: function(ctx){\r\n\t\tthis.$container.addClass(\"fancytree-ext-clones\");\r\n\t\t_assert(ctx.options.defaultKey == null);\r\n\t\t// Generate unique / reproducible default keys\r\n\t\tctx.options.defaultKey = function(node){\r\n\t\t\treturn calcUniqueKey(node);\r\n\t\t};\r\n\t\t// The default implementation loads initial data\r\n\t\tthis._superApply(arguments);\r\n\t},\r\n\ttreeClear: function(ctx){\r\n\t\tctx.tree.refMap = {};\r\n\t\tctx.tree.keyMap = {};\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\ttreeRegisterNode: function(ctx, add, node) {\r\n\t\tvar refList, len,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\tkeyMap = tree.keyMap,\r\n\t\t\trefMap = tree.refMap,\r\n\t\t\tkey = node.key,\r\n\t\t\trefKey = (node && node.refKey != null) ? \"\" + node.refKey : null;\r\n\r\n//\t\tctx.tree.debug(\"clones.treeRegisterNode\", add, node);\r\n\r\n\t\tif( node.isStatusNode() ){\r\n\t\t\treturn this._super(ctx, add, node);\r\n\t\t}\r\n\r\n\t\tif( add ) {\r\n\t\t\tif( keyMap[node.key] != null ) {\r\n\t\t\t\t$.error(\"clones.treeRegisterNode: node.key already exists: \" + node);\r\n\t\t\t}\r\n\t\t\tkeyMap[key] = node;\r\n\t\t\tif( refKey ) {\r\n\t\t\t\trefList = refMap[refKey];\r\n\t\t\t\tif( refList ) {\r\n\t\t\t\t\trefList.push(key);\r\n\t\t\t\t\tif( refList.length === 2 && ctx.options.clones.highlightClones ) {\r\n\t\t\t\t\t\t// Mark peer node, if it just became a clone (no need to\r\n\t\t\t\t\t\t// mark current node, since it will be rendered later anyway)\r\n\t\t\t\t\t\tkeyMap[refList[0]].renderStatus();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\trefMap[refKey] = [key];\r\n\t\t\t\t}\r\n\t\t\t\t// node.debug(\"clones.treeRegisterNode: add clone =>\", refMap[refKey]);\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tif( keyMap[key] == null ) {\r\n\t\t\t\t$.error(\"clones.treeRegisterNode: node.key not registered: \" + node.key);\r\n\t\t\t}\r\n\t\t\tdelete keyMap[key];\r\n\t\t\tif( refKey ) {\r\n\t\t\t\trefList = refMap[refKey];\r\n\t\t\t\t// node.debug(\"clones.treeRegisterNode: remove clone BEFORE =>\", refMap[refKey]);\r\n\t\t\t\tif( refList ) {\r\n\t\t\t\t\tlen = refList.length;\r\n\t\t\t\t\tif( len <= 1 ){\r\n\t\t\t\t\t\t_assert(len === 1);\r\n\t\t\t\t\t\t_assert(refList[0] === key);\r\n\t\t\t\t\t\tdelete refMap[refKey];\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\t_removeArrayMember(refList, key);\r\n\t\t\t\t\t\t// Unmark peer node, if this was the only clone\r\n\t\t\t\t\t\tif( len === 2 && ctx.options.clones.highlightClones ) {\r\n//\t\t\t\t\t\t\tnode.debug(\"clones.treeRegisterNode: last =>\", node.getCloneList());\r\n\t\t\t\t\t\t\tkeyMap[refList[0]].renderStatus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// node.debug(\"clones.treeRegisterNode: remove clone =>\", refMap[refKey]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._super(ctx, add, node);\r\n\t},\r\n\tnodeRenderStatus: function(ctx) {\r\n\t\tvar $span, res,\r\n\t\t\tnode = ctx.node;\r\n\r\n\t\tres = this._super(ctx);\r\n\r\n\t\tif( ctx.options.clones.highlightClones ) {\r\n\t\t\t$span = $(node[ctx.tree.statusClassPropName]);\r\n\t\t\t// Only if span already exists\r\n\t\t\tif( $span.length && node.isClone() ){\r\n//\t\t\t\tnode.debug(\"clones.nodeRenderStatus: \", ctx.options.clones.highlightClones);\r\n\t\t\t\t$span.addClass(\"fancytree-clone\");\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnodeSetActive: function(ctx, flag, callOpts) {\r\n\t\tvar res,\r\n\t\t\tscpn = ctx.tree.statusClassPropName,\r\n\t\t\tnode = ctx.node;\r\n\r\n\t\tres = this._superApply(arguments);\r\n\r\n\t\tif( ctx.options.clones.highlightActiveClones && node.isClone() ) {\r\n\t\t\t$.each(node.getCloneList(true), function(idx, n){\r\n\t\t\t\t// n.debug(\"clones.nodeSetActive: \", flag !== false);\r\n\t\t\t\t$(n[scpn]).toggleClass(\"fancytree-active-clone\", flag !== false);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.dnd.js\r\n *\r\n * Drag-and-drop support (jQuery UI draggable/droppable).\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [\r\n\t\t\t\"jquery\",\r\n\t\t\t\"jquery-ui/ui/widgets/draggable\",\r\n\t\t\t\"jquery-ui/ui/widgets/droppable\",\r\n\t\t\t\"./jquery.fancytree\"\r\n\t\t], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n/* *****************************************************************************\r\n * Private functions and variables\r\n */\r\nvar didRegisterDnd = false,\r\n\tclassDropAccept = \"fancytree-drop-accept\",\r\n\tclassDropAfter = \"fancytree-drop-after\",\r\n\tclassDropBefore = \"fancytree-drop-before\",\r\n\tclassDropOver = \"fancytree-drop-over\",\r\n\tclassDropReject = \"fancytree-drop-reject\",\r\n\tclassDropTarget = \"fancytree-drop-target\";\r\n\r\n/* Convert number to string and prepend +/-; return empty string for 0.*/\r\nfunction offsetString(n){\r\n\treturn n === 0 ? \"\" : (( n > 0 ) ? (\"+\" + n) : (\"\" + n));\r\n}\r\n\r\n//--- Extend ui.draggable event handling --------------------------------------\r\n\r\nfunction _registerDnd() {\r\n\tif(didRegisterDnd){\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Register proxy-functions for draggable.start/drag/stop\r\n\r\n\t$.ui.plugin.add(\"draggable\", \"connectToFancytree\", {\r\n\t\tstart: function(event, ui) {\r\n\t\t\t// 'draggable' was renamed to 'ui-draggable' since jQueryUI 1.10\r\n\t\t\tvar draggable = $(this).data(\"ui-draggable\") || $(this).data(\"draggable\"),\r\n\t\t\t\tsourceNode = ui.helper.data(\"ftSourceNode\") || null;\r\n\r\n\t\t\tif(sourceNode) {\r\n\t\t\t\t// Adjust helper offset, so cursor is slightly outside top/left corner\r\n\t\t\t\tdraggable.offset.click.top = -2;\r\n\t\t\t\tdraggable.offset.click.left = + 16;\r\n\t\t\t\t// Trigger dragStart event\r\n\t\t\t\t// TODO: when called as connectTo..., the return value is ignored(?)\r\n\t\t\t\treturn sourceNode.tree.ext.dnd._onDragEvent(\"start\", sourceNode, null, event, ui, draggable);\r\n\t\t\t}\r\n\t\t},\r\n\t\tdrag: function(event, ui) {\r\n\t\t\tvar ctx, isHelper, logObject,\r\n\t\t\t\t// 'draggable' was renamed to 'ui-draggable' since jQueryUI 1.10\r\n\t\t\t\tdraggable = $(this).data(\"ui-draggable\") || $(this).data(\"draggable\"),\r\n\t\t\t\tsourceNode = ui.helper.data(\"ftSourceNode\") || null,\r\n\t\t\t\tprevTargetNode = ui.helper.data(\"ftTargetNode\") || null,\r\n\t\t\t\ttargetNode = $.ui.fancytree.getNode(event.target),\r\n\t\t\t\tdndOpts = sourceNode && sourceNode.tree.options.dnd;\r\n\r\n\t\t\t// logObject = sourceNode || prevTargetNode || $.ui.fancytree;\r\n\t\t\t// logObject.debug(\"Drag event:\", event, event.shiftKey);\r\n\t\t\tif(event.target && !targetNode){\r\n\t\t\t\t// We got a drag event, but the targetNode could not be found\r\n\t\t\t\t// at the event location. This may happen,\r\n\t\t\t\t// 1. if the mouse jumped over the drag helper,\r\n\t\t\t\t// 2. or if a non-fancytree element is dragged\r\n\t\t\t\t// We ignore it:\r\n\t\t\t\tisHelper = $(event.target).closest(\"div.fancytree-drag-helper,#fancytree-drop-marker\").length > 0;\r\n\t\t\t\tif(isHelper){\r\n\t\t\t\t\tlogObject = sourceNode || prevTargetNode || $.ui.fancytree;\r\n\t\t\t\t\tlogObject.debug(\"Drag event over helper: ignored.\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tui.helper.data(\"ftTargetNode\", targetNode);\r\n\r\n\t\t\tif( dndOpts && dndOpts.updateHelper ) {\r\n\t\t\t\tctx = sourceNode.tree._makeHookContext(sourceNode, event, {\r\n\t\t\t\t\totherNode: targetNode,\r\n\t\t\t\t\tui: ui,\r\n\t\t\t\t\tdraggable: draggable,\r\n\t\t\t\t\tdropMarker: $(\"#fancytree-drop-marker\")\r\n\t\t\t\t});\r\n\t\t\t\tdndOpts.updateHelper.call(sourceNode.tree, sourceNode, ctx);\r\n\t\t\t}\r\n\r\n\t\t\t// Leaving a tree node\r\n\t\t\tif(prevTargetNode && prevTargetNode !== targetNode ) {\r\n\t\t\t\tprevTargetNode.tree.ext.dnd._onDragEvent(\"leave\", prevTargetNode, sourceNode, event, ui, draggable);\r\n\t\t\t}\r\n\t\t\tif(targetNode){\r\n\t\t\t\tif(!targetNode.tree.options.dnd.dragDrop) {\r\n\t\t\t\t\t// not enabled as drop target\r\n\t\t\t\t} else if(targetNode === prevTargetNode) {\r\n\t\t\t\t\t// Moving over same node\r\n\t\t\t\t\ttargetNode.tree.ext.dnd._onDragEvent(\"over\", targetNode, sourceNode, event, ui, draggable);\r\n\t\t\t\t}else{\r\n\t\t\t\t\t// Entering this node first time\r\n\t\t\t\t\ttargetNode.tree.ext.dnd._onDragEvent(\"enter\", targetNode, sourceNode, event, ui, draggable);\r\n\t\t\t\t\ttargetNode.tree.ext.dnd._onDragEvent(\"over\", targetNode, sourceNode, event, ui, draggable);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t// else go ahead with standard event handling\r\n\t\t},\r\n\t\tstop: function(event, ui) {\r\n\t\t\tvar logObject,\r\n\t\t\t\t// 'draggable' was renamed to 'ui-draggable' since jQueryUI 1.10:\r\n\t\t\t\tdraggable = $(this).data(\"ui-draggable\") || $(this).data(\"draggable\"),\r\n\t\t\t\tsourceNode = ui.helper.data(\"ftSourceNode\") || null,\r\n\t\t\t\ttargetNode = ui.helper.data(\"ftTargetNode\") || null,\r\n\t\t\t\tdropped = (event.type === \"mouseup\" && event.which === 1);\r\n\r\n\t\t\tif(!dropped){\r\n\t\t\t\tlogObject = sourceNode || targetNode || $.ui.fancytree;\r\n\t\t\t\tlogObject.debug(\"Drag was cancelled\");\r\n\t\t\t}\r\n\t\t\tif(targetNode) {\r\n\t\t\t\tif(dropped){\r\n\t\t\t\t\ttargetNode.tree.ext.dnd._onDragEvent(\"drop\", targetNode, sourceNode, event, ui, draggable);\r\n\t\t\t\t}\r\n\t\t\t\ttargetNode.tree.ext.dnd._onDragEvent(\"leave\", targetNode, sourceNode, event, ui, draggable);\r\n\t\t\t}\r\n\t\t\tif(sourceNode){\r\n\t\t\t\tsourceNode.tree.ext.dnd._onDragEvent(\"stop\", sourceNode, null, event, ui, draggable);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tdidRegisterDnd = true;\r\n}\r\n\r\n\r\n/* *****************************************************************************\r\n * Drag and drop support\r\n */\r\nfunction _initDragAndDrop(tree) {\r\n\tvar dnd = tree.options.dnd || null,\r\n\t\tglyph = tree.options.glyph || null;\r\n\r\n\t// Register 'connectToFancytree' option with ui.draggable\r\n\tif( dnd ) {\r\n\t\t_registerDnd();\r\n\t}\r\n\t// Attach ui.draggable to this Fancytree instance\r\n\tif(dnd && dnd.dragStart ) {\r\n\t\ttree.widget.element.draggable($.extend({\r\n\t\t\taddClasses: false,\r\n\t\t\t// DT issue 244: helper should be child of scrollParent:\r\n\t\t\tappendTo: tree.$container,\r\n//\t\t\tappendTo: \"body\",\r\n\t\t\tcontainment: false,\r\n//\t\t\tcontainment: \"parent\",\r\n\t\t\tdelay: 0,\r\n\t\t\tdistance: 4,\r\n\t\t\trevert: false,\r\n\t\t\tscroll: true, // to disable, also set css 'position: inherit' on ul.fancytree-container\r\n\t\t\tscrollSpeed: 7,\r\n\t\t\tscrollSensitivity: 10,\r\n\t\t\t// Delegate draggable.start, drag, and stop events to our handler\r\n\t\t\tconnectToFancytree: true,\r\n\t\t\t// Let source tree create the helper element\r\n\t\t\thelper: function(event) {\r\n\t\t\t\tvar $helper, $nodeTag, opts,\r\n\t\t\t\t\tsourceNode = $.ui.fancytree.getNode(event.target);\r\n\r\n\t\t\t\tif(!sourceNode){\r\n\t\t\t\t\t// #405, DT issue 211: might happen, if dragging a table *header*\r\n\t\t\t\t\treturn \"<div>ERROR?: helper requested but sourceNode not found</div>\";\r\n\t\t\t\t}\r\n\t\t\t\topts = sourceNode.tree.options.dnd;\r\n\t\t\t\t$nodeTag = $(sourceNode.span);\r\n\t\t\t\t// Only event and node argument is available\r\n\t\t\t\t$helper = $(\"<div class='fancytree-drag-helper'><span class='fancytree-drag-helper-img' /></div>\")\r\n\t\t\t\t\t.css({zIndex: 3, position: \"relative\"}) // so it appears above ext-wide selection bar\r\n\t\t\t\t\t.append($nodeTag.find(\"span.fancytree-title\").clone());\r\n\r\n\t\t\t\t// Attach node reference to helper object\r\n\t\t\t\t$helper.data(\"ftSourceNode\", sourceNode);\r\n\r\n\t\t\t\t// Support glyph symbols instead of icons\r\n\t\t\t\tif( glyph ) {\r\n\t\t\t\t\t$helper.find(\".fancytree-drag-helper-img\")\r\n\t\t\t\t\t\t.addClass(glyph.map._addClass + \" \" + glyph.map.dragHelper);\r\n\t\t\t\t}\r\n\t\t\t\t// Allow to modify the helper, e.g. to add multi-node-drag feedback\r\n\t\t\t\tif( opts.initHelper ) {\r\n\t\t\t\t\topts.initHelper.call(sourceNode.tree, sourceNode, {\r\n\t\t\t\t\t\tnode: sourceNode,\r\n\t\t\t\t\t\ttree: sourceNode.tree,\r\n\t\t\t\t\t\toriginalEvent: event,\r\n\t\t\t\t\t\tui: { helper: $helper }\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// We return an unconnected element, so `draggable` will add this\r\n\t\t\t\t// to the parent specified as `appendTo` option\r\n\t\t\t\treturn $helper;\r\n\t\t\t},\r\n\t\t\tstart: function(event, ui) {\r\n\t\t\t\tvar sourceNode = ui.helper.data(\"ftSourceNode\");\r\n\t\t\t\treturn !!sourceNode; // Abort dragging if no node could be found\r\n\t\t\t}\r\n\t\t}, tree.options.dnd.draggable));\r\n\t}\r\n\t// Attach ui.droppable to this Fancytree instance\r\n\tif(dnd && dnd.dragDrop) {\r\n\t\ttree.widget.element.droppable($.extend({\r\n\t\t\taddClasses: false,\r\n\t\t\ttolerance: \"intersect\",\r\n\t\t\tgreedy: false\r\n/*\r\n\t\t\tactivate: function(event, ui) {\r\n\t\t\t\ttree.debug(\"droppable - activate\", event, ui, this);\r\n\t\t\t},\r\n\t\t\tcreate: function(event, ui) {\r\n\t\t\t\ttree.debug(\"droppable - create\", event, ui);\r\n\t\t\t},\r\n\t\t\tdeactivate: function(event, ui) {\r\n\t\t\t\ttree.debug(\"droppable - deactivate\", event, ui);\r\n\t\t\t},\r\n\t\t\tdrop: function(event, ui) {\r\n\t\t\t\ttree.debug(\"droppable - drop\", event, ui);\r\n\t\t\t},\r\n\t\t\tout: function(event, ui) {\r\n\t\t\t\ttree.debug(\"droppable - out\", event, ui);\r\n\t\t\t},\r\n\t\t\tover: function(event, ui) {\r\n\t\t\t\ttree.debug(\"droppable - over\", event, ui);\r\n\t\t\t}\r\n*/\r\n\t\t}, tree.options.dnd.droppable));\r\n\t}\r\n}\r\n\r\n\r\n/* *****************************************************************************\r\n *\r\n */\r\n\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"dnd\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\t// Make tree nodes accept draggables\r\n\t\tautoExpandMS: 1000,  // Expand nodes after n milliseconds of hovering.\r\n\t\tdraggable: null,     // Additional options passed to jQuery draggable\r\n\t\tdroppable: null,     // Additional options passed to jQuery droppable\r\n\t\tfocusOnClick: false, // Focus, although draggable cancels mousedown event (#270)\r\n\t\tpreventVoidMoves: true, \t// Prevent dropping nodes 'before self', etc.\r\n\t\tpreventRecursiveMoves: true,// Prevent dropping nodes on own descendants\r\n\t\tsmartRevert: true,   // set draggable.revert = true if drop was rejected\r\n\t\tdropMarkerOffsetX: -24,\t\t\t// absolute position offset for .fancytree-drop-marker relatively to ..fancytree-title (icon/img near a node accepting drop)\r\n\t\tdropMarkerInsertOffsetX: -16,\t// additional offset for drop-marker with hitMode = \"before\"/\"after\"\r\n\t\t// Events (drag support)\r\n\t\tdragStart: null,     // Callback(sourceNode, data), return true, to enable dnd\r\n\t\tdragStop: null,      // Callback(sourceNode, data)\r\n\t\tinitHelper: null,    // Callback(sourceNode, data)\r\n\t\tupdateHelper: null,  // Callback(sourceNode, data)\r\n\t\t// Events (drop support)\r\n\t\tdragEnter: null,     // Callback(targetNode, data)\r\n\t\tdragOver: null,      // Callback(targetNode, data)\r\n\t\tdragExpand: null,    // Callback(targetNode, data), return false to prevent autoExpand\r\n\t\tdragDrop: null,      // Callback(targetNode, data)\r\n\t\tdragLeave: null      // Callback(targetNode, data)\r\n\t},\r\n\r\n\ttreeInit: function(ctx){\r\n\t\tvar tree = ctx.tree;\r\n\t\tthis._superApply(arguments);\r\n\t\t// issue #270: draggable eats mousedown events\r\n\t\tif( tree.options.dnd.dragStart ){\r\n\t\t\ttree.$container.on(\"mousedown\", function(event){\r\n//\t\t\t\tif( !tree.hasFocus() && ctx.options.dnd.focusOnClick ) {\r\n\t\t\t\tif( ctx.options.dnd.focusOnClick ) {  // #270\r\n\t\t\t\t\tvar node = $.ui.fancytree.getNode(event);\r\n\t\t\t\t\tif (node){\r\n\t\t\t\t\t\tnode.debug(\"Re-enable focus that was prevented by jQuery UI draggable.\");\r\n\t\t\t\t\t\t// node.setFocus();\r\n\t\t\t\t\t\t// $(node.span).closest(\":tabbable\").focus();\r\n\t\t\t\t\t\t// $(event.target).trigger(\"focus\");\r\n\t\t\t\t\t\t// $(event.target).closest(\":tabbable\").trigger(\"focus\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsetTimeout(function() { // #300\r\n\t\t\t\t\t\t$(event.target).closest(\":tabbable\").focus();\r\n\t\t\t\t\t}, 10);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t_initDragAndDrop(tree);\r\n\t},\r\n\t/* Display drop marker according to hitMode ('after', 'before', 'over'). */\r\n\t_setDndStatus: function(sourceNode, targetNode, helper, hitMode, accept) {\r\n\t\tvar markerOffsetX,\r\n\t\t\tmarkerAt = \"center\",\r\n\t\t\tinstData = this._local,\r\n\t\t\tdndOpt = this.options.dnd ,\r\n\t\t\tglyphOpt = this.options.glyph,\r\n\t\t\t$source = sourceNode ? $(sourceNode.span) : null,\r\n\t\t\t$target = $(targetNode.span),\r\n\t\t\t$targetTitle = $target.find(\"span.fancytree-title\");\r\n\r\n\t\tif( !instData.$dropMarker ) {\r\n\t\t\tinstData.$dropMarker = $(\"<div id='fancytree-drop-marker'></div>\")\r\n\t\t\t\t.hide()\r\n\t\t\t\t.css({\"z-index\": 1000})\r\n\t\t\t\t.prependTo($(this.$div).parent());\r\n//                .prependTo(\"body\");\r\n\r\n\t\t\tif( glyphOpt ) {\r\n\t\t\t\tinstData.$dropMarker\r\n\t\t\t\t\t.addClass(glyphOpt.map._addClass + \" \" + glyphOpt.map.dropMarker);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( hitMode === \"after\" || hitMode === \"before\" || hitMode === \"over\" ){\r\n\t\t\tmarkerOffsetX = dndOpt.dropMarkerOffsetX || 0;\r\n\t\t\tswitch(hitMode){\r\n\t\t\tcase \"before\":\r\n\t\t\t\tmarkerAt = \"top\";\r\n\t\t\t\tmarkerOffsetX += (dndOpt.dropMarkerInsertOffsetX || 0);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"after\":\r\n\t\t\t\tmarkerAt = \"bottom\";\r\n\t\t\t\tmarkerOffsetX += (dndOpt.dropMarkerInsertOffsetX || 0);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\tinstData.$dropMarker\r\n\t\t\t\t.toggleClass(classDropAfter, hitMode === \"after\")\r\n\t\t\t\t.toggleClass(classDropOver, hitMode === \"over\")\r\n\t\t\t\t.toggleClass(classDropBefore, hitMode === \"before\")\r\n\t\t\t\t.show()\r\n\t\t\t\t.position($.ui.fancytree.fixPositionOptions({\r\n\t\t\t\t\tmy: \"left\" + offsetString(markerOffsetX) + \" center\",\r\n\t\t\t\t\tat: \"left \" + markerAt,\r\n\t\t\t\t\tof: $targetTitle\r\n\t\t\t\t\t}));\r\n\t\t} else {\r\n\t\t\tinstData.$dropMarker.hide();\r\n\t\t}\r\n\t\tif( $source ){\r\n\t\t\t$source\r\n\t\t\t\t.toggleClass(classDropAccept, accept === true)\r\n\t\t\t\t.toggleClass(classDropReject, accept === false);\r\n\t\t}\r\n\t\t$target\r\n\t\t\t.toggleClass(classDropTarget, hitMode === \"after\" || hitMode === \"before\" || hitMode === \"over\")\r\n\t\t\t.toggleClass(classDropAfter, hitMode === \"after\")\r\n\t\t\t.toggleClass(classDropBefore, hitMode === \"before\")\r\n\t\t\t.toggleClass(classDropAccept, accept === true)\r\n\t\t\t.toggleClass(classDropReject, accept === false);\r\n\r\n\t\thelper\r\n\t\t\t.toggleClass(classDropAccept, accept === true)\r\n\t\t\t.toggleClass(classDropReject, accept === false);\r\n\t},\r\n\r\n\t/*\r\n\t * Handles drag'n'drop functionality.\r\n\t *\r\n\t * A standard jQuery drag-and-drop process may generate these calls:\r\n\t *\r\n\t * start:\r\n\t *     _onDragEvent(\"start\", sourceNode, null, event, ui, draggable);\r\n\t * drag:\r\n\t *     _onDragEvent(\"leave\", prevTargetNode, sourceNode, event, ui, draggable);\r\n\t *     _onDragEvent(\"over\", targetNode, sourceNode, event, ui, draggable);\r\n\t *     _onDragEvent(\"enter\", targetNode, sourceNode, event, ui, draggable);\r\n\t * stop:\r\n\t *     _onDragEvent(\"drop\", targetNode, sourceNode, event, ui, draggable);\r\n\t *     _onDragEvent(\"leave\", targetNode, sourceNode, event, ui, draggable);\r\n\t *     _onDragEvent(\"stop\", sourceNode, null, event, ui, draggable);\r\n\t */\r\n\t_onDragEvent: function(eventName, node, otherNode, event, ui, draggable) {\r\n\t\t// if(eventName !== \"over\"){\r\n\t\t// \tthis.debug(\"tree.ext.dnd._onDragEvent(%s, %o, %o) - %o\", eventName, node, otherNode, this);\r\n\t\t// }\r\n\t\tvar accept, nodeOfs, parentRect, rect, relPos, relPos2,\r\n\t\t\tenterResponse, hitMode, r,\r\n\t\t\topts = this.options,\r\n\t\t\tdnd = opts.dnd,\r\n\t\t\tctx = this._makeHookContext(node, event, {otherNode: otherNode, ui: ui, draggable: draggable}),\r\n\t\t\tres = null,\r\n\t\t\tthat = this,\r\n\t\t\t$nodeTag = $(node.span);\r\n\r\n\t\tif( dnd.smartRevert ) {\r\n\t\t\tdraggable.options.revert = \"invalid\";\r\n\t\t}\r\n\r\n\t\tswitch (eventName) {\r\n\r\n\t\tcase \"start\":\r\n\t\t\tif( node.isStatusNode() ) {\r\n\t\t\t\tres = false;\r\n\t\t\t} else if(dnd.dragStart) {\r\n\t\t\t\tres = dnd.dragStart(node, ctx);\r\n\t\t\t}\r\n\t\t\tif(res === false) {\r\n\t\t\t\tthis.debug(\"tree.dragStart() cancelled\");\r\n\t\t\t\t//draggable._clear();\r\n\t\t\t\t// NOTE: the return value seems to be ignored (drag is not cancelled, when false is returned)\r\n\t\t\t\t// TODO: call this._cancelDrag()?\r\n\t\t\t\tui.helper.trigger(\"mouseup\")\r\n\t\t\t\t\t.hide();\r\n\t\t\t} else {\r\n\t\t\t\tif( dnd.smartRevert ) {\r\n\t\t\t\t\t// #567, #593: fix revert position\r\n\t\t\t\t\t// rect = node.li.getBoundingClientRect();\r\n\t\t\t\t\trect = node[ctx.tree.nodeContainerAttrName].getBoundingClientRect();\r\n\t\t\t\t\tparentRect = $(draggable.options.appendTo)[0].getBoundingClientRect();\r\n\t\t\t\t\tdraggable.originalPosition.left = Math.max(0, rect.left - parentRect.left);\r\n\t\t\t\t\tdraggable.originalPosition.top = Math.max(0, rect.top - parentRect.top);\r\n\t\t\t\t}\r\n\t\t\t\t$nodeTag.addClass(\"fancytree-drag-source\");\r\n\t\t\t\t// Register global handlers to allow cancel\r\n\t\t\t\t$(document)\r\n\t\t\t\t\t.on(\"keydown.fancytree-dnd,mousedown.fancytree-dnd\", function(event){\r\n\t\t\t\t\t\t// node.tree.debug(\"dnd global event\", event.type, event.which);\r\n\t\t\t\t\t\tif( event.type === \"keydown\" && event.which === $.ui.keyCode.ESCAPE ) {\r\n\t\t\t\t\t\t\tthat.ext.dnd._cancelDrag();\r\n\t\t\t\t\t\t} else if( event.type === \"mousedown\" ) {\r\n\t\t\t\t\t\t\tthat.ext.dnd._cancelDrag();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"enter\":\r\n\t\t\tif(dnd.preventRecursiveMoves && node.isDescendantOf(otherNode)){\r\n\t\t\t\tr = false;\r\n\t\t\t}else{\r\n\t\t\t\tr = dnd.dragEnter ? dnd.dragEnter(node, ctx) : null;\r\n\t\t\t}\r\n\t\t\tif(!r){\r\n\t\t\t\t// convert null, undefined, false to false\r\n\t\t\t\tres = false;\r\n\t\t\t}else if ( $.isArray(r) ) {\r\n\t\t\t\t// TODO: also accept passing an object of this format directly\r\n\t\t\t\tres = {\r\n\t\t\t\t\tover: ($.inArray(\"over\", r) >= 0),\r\n\t\t\t\t\tbefore: ($.inArray(\"before\", r) >= 0),\r\n\t\t\t\t\tafter: ($.inArray(\"after\", r) >= 0)\r\n\t\t\t\t};\r\n\t\t\t}else{\r\n\t\t\t\tres = {\r\n\t\t\t\t\tover: ((r === true) || (r === \"over\")),\r\n\t\t\t\t\tbefore: ((r === true) || (r === \"before\")),\r\n\t\t\t\t\tafter: ((r === true) || (r === \"after\"))\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tui.helper.data(\"enterResponse\", res);\r\n\t\t\t// this.debug(\"helper.enterResponse: %o\", res);\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"over\":\r\n\t\t\tenterResponse = ui.helper.data(\"enterResponse\");\r\n\t\t\thitMode = null;\r\n\t\t\tif(enterResponse === false){\r\n\t\t\t\t// Don't call dragOver if onEnter returned false.\r\n//                break;\r\n\t\t\t} else if(typeof enterResponse === \"string\") {\r\n\t\t\t\t// Use hitMode from onEnter if provided.\r\n\t\t\t\thitMode = enterResponse;\r\n\t\t\t} else {\r\n\t\t\t\t// Calculate hitMode from relative cursor position.\r\n\t\t\t\tnodeOfs = $nodeTag.offset();\r\n\t\t\t\trelPos = { x: event.pageX - nodeOfs.left,\r\n\t\t\t\t\t\t   y: event.pageY - nodeOfs.top };\r\n\t\t\t\trelPos2 = { x: relPos.x / $nodeTag.width(),\r\n\t\t\t\t\t\t\ty: relPos.y / $nodeTag.height() };\r\n\r\n\t\t\t\tif( enterResponse.after && relPos2.y > 0.75 ){\r\n\t\t\t\t\thitMode = \"after\";\r\n\t\t\t\t} else if(!enterResponse.over && enterResponse.after && relPos2.y > 0.5 ){\r\n\t\t\t\t\thitMode = \"after\";\r\n\t\t\t\t} else if(enterResponse.before && relPos2.y <= 0.25) {\r\n\t\t\t\t\thitMode = \"before\";\r\n\t\t\t\t} else if(!enterResponse.over && enterResponse.before && relPos2.y <= 0.5) {\r\n\t\t\t\t\thitMode = \"before\";\r\n\t\t\t\t} else if(enterResponse.over) {\r\n\t\t\t\t\thitMode = \"over\";\r\n\t\t\t\t}\r\n\t\t\t\t// Prevent no-ops like 'before source node'\r\n\t\t\t\t// TODO: these are no-ops when moving nodes, but not in copy mode\r\n\t\t\t\tif( dnd.preventVoidMoves ){\r\n\t\t\t\t\tif(node === otherNode){\r\n\t\t\t\t\t\tthis.debug(\"    drop over source node prevented\");\r\n\t\t\t\t\t\thitMode = null;\r\n\t\t\t\t\t}else if(hitMode === \"before\" && otherNode && node === otherNode.getNextSibling()){\r\n\t\t\t\t\t\tthis.debug(\"    drop after source node prevented\");\r\n\t\t\t\t\t\thitMode = null;\r\n\t\t\t\t\t}else if(hitMode === \"after\" && otherNode && node === otherNode.getPrevSibling()){\r\n\t\t\t\t\t\tthis.debug(\"    drop before source node prevented\");\r\n\t\t\t\t\t\thitMode = null;\r\n\t\t\t\t\t}else if(hitMode === \"over\" && otherNode && otherNode.parent === node && otherNode.isLastSibling() ){\r\n\t\t\t\t\t\tthis.debug(\"    drop last child over own parent prevented\");\r\n\t\t\t\t\t\thitMode = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n//                this.debug(\"hitMode: %s - %s - %s\", hitMode, (node.parent === otherNode), node.isLastSibling());\r\n\t\t\t\tui.helper.data(\"hitMode\", hitMode);\r\n\t\t\t}\r\n\t\t\t// Auto-expand node (only when 'over' the node, not 'before', or 'after')\r\n\t\t\tif(hitMode !== \"before\" && hitMode !== \"after\" && dnd.autoExpandMS &&\r\n\t\t\t\tnode.hasChildren() !== false && !node.expanded &&\r\n\t\t\t\t(!dnd.dragExpand || dnd.dragExpand(node, ctx) !== false)\r\n\t\t\t\t) {\r\n\t\t\t\tnode.scheduleAction(\"expand\", dnd.autoExpandMS);\r\n\t\t\t}\r\n\t\t\tif(hitMode && dnd.dragOver){\r\n\t\t\t\t// TODO: http://code.google.com/p/dynatree/source/detail?r=625\r\n\t\t\t\tctx.hitMode = hitMode;\r\n\t\t\t\tres = dnd.dragOver(node, ctx);\r\n\t\t\t}\r\n\t\t\taccept = (res !== false && hitMode !== null);\r\n\t\t\tif( dnd.smartRevert ) {\r\n\t\t\t\tdraggable.options.revert = !accept;\r\n\t\t\t}\r\n\t\t\tthis._local._setDndStatus(otherNode, node, ui.helper, hitMode, accept);\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"drop\":\r\n\t\t\thitMode = ui.helper.data(\"hitMode\");\r\n\t\t\tif(hitMode && dnd.dragDrop){\r\n\t\t\t\tctx.hitMode = hitMode;\r\n\t\t\t\tdnd.dragDrop(node, ctx);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"leave\":\r\n\t\t\t// Cancel pending expand request\r\n\t\t\tnode.scheduleAction(\"cancel\");\r\n\t\t\tui.helper.data(\"enterResponse\", null);\r\n\t\t\tui.helper.data(\"hitMode\", null);\r\n\t\t\tthis._local._setDndStatus(otherNode, node, ui.helper, \"out\", undefined);\r\n\t\t\tif(dnd.dragLeave){\r\n\t\t\t\tdnd.dragLeave(node, ctx);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tcase \"stop\":\r\n\t\t\t$nodeTag.removeClass(\"fancytree-drag-source\");\r\n\t\t\t$(document).off(\".fancytree-dnd\");\r\n\t\t\tif(dnd.dragStop){\r\n\t\t\t\tdnd.dragStop(node, ctx);\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\r\n\t\tdefault:\r\n\t\t\t$.error(\"Unsupported drag event: \" + eventName);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\r\n\t_cancelDrag: function() {\r\n\t\t var dd = $.ui.ddmanager.current;\r\n\t\t if(dd){\r\n\t\t\t dd.cancel();\r\n\t\t }\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.dnd5.js\r\n *\r\n * Drag-and-drop support (native HTML5).\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n\r\n /*\r\n #TODO\r\n\tCompatiblity when dragging between *separate* windows:\r\n\r\n\t\t   Drag from Chrome   Edge    FF    IE11    Safari\r\n\t  To Chrome      ok       ok      ok    NO      ?\r\n\t\t Edge        ok       ok      ok    NO      ?\r\n\t\t FF          ok       ok      ok    NO      ?\r\n\t\t IE 11       ok       ok      ok    ok      ?\r\n\t\t Safari      ?        ?       ?     ?       ok\r\n\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n/* *****************************************************************************\r\n * Private functions and variables\r\n */\r\nvar FT = $.ui.fancytree,\r\n\tclassDragSource = \"fancytree-drag-source\",\r\n\tclassDragRemove = \"fancytree-drag-remove\",\r\n\tclassDropAccept = \"fancytree-drop-accept\",\r\n\tclassDropAfter = \"fancytree-drop-after\",\r\n\tclassDropBefore = \"fancytree-drop-before\",\r\n\tclassDropOver = \"fancytree-drop-over\",\r\n\tclassDropReject = \"fancytree-drop-reject\",\r\n\tclassDropTarget = \"fancytree-drop-target\",\r\n\tnodeMimeType = \"application/x-fancytree-node\",\r\n\t$dropMarker = null,\r\n\tSOURCE_NODE = null,\r\n\tDRAG_ENTER_RESPONSE = null,\r\n\tLAST_HIT_MODE = null;\r\n\r\n/* Convert number to string and prepend +/-; return empty string for 0.*/\r\nfunction offsetString(n){\r\n\treturn n === 0 ? \"\" : (( n > 0 ) ? (\"+\" + n) : (\"\" + n));\r\n}\r\n\r\n/* Convert a dragEnter() or dragOver() response to a canonical form.\r\n * Return false or plain object\r\n * @param {string|object|boolean} r\r\n * @return {object|false}\r\n */\r\nfunction normalizeDragEnterResponse(r) {\r\n\tvar res;\r\n\r\n\tif( !r ){\r\n\t\treturn false;\r\n\t}\r\n\tif ( $.isPlainObject(r) ) {\r\n\t\tres = {\r\n\t\t\tover: !!r.over,\r\n\t\t\tbefore: !!r.before,\r\n\t\t\tafter: !!r.after\r\n\t\t};\r\n\t}else if ( $.isArray(r) ) {\r\n\t\tres = {\r\n\t\t\tover: ($.inArray(\"over\", r) >= 0),\r\n\t\t\tbefore: ($.inArray(\"before\", r) >= 0),\r\n\t\t\tafter: ($.inArray(\"after\", r) >= 0)\r\n\t\t};\r\n\t}else{\r\n\t\tres = {\r\n\t\t\tover: ((r === true) || (r === \"over\")),\r\n\t\t\tbefore: ((r === true) || (r === \"before\")),\r\n\t\t\tafter: ((r === true) || (r === \"after\"))\r\n\t\t};\r\n\t}\r\n\tif( Object.keys(res).length === 0 ) {\r\n\t\treturn false;\r\n\t}\r\n\t// if( Object.keys(res).length === 1 ) {\r\n\t// \tres.unique = res[0];\r\n\t// }\r\n\treturn res;\r\n}\r\n\r\n/* Implement auto scrolling when drag cursor is in top/bottom area of scroll parent. */\r\nfunction autoScroll(tree, event) {\r\n\tvar spOfs, scrollTop, delta,\r\n\t\tdndOpts = tree.options.dnd5,\r\n\t\tsp = tree.$scrollParent[0],\r\n\t\tsensitivity = dndOpts.scrollSensitivity,\r\n\t\tspeed = dndOpts.scrollSpeed,\r\n\t\tscrolled = 0;\r\n\r\n\tif ( sp !== document && sp.tagName !== \"HTML\" ) {\r\n\t\tspOfs = tree.$scrollParent.offset();\r\n\t\tscrollTop = sp.scrollTop;\r\n\t\tif ( spOfs.top + sp.offsetHeight - event.pageY < sensitivity ) {\r\n\t\t\tdelta = (sp.scrollHeight - tree.$scrollParent.innerHeight() - scrollTop);\r\n\t\t\t// console.log (\"sp.offsetHeight: \" + sp.offsetHeight\r\n\t\t\t// \t+ \", spOfs.top: \" + spOfs.top\r\n\t\t\t// \t+ \", scrollTop: \" + scrollTop\r\n\t\t\t// \t+ \", innerHeight: \" + tree.$scrollParent.innerHeight()\r\n\t\t\t// \t+ \", scrollHeight: \" + sp.scrollHeight\r\n\t\t\t// \t+ \", delta: \" + delta\r\n\t\t\t// \t);\r\n\t\t\tif( delta > 0 ) {\r\n\t\t\t\tsp.scrollTop = scrolled = scrollTop + speed;\r\n\t\t\t}\r\n\t\t} else if ( scrollTop > 0 && event.pageY - spOfs.top < sensitivity ) {\r\n\t\t\tsp.scrollTop = scrolled = scrollTop - speed;\r\n\t\t}\r\n\t} else {\r\n\t\tscrollTop = $(document).scrollTop();\r\n\t\tif (scrollTop > 0 && event.pageY - scrollTop < sensitivity) {\r\n\t\t\tscrolled = scrollTop - speed;\r\n\t\t\t$(document).scrollTop(scrolled);\r\n\t\t} else if ($(window).height() - (event.pageY - scrollTop) < sensitivity) {\r\n\t\t\tscrolled = scrollTop + speed;\r\n\t\t\t$(document).scrollTop(scrolled);\r\n\t\t}\r\n\t}\r\n\tif( scrolled ) {\r\n\t\ttree.debug(\"autoScroll: \" + scrolled + \"px\");\r\n\t}\r\n\treturn scrolled;\r\n}\r\n\r\n/* Handle dragover event (fired every x ms) and return hitMode. */\r\nfunction handleDragOver(event, data) {\r\n\t// Implement auto-scrolling\r\n\tif ( data.options.dnd5.scroll ) {\r\n\t\tautoScroll(data.tree, event);\r\n\t}\r\n\t// Bail out with previous response if we get an invalid dragover\r\n\tif( !data.node ) {\r\n\t\tdata.tree.warn(\"Ignore dragover for non-node\");  //, event, data);\r\n\t\treturn LAST_HIT_MODE;\r\n\t}\r\n\r\n\tvar markerOffsetX, nodeOfs, relPosY, //res,\r\n\t\t// eventHash = getEventHash(event),\r\n\t\thitMode = null,\r\n\t\ttree = data.tree,\r\n\t\toptions = tree.options,\r\n\t\tdndOpts = options.dnd5,\r\n\t\ttargetNode = data.node,\r\n\t\tsourceNode = data.otherNode,\r\n\t\tmarkerAt = \"center\",\r\n\t\t// $source = sourceNode ? $(sourceNode.span) : null,\r\n\t\t$target = $(targetNode.span),\r\n\t\t$targetTitle = $target.find(\"span.fancytree-title\");\r\n\r\n\tif(DRAG_ENTER_RESPONSE === false){\r\n\t\ttree.info(\"Ignore dragover, since dragenter returned false\");  //, event, data);\r\n\t\t// $.error(\"assert failed: dragenter returned false\");\r\n\t\treturn false;\r\n\t} else if(typeof DRAG_ENTER_RESPONSE === \"string\") {\r\n\t\t$.error(\"assert failed: dragenter returned string\");\r\n\t\t// Use hitMode from onEnter if provided.\r\n\t\t// hitMode = DRAG_ENTER_RESPONSE;\r\n\t} else {\r\n\t\t// Calculate hitMode from relative cursor position.\r\n\t\tnodeOfs = $target.offset();\r\n\t\trelPosY = (event.pageY - nodeOfs.top) / $target.height();\r\n\r\n\t\tif( DRAG_ENTER_RESPONSE.after && relPosY > 0.75 ){\r\n\t\t\thitMode = \"after\";\r\n\t\t} else if(!DRAG_ENTER_RESPONSE.over && DRAG_ENTER_RESPONSE.after && relPosY > 0.5 ){\r\n\t\t\thitMode = \"after\";\r\n\t\t} else if(DRAG_ENTER_RESPONSE.before && relPosY <= 0.25) {\r\n\t\t\thitMode = \"before\";\r\n\t\t} else if(!DRAG_ENTER_RESPONSE.over && DRAG_ENTER_RESPONSE.before && relPosY <= 0.5) {\r\n\t\t\thitMode = \"before\";\r\n\t\t} else if(DRAG_ENTER_RESPONSE.over) {\r\n\t\t\thitMode = \"over\";\r\n\t\t}\r\n\t\t// Prevent no-ops like 'before source node'\r\n\t\t// TODO: these are no-ops when moving nodes, but not in copy mode\r\n\t\tif( dndOpts.preventVoidMoves ){\r\n\t\t\tif(targetNode === sourceNode){\r\n\t\t\t\ttargetNode.debug(\"drop over source node prevented\");\r\n\t\t\t\thitMode = null;\r\n\t\t\t}else if(hitMode === \"before\" && sourceNode && targetNode === sourceNode.getNextSibling()){\r\n\t\t\t\ttargetNode.debug(\"drop after source node prevented\");\r\n\t\t\t\thitMode = null;\r\n\t\t\t}else if(hitMode === \"after\" && sourceNode && targetNode === sourceNode.getPrevSibling()){\r\n\t\t\t\ttargetNode.debug(\"drop before source node prevented\");\r\n\t\t\t\thitMode = null;\r\n\t\t\t}else if(hitMode === \"over\" && sourceNode && sourceNode.parent === targetNode && sourceNode.isLastSibling() ){\r\n\t\t\t\ttargetNode.debug(\"drop last child over own parent prevented\");\r\n\t\t\t\thitMode = null;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t// Let callback modify the calculated hitMode\r\n\tdata.hitMode = hitMode;\r\n\tif(hitMode && dndOpts.dragOver){\r\n\t\t// TODO: http://code.google.com/p/dynatree/source/detail?r=625\r\n\t\tdndOpts.dragOver(targetNode, data);\r\n\t\thitMode = data.hitMode;\r\n\t}\r\n\t// LAST_DROP_EFFECT = data.dataTransfer.dropEffect;\r\n\t// LAST_EFFECT_ALLOWED = data.dataTransfer.effectAllowed;\r\n\tLAST_HIT_MODE = hitMode;\r\n\t//\r\n\tif( hitMode === \"after\" || hitMode === \"before\" || hitMode === \"over\" ){\r\n\t\tmarkerOffsetX = dndOpts.dropMarkerOffsetX || 0;\r\n\t\tswitch(hitMode){\r\n\t\tcase \"before\":\r\n\t\t\tmarkerAt = \"top\";\r\n\t\t\tmarkerOffsetX += (dndOpts.dropMarkerInsertOffsetX || 0);\r\n\t\t\tbreak;\r\n\t\tcase \"after\":\r\n\t\t\tmarkerAt = \"bottom\";\r\n\t\t\tmarkerOffsetX += (dndOpts.dropMarkerInsertOffsetX || 0);\r\n\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t$dropMarker\r\n\t\t\t.toggleClass(classDropAfter, hitMode === \"after\")\r\n\t\t\t.toggleClass(classDropOver, hitMode === \"over\")\r\n\t\t\t.toggleClass(classDropBefore, hitMode === \"before\")\r\n\t\t\t.show()\r\n\t\t\t.position(FT.fixPositionOptions({\r\n\t\t\t\tmy: \"left\" + offsetString(markerOffsetX) + \" center\",\r\n\t\t\t\tat: \"left \" + markerAt,\r\n\t\t\t\tof: $targetTitle\r\n\t\t\t\t}));\r\n\t} else {\r\n\t\t$dropMarker.hide();\r\n\t\t// console.log(\"hide dropmarker\")\r\n\t}\r\n\t// if( $source ){\r\n\t// \t$source.toggleClass(classDragRemove, isMove);\r\n\t// }\r\n\t$(targetNode.span)\r\n\t\t.toggleClass(classDropTarget, hitMode === \"after\" || hitMode === \"before\" || hitMode === \"over\")\r\n\t\t.toggleClass(classDropAfter, hitMode === \"after\")\r\n\t\t.toggleClass(classDropBefore, hitMode === \"before\")\r\n\t\t.toggleClass(classDropAccept, hitMode === \"over\")\r\n\t\t.toggleClass(classDropReject, hitMode === false);\r\n\r\n\treturn hitMode;\r\n}\r\n\r\n/* *****************************************************************************\r\n *\r\n */\r\n\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"dnd5\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tautoExpandMS: 1500,          // Expand nodes after n milliseconds of hovering\r\n\t\tsetTextTypeJson: false,      // Allow dragging of nodes to different IE windows\r\n\t\tpreventForeignNodes: false,  // Prevent dropping nodes from different Fancytrees\r\n\t\tpreventNonNodes: false,      // Prevent dropping items other than Fancytree nodes\r\n\t\tpreventRecursiveMoves: true, // Prevent dropping nodes on own descendants\r\n\t\tpreventVoidMoves: true,      // Prevent dropping nodes 'before self', etc.\r\n\t\tscroll: true,                // Enable auto-scrolling while dragging\r\n\t\tscrollSensitivity: 20,       // Active top/bottom margin in pixel\r\n\t\tscrollSpeed: 5,              // Pixel per event\r\n\t\tdropMarkerOffsetX: -24,\t\t // absolute position offset for .fancytree-drop-marker relatively to ..fancytree-title (icon/img near a node accepting drop)\r\n\t\tdropMarkerInsertOffsetX: -16,// additional offset for drop-marker with hitMode = \"before\"/\"after\"\r\n\t\t// Events (drag support)\r\n\t\tdragStart: null,       // Callback(sourceNode, data), return true, to enable dnd drag\r\n\t\tdragDrag: $.noop,      // Callback(sourceNode, data)\r\n\t\tdragEnd: $.noop,       // Callback(sourceNode, data)\r\n\t\t// Events (drop support)\r\n\t\tdragEnter: null,       // Callback(targetNode, data), return true, to enable dnd drop\r\n\t\tdragOver: $.noop,      // Callback(targetNode, data)\r\n\t\tdragExpand: $.noop,    // Callback(targetNode, data), return false to prevent autoExpand\r\n\t\tdragDrop: $.noop,      // Callback(targetNode, data)\r\n\t\tdragLeave: $.noop      // Callback(targetNode, data)\r\n\t},\r\n\r\n\ttreeInit: function(ctx){\r\n\t\tvar $temp,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\tglyph = opts.glyph || null,\r\n\t\t\tdndOpts = opts.dnd5,\r\n\t\t\tgetNode = FT.getNode;\r\n\r\n\t\tif( $.inArray(\"dnd\", opts.extensions) >= 0 ) {\r\n\t\t\t$.error(\"Extensions 'dnd' and 'dnd5' are mutually exclusive.\");\r\n\t\t}\r\n\t\tif( dndOpts.dragStop ) {\r\n\t\t\t$.error(\"dragStop is not used by ext-dnd5. Use dragEnd instead.\");\r\n\t\t}\r\n\r\n\t\t// Implement `opts.createNode` event to add the 'draggable' attribute\r\n\t\t// #680: this must happen before calling super.treeInit()\r\n\t\tif( dndOpts.dragStart ) {\r\n\t\t\tFT.overrideMethod(ctx.options, \"createNode\", function(event, data) {\r\n\t\t\t\t// Default processing if any\r\n\t\t\t\tthis._super.apply(this, arguments);\r\n\r\n\t\t\t\tdata.node.span.draggable = true;\r\n\t\t\t});\r\n\t\t}\r\n\t\tthis._superApply(arguments);\r\n\r\n\t\tthis.$container.addClass(\"fancytree-ext-dnd5\");\r\n\r\n\t\t// Store the current scroll parent, which may be the tree\r\n\t\t// container, any enclosing div, or the document.\r\n\t\t// #761: scrollParent() always needs a container child\r\n\t\t$temp = $(\"<span>\").appendTo(this.$container);\r\n\t\tthis.$scrollParent = $temp.scrollParent();\r\n\t\t$temp.remove();\r\n\r\n\t\t$dropMarker = $(\"#fancytree-drop-marker\");\r\n\t\tif( !$dropMarker.length ) {\r\n\t\t\t$dropMarker = $(\"<div id='fancytree-drop-marker'></div>\")\r\n\t\t\t\t.hide()\r\n\t\t\t\t.css({\r\n\t\t\t\t\t\"z-index\": 1000,\r\n\t\t\t\t\t// Drop marker should not steal dragenter/dragover events:\r\n\t\t\t\t\t\"pointer-events\": \"none\"\r\n\t\t\t\t}).prependTo(\"body\");\r\n\t\t\tif( glyph ) {\r\n\t\t\t\tFT.setSpanIcon($dropMarker[0], glyph.map._addClass, glyph.map.dropMarker);\r\n\t\t\t\t// $dropMarker.addClass(glyph.map._addClass + \" \" + glyph.map.dropMarker);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Enable drag support if dragStart() is specified:\r\n\t\tif( dndOpts.dragStart ) {\r\n\t\t\t// Bind drag event handlers\r\n\t\t\ttree.$container.on(\"dragstart drag dragend\", function(event){\r\n\t\t\t\tvar json,\r\n\t\t\t\t\tnode = getNode(event),\r\n\t\t\t\t\tdataTransfer = event.dataTransfer || event.originalEvent.dataTransfer,\r\n\t\t\t\t\tisMove = dataTransfer.dropEffect === \"move\",\r\n\t\t\t\t\t$source = node ? $(node.span) : null,\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tnode: node,\r\n\t\t\t\t\t\ttree: tree,\r\n\t\t\t\t\t\toptions: tree.options,\r\n\t\t\t\t\t\toriginalEvent: event,\r\n\t\t\t\t\t\tdataTransfer: dataTransfer,\r\n//\t\t\t\t\t\tdropEffect: undefined,  // set by dragend\r\n\t\t\t\t\t\tisCancelled: undefined  // set by dragend\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tswitch( event.type ) {\r\n\r\n\t\t\t\tcase \"dragstart\":\r\n\t\t\t\t\t$(node.span).addClass(classDragSource);\r\n\r\n\t\t\t\t\t// Store current source node in different formats\r\n\t\t\t\t\tSOURCE_NODE = node;\r\n\r\n\t\t\t\t\t// Set payload\r\n\t\t\t\t\t// Note:\r\n\t\t\t\t\t// Transfer data is only accessible on dragstart and drop!\r\n\t\t\t\t\t// For all other events the formats and kinds in the drag\r\n\t\t\t\t\t// data store list of items representing dragged data can be\r\n\t\t\t\t\t// enumerated, but the data itself is unavailable and no new\r\n\t\t\t\t\t// data can be added.\r\n\t\t\t\t\tjson = JSON.stringify(node.toDict());\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdataTransfer.setData(nodeMimeType, json);\r\n\t\t\t\t\t\tdataTransfer.setData(\"text/html\", $(node.span).html());\r\n\t\t\t\t\t\tdataTransfer.setData(\"text/plain\", node.title);\r\n\t\t\t\t\t} catch(ex) {\r\n\t\t\t\t\t\t// IE only accepts 'text' type\r\n\t\t\t\t\t\ttree.warn(\"Could not set data (IE only accepts 'text') - \" + ex);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// We always need to set the 'text' type if we want to drag\r\n\t\t\t\t\t// Because IE 11 only accepts this single type.\r\n\t\t\t\t\t// If we pass JSON here, IE can can access all node properties,\r\n\t\t\t\t\t// even when the source lives in another window. (D'n'd inside\r\n\t\t\t\t\t// the same window will always work.)\r\n\t\t\t\t\t// The drawback is, that in this case ALL browsers will see\r\n\t\t\t\t\t// the JSON representation as 'text', so dragging\r\n\t\t\t\t\t// to a text field will insert the JSON string instead of\r\n\t\t\t\t\t// the node title.\r\n\t\t\t\t\tif( dndOpts.setTextTypeJson ) {\r\n\t\t\t\t\t\tdataTransfer.setData(\"text\", json);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdataTransfer.setData(\"text\", node.title);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Set the allowed and current drag mode (move, copy, or link)\r\n\t\t\t\t\tdataTransfer.effectAllowed = \"all\";  // \"copyMove\"\r\n\t\t\t\t\t// dataTransfer.dropEffect = \"move\";\r\n\r\n\t\t\t\t\t// Set the title as drag image (otherwise it would contain the expander)\r\n\t\t\t\t\tif( dataTransfer.setDragImage ) {\r\n\t\t\t\t\t\t// IE 11 does not support this\r\n\t\t\t\t\t\tdataTransfer.setDragImage($(node.span).find(\".fancytree-title\")[0], -10, -10);\r\n\t\t\t\t\t\t// dataTransfer.setDragImage($(node.span)[0], -10, -10);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Let user modify above settings\r\n\t\t\t\t\treturn dndOpts.dragStart(node, data) !== false;\r\n\r\n\t\t\t\tcase \"drag\":\r\n\t\t\t\t\t// Called every few miliseconds\r\n\t\t\t\t\t$source.toggleClass(classDragRemove, isMove);\r\n\t\t\t\t\tdndOpts.dragDrag(node, data);\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dragend\":\r\n\t\t\t\t\t$(node.span).removeClass(classDragSource + \" \" + classDragRemove);\r\n\t\t\t\t\tSOURCE_NODE = null;\r\n\t\t\t\t\tDRAG_ENTER_RESPONSE = null;\r\n//\t\t\t\t\tdata.dropEffect = dataTransfer.dropEffect;\r\n\t\t\t\t\tdata.isCancelled = (dataTransfer.dropEffect === \"none\");\r\n\t\t\t\t\t$dropMarker.hide();\r\n\t\t\t\t\tdndOpts.dragEnd(node, data);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// Enable drop support if dragEnter() is specified:\r\n\t\tif( dndOpts.dragEnter ) {\r\n\t\t\t// Bind drop event handlers\r\n\t\t\ttree.$container.on(\"dragenter dragover dragleave drop\", function(event){\r\n\t\t\t\tvar json, nodeData, r, res,\r\n\t\t\t\t\tallowDrop = null,\r\n\t\t\t\t\tnode = getNode(event),\r\n\t\t\t\t\tdataTransfer = event.dataTransfer || event.originalEvent.dataTransfer,\r\n\t\t\t\t\tdata = {\r\n\t\t\t\t\t\tnode: node,\r\n\t\t\t\t\t\ttree: tree,\r\n\t\t\t\t\t\toptions: tree.options,\r\n\t\t\t\t\t\thitMode: DRAG_ENTER_RESPONSE,\r\n\t\t\t\t\t\toriginalEvent: event,\r\n\t\t\t\t\t\tdataTransfer: dataTransfer,\r\n\t\t\t\t\t\totherNode: SOURCE_NODE || null,\r\n\t\t\t\t\t\totherNodeData: null,    // set by drop event\r\n\t\t\t\t\t\tdropEffect: undefined,  // set by drop event\r\n\t\t\t\t\t\tisCancelled: undefined  // set by drop event\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tswitch( event.type ) {\r\n\r\n\t\t\t\tcase \"dragenter\":\r\n\t\t\t\t\t// The dragenter event is fired when a dragged element or\r\n\t\t\t\t\t// text selection enters a valid drop target.\r\n\r\n\t\t\t\t\tif( !node ) {\r\n\t\t\t\t\t\t// Sometimes we get dragenter for the container element\r\n\t\t\t\t\t\ttree.debug(\"Ignore non-node \" + event.type + \": \" + event.target.tagName + \".\" + event.target.className);\r\n\t\t\t\t\t\tDRAG_ENTER_RESPONSE = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(node.span)\r\n\t\t\t\t\t\t.addClass(classDropOver)\r\n\t\t\t\t\t\t.removeClass(classDropAccept + \" \" + classDropReject);\r\n\r\n\t\t\t\t\tif( dndOpts.preventNonNodes && !nodeData ) {\r\n\t\t\t\t\t\tnode.debug(\"Reject dropping a non-node\");\r\n\t\t\t\t\t\tDRAG_ENTER_RESPONSE = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t} else if( dndOpts.preventForeignNodes && (!SOURCE_NODE || SOURCE_NODE.tree !== node.tree ) ) {\r\n\t\t\t\t\t\tnode.debug(\"Reject dropping a foreign node\");\r\n\t\t\t\t\t\tDRAG_ENTER_RESPONSE = false;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// NOTE: dragenter is fired BEFORE the dragleave event\r\n\t\t\t\t\t// of the previous element!\r\n\t\t\t\t\t// https://www.w3.org/Bugs/Public/show_bug.cgi?id=19041\r\n\t\t\t\t\tsetTimeout(function(){\r\n\t\t\t\t\t\t// node.info(\"DELAYED \" + event.type, event.target, DRAG_ENTER_RESPONSE);\r\n\t\t\t\t\t\t// Auto-expand node (only when 'over' the node, not 'before', or 'after')\r\n\t\t\t\t\t\tif( dndOpts.autoExpandMS &&\r\n\t\t\t\t\t\t\tnode.hasChildren() !== false && !node.expanded &&\r\n\t\t\t\t\t\t\t(!dndOpts.dragExpand || dndOpts.dragExpand(node, data) !== false)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tnode.scheduleAction(\"expand\", dndOpts.autoExpandMS);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 0);\r\n\r\n\t\t\t\t\t$dropMarker.show();\r\n\r\n\t\t\t\t\t// Call dragEnter() to figure out if (and where) dropping is allowed\r\n\t\t\t\t\tif( dndOpts.preventRecursiveMoves && node.isDescendantOf(data.otherNode) ){\r\n\t\t\t\t\t\tres = false;\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\tr = dndOpts.dragEnter(node, data);\r\n\t\t\t\t\t\tres = normalizeDragEnterResponse(r);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tDRAG_ENTER_RESPONSE = res;\r\n\r\n\t\t\t\t\tallowDrop = res && ( res.over || res.before || res.after );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dragover\":\r\n\t\t\t\t\t// The dragover event is fired when an element or text\r\n\t\t\t\t\t// selection is being dragged over a valid drop target\r\n\t\t\t\t\t// (every few hundred milliseconds).\r\n\t\t\t\t\tLAST_HIT_MODE = handleDragOver(event, data);\r\n\t\t\t\t\tallowDrop = !!LAST_HIT_MODE;\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"dragleave\":\r\n\t\t\t\t\t// NOTE: dragleave is fired AFTER the dragenter event of the\r\n\t\t\t\t\t// FOLLOWING element.\r\n\t\t\t\t\tif( !node ) {\r\n\t\t\t\t\t\ttree.debug(\"Ignore non-node \" + event.type + \": \" + event.target.tagName + \".\" + event.target.className);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( !$(node.span).hasClass(classDropOver) ) {\r\n\t\t\t\t\t\tnode.debug(\"Ignore dragleave (multi)\"); //, event.currentTarget);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t$(node.span).removeClass(classDropOver + \" \" + classDropAccept + \" \" + classDropReject);\r\n\t\t\t\t\tnode.scheduleAction(\"cancel\");\r\n\t\t\t\t\tdndOpts.dragLeave(node, data);\r\n\t\t\t\t\t$dropMarker.hide();\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"drop\":\r\n\t\t\t\t\t// Data is only readable in the (dragenter and) drop event:\r\n\r\n\t\t\t\t\tif( $.inArray(nodeMimeType, dataTransfer.types) >= 0 ) {\r\n\t\t\t\t\t\tnodeData = dataTransfer.getData(nodeMimeType);\r\n\t\t\t\t\t\ttree.info(event.type + \": getData('application/x-fancytree-node'): '\" + nodeData + \"'\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( !nodeData ) {\r\n\t\t\t\t\t\t// 1. Source is not a Fancytree node, or\r\n\t\t\t\t\t\t// 2. If the FT mime type was set, but returns '', this\r\n\t\t\t\t\t\t//    is probably IE 11 (which only supports 'text')\r\n\t\t\t\t\t\tnodeData = dataTransfer.getData(\"text\");\r\n\t\t\t\t\t\ttree.info(event.type + \": getData('text'): '\" + nodeData + \"'\");\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif( nodeData ) {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t// 'text' type may contain JSON if IE is involved\r\n\t\t\t\t\t\t\t// and setTextTypeJson option was set\r\n\t\t\t\t\t\t\tjson = JSON.parse(nodeData);\r\n\t\t\t\t\t\t\tif( json.title !== undefined ) {\r\n\t\t\t\t\t\t\t\tdata.otherNodeData = json;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch(ex) {\r\n\t\t\t\t\t\t\t// assume 'text' type contains plain text, so `otherNodeData`\r\n\t\t\t\t\t\t\t// should not be set\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttree.debug(event.type + \": nodeData: '\" + nodeData + \"', otherNodeData: \", data.otherNodeData);\r\n\r\n\t\t\t\t\t$(node.span).removeClass(classDropOver + \" \" + classDropAccept + \" \" + classDropReject);\r\n\t\t\t\t\t$dropMarker.hide();\r\n\r\n\t\t\t\t\tdata.hitMode = LAST_HIT_MODE;\r\n\t\t\t\t\tdata.dropEffect = dataTransfer.dropEffect;\r\n\t\t\t\t\tdata.isCancelled = data.dropEffect === \"none\";\r\n\r\n\t\t\t\t\t// Let user implement the actual drop operation\r\n\t\t\t\t\tdndOpts.dragDrop(node, data);\r\n\r\n\t\t\t\t\t// Prevent browser's default drop handling\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t// Dnd API madness: we must PREVENT default handling to enable dropping\r\n\t\t\t\tif( allowDrop ) {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.edit.js\r\n *\r\n * Make node titles editable.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n\r\n/*******************************************************************************\r\n * Private functions and variables\r\n */\r\n\r\nvar isMac = /Mac/.test(navigator.platform),\r\n\tescapeHtml = $.ui.fancytree.escapeHtml,\r\n\tunescapeHtml = $.ui.fancytree.unescapeHtml;\r\n\r\n/**\r\n * [ext-edit] Start inline editing of current node title.\r\n *\r\n * @alias FancytreeNode#editStart\r\n * @requires Fancytree\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.editStart = function(){\r\n\tvar $input,\r\n\t\tnode = this,\r\n\t\ttree = this.tree,\r\n\t\tlocal = tree.ext.edit,\r\n\t\tinstOpts = tree.options.edit,\r\n\t\t$title = $(\".fancytree-title\", node.span),\r\n\t\teventData = {\r\n\t\t\tnode: node,\r\n\t\t\ttree: tree,\r\n\t\t\toptions: tree.options,\r\n\t\t\tisNew: $(node[tree.statusClassPropName]).hasClass(\"fancytree-edit-new\"),\r\n\t\t\torgTitle: node.title,\r\n\t\t\tinput: null,\r\n\t\t\tdirty: false\r\n\t\t\t};\r\n\r\n\t// beforeEdit may want to modify the title before editing\r\n\tif( instOpts.beforeEdit.call(node, {type: \"beforeEdit\"}, eventData) === false ) {\r\n\t\treturn false;\r\n\t}\r\n\t$.ui.fancytree.assert(!local.currentNode, \"recursive edit\");\r\n\tlocal.currentNode = this;\r\n\tlocal.eventData = eventData;\r\n\r\n\t// Disable standard Fancytree mouse- and key handling\r\n\ttree.widget._unbind();\r\n\t// #116: ext-dnd prevents the blur event, so we have to catch outer clicks\r\n\t$(document).on(\"mousedown.fancytree-edit\", function(event){\r\n\t\tif( ! $(event.target).hasClass(\"fancytree-edit-input\") ){\r\n\t\t\tnode.editEnd(true, event);\r\n\t\t}\r\n\t});\r\n\r\n\t// Replace node with <input>\r\n\t$input = $(\"<input />\", {\r\n\t\t\"class\": \"fancytree-edit-input\",\r\n\t\ttype: \"text\",\r\n\t\tvalue: tree.options.escapeTitles ? eventData.orgTitle : unescapeHtml(eventData.orgTitle)\r\n\t});\r\n\tlocal.eventData.input = $input;\r\n\tif ( instOpts.adjustWidthOfs != null ) {\r\n\t\t$input.width($title.width() + instOpts.adjustWidthOfs);\r\n\t}\r\n\tif ( instOpts.inputCss != null ) {\r\n\t\t$input.css(instOpts.inputCss);\r\n\t}\r\n\r\n\t$title.html($input);\r\n\r\n\t// Focus <input> and bind keyboard handler\r\n\t$input\r\n\t\t.focus()\r\n\t\t.change(function(event){\r\n\t\t\t$input.addClass(\"fancytree-edit-dirty\");\r\n\t\t}).keydown(function(event){\r\n\t\t\tswitch( event.which ) {\r\n\t\t\tcase $.ui.keyCode.ESCAPE:\r\n\t\t\t\tnode.editEnd(false, event);\r\n\t\t\t\tbreak;\r\n\t\t\tcase $.ui.keyCode.ENTER:\r\n\t\t\t\tnode.editEnd(true, event);\r\n\t\t\t\treturn false; // so we don't start editmode on Mac\r\n\t\t\t}\r\n\t\t\tevent.stopPropagation();\r\n\t\t}).blur(function(event){\r\n\t\t\treturn node.editEnd(true, event);\r\n\t\t});\r\n\r\n\tinstOpts.edit.call(node, {type: \"edit\"}, eventData);\r\n};\r\n\r\n\r\n/**\r\n * [ext-edit] Stop inline editing.\r\n * @param {Boolean} [applyChanges=false] false: cancel edit, true: save (if modified)\r\n * @alias FancytreeNode#editEnd\r\n * @requires jquery.fancytree.edit.js\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.editEnd = function(applyChanges, _event){\r\n\tvar newVal,\r\n\t\tnode = this,\r\n\t\ttree = this.tree,\r\n\t\tlocal = tree.ext.edit,\r\n\t\teventData = local.eventData,\r\n\t\tinstOpts = tree.options.edit,\r\n\t\t$title = $(\".fancytree-title\", node.span),\r\n\t\t$input = $title.find(\"input.fancytree-edit-input\");\r\n\r\n\tif( instOpts.trim ) {\r\n\t\t$input.val($.trim($input.val()));\r\n\t}\r\n\tnewVal = $input.val();\r\n\r\n\teventData.dirty = ( newVal !== node.title );\r\n\teventData.originalEvent = _event;\r\n\r\n\t// Find out, if saving is required\r\n\tif( applyChanges === false ) {\r\n\t\t// If true/false was passed, honor this (except in rename mode, if unchanged)\r\n\t\teventData.save = false;\r\n\t} else if( eventData.isNew ) {\r\n\t\t// In create mode, we save everything, except for empty text\r\n\t\teventData.save = (newVal !== \"\");\r\n\t} else {\r\n\t\t// In rename mode, we save everyting, except for empty or unchanged text\r\n\t\teventData.save = eventData.dirty && (newVal !== \"\");\r\n\t}\r\n\t// Allow to break (keep editor open), modify input, or re-define data.save\r\n\tif( instOpts.beforeClose.call(node, {type: \"beforeClose\"}, eventData) === false){\r\n\t\treturn false;\r\n\t}\r\n\tif( eventData.save && instOpts.save.call(node, {type: \"save\"}, eventData) === false){\r\n\t\treturn false;\r\n\t}\r\n\t$input\r\n\t\t.removeClass(\"fancytree-edit-dirty\")\r\n\t\t.off();\r\n\t// Unbind outer-click handler\r\n\t$(document).off(\".fancytree-edit\");\r\n\r\n\tif( eventData.save ) {\r\n\t\t// # 171: escape user input (not required if global escaping is on)\r\n\t\tnode.setTitle( tree.options.escapeTitles ? newVal : escapeHtml(newVal) );\r\n\t\tnode.setFocus();\r\n\t}else{\r\n\t\tif( eventData.isNew ) {\r\n\t\t\tnode.remove();\r\n\t\t\tnode = eventData.node = null;\r\n\t\t\tlocal.relatedNode.setFocus();\r\n\t\t} else {\r\n\t\t\tnode.renderTitle();\r\n\t\t\tnode.setFocus();\r\n\t\t}\r\n\t}\r\n\tlocal.eventData = null;\r\n\tlocal.currentNode = null;\r\n\tlocal.relatedNode = null;\r\n\t// Re-enable mouse and keyboard handling\r\n\ttree.widget._bind();\r\n\t// Set keyboard focus, even if setFocus() claims 'nothing to do'\r\n\t$(tree.$container).focus();\r\n\teventData.input = null;\r\n\tinstOpts.close.call(node, {type: \"close\"}, eventData);\r\n\treturn true;\r\n};\r\n\r\n\r\n/**\r\n* [ext-edit] Create a new child or sibling node and start edit mode.\r\n*\r\n* @param {String} [mode='child'] 'before', 'after', or 'child'\r\n* @param {Object} [init] NodeData (or simple title string)\r\n* @alias FancytreeNode#editCreateNode\r\n* @requires jquery.fancytree.edit.js\r\n* @since 2.4\r\n*/\r\n$.ui.fancytree._FancytreeNodeClass.prototype.editCreateNode = function(mode, init){\r\n\tvar newNode,\r\n\t\ttree = this.tree,\r\n\t\tself = this;\r\n\r\n\tmode = mode || \"child\";\r\n\tif( init == null ) {\r\n\t\tinit = { title: \"\" };\r\n\t} else if( typeof init === \"string\" ) {\r\n\t\tinit = { title: init };\r\n\t} else {\r\n\t\t$.ui.fancytree.assert($.isPlainObject(init));\r\n\t}\r\n\t// Make sure node is expanded (and loaded) in 'child' mode\r\n\tif( mode === \"child\" && !this.isExpanded() && this.hasChildren() !== false ) {\r\n\t\tthis.setExpanded().done(function(){\r\n\t\t\tself.editCreateNode(mode, init);\r\n\t\t});\r\n\t\treturn;\r\n\t}\r\n\tnewNode = this.addNode(init, mode);\r\n\r\n\t// #644: Don't filter new nodes.\r\n\tnewNode.match = true;\r\n\t$(newNode[tree.statusClassPropName])\r\n\t\t.removeClass(\"fancytree-hide\")\r\n\t\t.addClass(\"fancytree-match\");\r\n\r\n\tnewNode.makeVisible(/*{noAnimation: true}*/).done(function(){\r\n\t\t$(newNode[tree.statusClassPropName]).addClass(\"fancytree-edit-new\");\r\n\t\tself.tree.ext.edit.relatedNode = self;\r\n\t\tnewNode.editStart();\r\n\t});\r\n};\r\n\r\n\r\n/**\r\n * [ext-edit] Check if any node in this tree  in edit mode.\r\n *\r\n * @returns {FancytreeNode | null}\r\n * @alias Fancytree#isEditing\r\n * @requires jquery.fancytree.edit.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.isEditing = function(){\r\n\treturn this.ext.edit ? this.ext.edit.currentNode : null;\r\n};\r\n\r\n\r\n/**\r\n * [ext-edit] Check if this node is in edit mode.\r\n * @returns {Boolean} true if node is currently beeing edited\r\n * @alias FancytreeNode#isEditing\r\n * @requires jquery.fancytree.edit.js\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.isEditing = function(){\r\n\treturn this.tree.ext.edit ? this.tree.ext.edit.currentNode === this : false;\r\n};\r\n\r\n\r\n/*******************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"edit\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tadjustWidthOfs: 4,   // null: don't adjust input size to content\r\n\t\tallowEmpty: false,   // Prevent empty input\r\n\t\tinputCss: {minWidth: \"3em\"},\r\n\t\t// triggerCancel: [\"esc\", \"tab\", \"click\"],\r\n\t\ttriggerStart: [\"f2\", \"mac+enter\", \"shift+click\"],\r\n\t\ttrim: true,          // Trim whitespace before save\r\n\t\t// Events:\r\n\t\tbeforeClose: $.noop, // Return false to prevent cancel/save (data.input is available)\r\n\t\tbeforeEdit: $.noop,  // Return false to prevent edit mode\r\n\t\tclose: $.noop,       // Editor was removed\r\n\t\tedit: $.noop,        // Editor was opened (available as data.input)\r\n//\t\tkeypress: $.noop,    // Not yet implemented\r\n\t\tsave: $.noop         // Save data.input.val() or return false to keep editor open\r\n\t},\r\n\t// Local attributes\r\n\tcurrentNode: null,\r\n\r\n\ttreeInit: function(ctx){\r\n\t\tthis._superApply(arguments);\r\n\t\tthis.$container.addClass(\"fancytree-ext-edit\");\r\n\t},\r\n\tnodeClick: function(ctx) {\r\n\t\tif( $.inArray(\"shift+click\", ctx.options.edit.triggerStart) >= 0 ){\r\n\t\t\tif( ctx.originalEvent.shiftKey ){\r\n\t\t\t\tctx.node.editStart();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( $.inArray(\"clickActive\", ctx.options.edit.triggerStart) >= 0 ){\r\n\t\t\t// Only when click was inside title text (not aynwhere else in the row)\r\n\t\t\tif( ctx.node.isActive() && !ctx.node.isEditing() &&\r\n\t\t\t\t$(ctx.originalEvent.target).hasClass(\"fancytree-title\")\r\n\t\t\t){\r\n\t\t\t\tctx.node.editStart();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\tnodeDblclick: function(ctx) {\r\n\t\tif( $.inArray(\"dblclick\", ctx.options.edit.triggerStart) >= 0 ){\r\n\t\t\tctx.node.editStart();\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\tnodeKeydown: function(ctx) {\r\n\t\tswitch( ctx.originalEvent.which ) {\r\n\t\tcase 113: // [F2]\r\n\t\t\tif( $.inArray(\"f2\", ctx.options.edit.triggerStart) >= 0 ){\r\n\t\t\t\tctx.node.editStart();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\tcase $.ui.keyCode.ENTER:\r\n\t\t\tif( $.inArray(\"mac+enter\", ctx.options.edit.triggerStart) >= 0 && isMac ){\r\n\t\t\t\tctx.node.editStart();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this._superApply(arguments);\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.filter.js\r\n *\r\n * Remove or highlight tree nodes, based on a filter.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n\r\n/*******************************************************************************\r\n * Private functions and variables\r\n */\r\n\r\nvar KeyNoData = \"__not_found__\",\r\n\tescapeHtml = $.ui.fancytree.escapeHtml;\r\n\r\nfunction _escapeRegex(str){\r\n\t/*jshint regexdash:true */\r\n\treturn (str + \"\").replace(/([.?*+\\^\\$\\[\\]\\\\(){}|-])/g, \"\\\\$1\");\r\n}\r\n\r\nfunction extractHtmlText(s){\r\n\tif( s.indexOf(\">\") >= 0 ) {\r\n\t\treturn $(\"<div/>\").html(s).text();\r\n\t}\r\n\treturn s;\r\n}\r\n\r\n$.ui.fancytree._FancytreeClass.prototype._applyFilterImpl = function(filter, branchMode, _opts){\r\n\tvar match, statusNode, re, reHighlight, temp,\r\n\t\tcount = 0,\r\n\t\ttreeOpts = this.options,\r\n\t\tescapeTitles = treeOpts.escapeTitles,\r\n\t\tprevAutoCollapse = treeOpts.autoCollapse,\r\n\t\topts = $.extend({}, treeOpts.filter, _opts),\r\n\t\thideMode = opts.mode === \"hide\",\r\n\t\tleavesOnly = !!opts.leavesOnly && !branchMode;\r\n\r\n\t// Default to 'match title substring (not case sensitive)'\r\n\tif(typeof filter === \"string\"){\r\n\t\tif( filter === \"\" ) {\r\n\t\t\tthis.warn(\"Fancytree passing an empty string as a filter is handled as clearFilter().\");\r\n\t\t\tthis.clearFilter();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif( opts.fuzzy ) {\r\n\t\t\t// See https://codereview.stackexchange.com/questions/23899/faster-javascript-fuzzy-string-matching-function/23905#23905\r\n\t\t\t// and http://www.quora.com/How-is-the-fuzzy-search-algorithm-in-Sublime-Text-designed\r\n\t\t\t// and http://www.dustindiaz.com/autocomplete-fuzzy-matching\r\n\t\t\tmatch = filter.split(\"\").reduce(function(a, b) {\r\n\t\t\t\treturn a + \"[^\" + b + \"]*\" + b;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tmatch = _escapeRegex(filter); // make sure a '.' is treated literally\r\n\t\t}\r\n\t\tre = new RegExp(\".*\" + match + \".*\", \"i\");\r\n\t\treHighlight = new RegExp(_escapeRegex(filter), \"gi\");\r\n\t\tfilter = function(node){\r\n\t\t\tvar text = escapeTitles ? node.title : extractHtmlText(node.title),\r\n\t\t\t\tres = !!re.test(text);\r\n\r\n\t\t\tif( res && opts.highlight ) {\r\n\t\t\t\tif( escapeTitles ) {\r\n\t\t\t\t\t// #740: we must not apply the marks to escaped entity names, e.g. `&quot;`\r\n\t\t\t\t\t// Use some exotic characters to mark matches:\r\n\t\t\t\t\ttemp = text.replace(reHighlight, function(s){\r\n\t\t\t\t\t\treturn \"\\uFFF7\" + s + \"\\uFFF8\";\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// now we can escape the title...\r\n\t\t\t\t\tnode.titleWithHighlight = escapeHtml(temp)\r\n\t\t\t\t\t\t// ... and finally insert the desired `<mark>` tags\r\n\t\t\t\t\t\t.replace(/\\uFFF7/g, \"<mark>\")\r\n\t\t\t\t\t\t.replace(/\\uFFF8/g, \"</mark>\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnode.titleWithHighlight = text.replace(reHighlight, function(s){\r\n\t\t\t\t\t\treturn \"<mark>\" + s + \"</mark>\";\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// node.debug(\"filter\", escapeTitles, text, node.titleWithHighlight);\r\n\t\t\t}\r\n\t\t\treturn res;\r\n\t\t};\r\n\t}\r\n\r\n\tthis.enableFilter = true;\r\n\tthis.lastFilterArgs = arguments;\r\n\r\n\tthis.$div.addClass(\"fancytree-ext-filter\");\r\n\tif( hideMode ){\r\n\t\tthis.$div.addClass(\"fancytree-ext-filter-hide\");\r\n\t} else {\r\n\t\tthis.$div.addClass(\"fancytree-ext-filter-dimm\");\r\n\t}\r\n\tthis.$div.toggleClass(\"fancytree-ext-filter-hide-expanders\", !!opts.hideExpanders);\r\n\t// Reset current filter\r\n\tthis.visit(function(node){\r\n\t\tdelete node.match;\r\n\t\tdelete node.titleWithHighlight;\r\n\t\tnode.subMatchCount = 0;\r\n\t});\r\n\tstatusNode = this.getRootNode()._findDirectChild(KeyNoData);\r\n\tif( statusNode ) {\r\n\t\tstatusNode.remove();\r\n\t}\r\n\r\n\t// Adjust node.hide, .match, and .subMatchCount properties\r\n\ttreeOpts.autoCollapse = false;  // #528\r\n\r\n\tthis.visit(function(node){\r\n\t\tif ( leavesOnly && node.children != null ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tvar res = filter(node),\r\n\t\t\tmatchedByBranch = false;\r\n\r\n\t\tif( res === \"skip\" ) {\r\n\t\t\tnode.visit(function(c){\r\n\t\t\t\tc.match = false;\r\n\t\t\t}, true);\r\n\t\t\treturn \"skip\";\r\n\t\t}\r\n\t\tif( !res && (branchMode || res === \"branch\") && node.parent.match ) {\r\n\t\t\tres = true;\r\n\t\t\tmatchedByBranch = true;\r\n\t\t}\r\n\t\tif( res ) {\r\n\t\t\tcount++;\r\n\t\t\tnode.match = true;\r\n\t\t\tnode.visitParents(function(p){\r\n\t\t\t\tp.subMatchCount += 1;\r\n\t\t\t\t// Expand match (unless this is no real match, but only a node in a matched branch)\r\n\t\t\t\tif( opts.autoExpand && !matchedByBranch && !p.expanded ) {\r\n\t\t\t\t\tp.setExpanded(true, {noAnimation: true, noEvents: true, scrollIntoView: false});\r\n\t\t\t\t\tp._filterAutoExpanded = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\ttreeOpts.autoCollapse = prevAutoCollapse;\r\n\r\n\tif( count === 0 && opts.nodata && hideMode ) {\r\n\t\tstatusNode = opts.nodata;\r\n\t\tif( $.isFunction(statusNode) ) {\r\n\t\t\tstatusNode = statusNode();\r\n\t\t}\r\n\t\tif( statusNode === true ) {\r\n\t\t\tstatusNode = {};\r\n\t\t} else if( typeof statusNode === \"string\" ) {\r\n\t\t\tstatusNode = { title: statusNode };\r\n\t\t}\r\n\t\tstatusNode = $.extend({\r\n\t\t\tstatusNodeType: \"nodata\",\r\n\t\t\tkey: KeyNoData,\r\n\t\t\ttitle: this.options.strings.noData\r\n\t\t}, statusNode);\r\n\r\n\t\tthis.getRootNode().addNode(statusNode).match = true;\r\n\t}\r\n\t// Redraw whole tree\r\n\tthis.render();\r\n\treturn count;\r\n};\r\n\r\n/**\r\n * [ext-filter] Dimm or hide nodes.\r\n *\r\n * @param {function | string} filter\r\n * @param {boolean} [opts={autoExpand: false, leavesOnly: false}]\r\n * @returns {integer} count\r\n * @alias Fancytree#filterNodes\r\n * @requires jquery.fancytree.filter.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.filterNodes = function(filter, opts) {\r\n\tif( typeof opts === \"boolean\" ) {\r\n\t\topts = { leavesOnly: opts };\r\n\t\tthis.warn(\"Fancytree.filterNodes() leavesOnly option is deprecated since 2.9.0 / 2015-04-19. Use opts.leavesOnly instead.\");\r\n\t}\r\n\treturn this._applyFilterImpl(filter, false, opts);\r\n};\r\n\r\n/**\r\n * @deprecated\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.applyFilter = function(filter){\r\n\tthis.warn(\"Fancytree.applyFilter() is deprecated since 2.1.0 / 2014-05-29. Use .filterNodes() instead.\");\r\n\treturn this.filterNodes.apply(this, arguments);\r\n};\r\n\r\n/**\r\n * [ext-filter] Dimm or hide whole branches.\r\n *\r\n * @param {function | string} filter\r\n * @param {boolean} [opts={autoExpand: false}]\r\n * @returns {integer} count\r\n * @alias Fancytree#filterBranches\r\n * @requires jquery.fancytree.filter.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.filterBranches = function(filter, opts){\r\n\treturn this._applyFilterImpl(filter, true, opts);\r\n};\r\n\r\n\r\n/**\r\n * [ext-filter] Reset the filter.\r\n *\r\n * @alias Fancytree#clearFilter\r\n * @requires jquery.fancytree.filter.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.clearFilter = function(){\r\n\tvar $title,\r\n\t\tstatusNode = this.getRootNode()._findDirectChild(KeyNoData),\r\n\t\tescapeTitles = this.options.escapeTitles,\r\n\t\tenhanceTitle = this.options.enhanceTitle;\r\n\r\n\tif( statusNode ) {\r\n\t\tstatusNode.remove();\r\n\t}\r\n\tthis.visit(function(node){\r\n\t\tif( node.match && node.span ) {  // #491, #601\r\n\t\t\t$title = $(node.span).find(\">span.fancytree-title\");\r\n\t\t\tif( escapeTitles ) {\r\n\t\t\t\t$title.text(node.title);\r\n\t\t\t} else {\r\n\t\t\t\t$title.html(node.title);\r\n\t\t\t}\r\n\t\t\tif( enhanceTitle ) {\r\n\t\t\t\tenhanceTitle({type: \"enhanceTitle\"}, {node: node, $title: $title});\r\n\t\t\t}\r\n\t\t}\r\n\t\tdelete node.match;\r\n\t\tdelete node.subMatchCount;\r\n\t\tdelete node.titleWithHighlight;\r\n\t\tif ( node.$subMatchBadge ) {\r\n\t\t\tnode.$subMatchBadge.remove();\r\n\t\t\tdelete node.$subMatchBadge;\r\n\t\t}\r\n\t\tif( node._filterAutoExpanded && node.expanded ) {\r\n\t\t\tnode.setExpanded(false, {noAnimation: true, noEvents: true, scrollIntoView: false});\r\n\t\t}\r\n\t\tdelete node._filterAutoExpanded;\r\n\t});\r\n\tthis.enableFilter = false;\r\n\tthis.lastFilterArgs = null;\r\n\tthis.$div.removeClass(\"fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide\");\r\n\tthis.render();\r\n};\r\n\r\n\r\n/**\r\n * [ext-filter] Return true if a filter is currently applied.\r\n *\r\n * @returns {Boolean}\r\n * @alias Fancytree#isFilterActive\r\n * @requires jquery.fancytree.filter.js\r\n * @since 2.13\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.isFilterActive = function(){\r\n\treturn !!this.enableFilter;\r\n};\r\n\r\n\r\n/**\r\n * [ext-filter] Return true if this node is matched by current filter (or no filter is active).\r\n *\r\n * @returns {Boolean}\r\n * @alias FancytreeNode#isMatched\r\n * @requires jquery.fancytree.filter.js\r\n * @since 2.13\r\n */\r\n$.ui.fancytree._FancytreeNodeClass.prototype.isMatched = function(){\r\n\treturn !(this.tree.enableFilter && !this.match);\r\n};\r\n\r\n\r\n/*******************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"filter\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tautoApply: true,   // Re-apply last filter if lazy data is loaded\r\n\t\tautoExpand: false, // Expand all branches that contain matches while filtered\r\n\t\tcounter: true,     // Show a badge with number of matching child nodes near parent icons\r\n\t\tfuzzy: false,      // Match single characters in order, e.g. 'fb' will match 'FooBar'\r\n\t\thideExpandedCounter: true,  // Hide counter badge if parent is expanded\r\n\t\thideExpanders: false,       // Hide expanders if all child nodes are hidden by filter\r\n\t\thighlight: true,   // Highlight matches by wrapping inside <mark> tags\r\n\t\tleavesOnly: false, // Match end nodes only\r\n\t\tnodata: true,      // Display a 'no data' status node if result is empty\r\n\t\tmode: \"dimm\"       // Grayout unmatched nodes (pass \"hide\" to remove unmatched node instead)\r\n\t},\r\n\tnodeLoadChildren: function(ctx, source) {\r\n\t\treturn this._superApply(arguments).done(function() {\r\n\t\t\tif( ctx.tree.enableFilter && ctx.tree.lastFilterArgs && ctx.options.filter.autoApply ) {\r\n\t\t\t\tctx.tree._applyFilterImpl.apply(ctx.tree, ctx.tree.lastFilterArgs);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tnodeSetExpanded: function(ctx, flag, callOpts) {\r\n\t\tdelete ctx.node._filterAutoExpanded;\r\n\t\t// Make sure counter badge is displayed again, when node is beeing collapsed\r\n\t\tif( !flag && ctx.options.filter.hideExpandedCounter && ctx.node.$subMatchBadge ) {\r\n\t\t\tctx.node.$subMatchBadge.show();\r\n\t\t}\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\tnodeRenderStatus: function(ctx) {\r\n\t\t// Set classes for current status\r\n\t\tvar res,\r\n\t\t\tnode = ctx.node,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options.filter,\r\n\t\t\t$title = $(node.span).find(\"span.fancytree-title\"),\r\n\t\t\t$span = $(node[tree.statusClassPropName]),\r\n\t\t\tenhanceTitle = ctx.options.enhanceTitle,\r\n\t\t\tescapeTitles = ctx.options.escapeTitles;\r\n\r\n\t\tres = this._super(ctx);\r\n\t\t// nothing to do, if node was not yet rendered\r\n\t\tif( !$span.length || !tree.enableFilter ) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\t$span\r\n\t\t\t.toggleClass(\"fancytree-match\", !!node.match)\r\n\t\t\t.toggleClass(\"fancytree-submatch\", !!node.subMatchCount)\r\n\t\t\t.toggleClass(\"fancytree-hide\", !(node.match || node.subMatchCount));\r\n\t\t// Add/update counter badge\r\n\t\tif( opts.counter && node.subMatchCount && (!node.isExpanded() || !opts.hideExpandedCounter) ) {\r\n\t\t\tif( !node.$subMatchBadge ) {\r\n\t\t\t\tnode.$subMatchBadge = $(\"<span class='fancytree-childcounter'/>\");\r\n\t\t\t\t$(\"span.fancytree-icon, span.fancytree-custom-icon\", node.span).append(node.$subMatchBadge);\r\n\t\t\t}\r\n\t\t\tnode.$subMatchBadge.show().text(node.subMatchCount);\r\n\t\t} else if ( node.$subMatchBadge ) {\r\n\t\t\tnode.$subMatchBadge.hide();\r\n\t\t}\r\n\t\t// node.debug(\"nodeRenderStatus\", node.titleWithHighlight, node.title)\r\n\t\t// #601: also chek for $title.length, because we don't need to render\r\n\t\t// if node.span is null (i.e. not rendered)\r\n\t\tif( node.span && (!node.isEditing || !node.isEditing.call(node)) ) {\r\n\t\t\tif( node.titleWithHighlight ) {\r\n\t\t\t\t$title.html(node.titleWithHighlight);\r\n\t\t\t} else if ( escapeTitles ) {\r\n\t\t\t\t$title.text(node.title);\r\n\t\t\t} else {\r\n\t\t\t\t$title.html(node.title);\r\n\t\t\t}\r\n\t\t\tif( enhanceTitle ) {\r\n\t\t\t\tenhanceTitle({type: \"enhanceTitle\"}, {node: node, $title: $title});\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.glyph.js\r\n *\r\n * Use glyph fonts as instead of icon sprites.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n/* *****************************************************************************\r\n * Private functions and variables\r\n */\r\n\r\nvar FT = $.ui.fancytree,\r\n\tPRESETS = {\r\n\t\t\"awesome3\": {  // Outdated!\r\n\t\t\t_addClass: \"\",\r\n\t\t\tcheckbox: \"icon-check-empty\",\r\n\t\t\tcheckboxSelected: \"icon-check\",\r\n\t\t\tcheckboxUnknown: \"icon-check icon-muted\",\r\n\t\t\tdragHelper: \"icon-caret-right\",\r\n\t\t\tdropMarker: \"icon-caret-right\",\r\n\t\t\terror: \"icon-exclamation-sign\",\r\n\t\t\texpanderClosed: \"icon-caret-right\",\r\n\t\t\texpanderLazy: \"icon-angle-right\",\r\n\t\t\texpanderOpen: \"icon-caret-down\",\r\n\t\t\tloading: \"icon-refresh icon-spin\",\r\n\t\t\tnodata: \"icon-meh\",\r\n\t\t\tnoExpander: \"\",\r\n\t\t\tradio: \"icon-circle-blank\",\r\n\t\t\tradioSelected: \"icon-circle\",\r\n\t\t\t// radioUnknown: \"icon-circle icon-muted\",\r\n\t\t\t// Default node icons.\r\n\t\t\t// (Use tree.options.icon callback to define custom icons based on node data)\r\n\t\t\tdoc: \"icon-file-alt\",\r\n\t\t\tdocOpen: \"icon-file-alt\",\r\n\t\t\tfolder: \"icon-folder-close-alt\",\r\n\t\t\tfolderOpen: \"icon-folder-open-alt\"\r\n\t\t\t},\r\n\t\t\"awesome4\": {\r\n\t\t\t_addClass: \"fa\",\r\n\t\t\tcheckbox: \"fa-square-o\",\r\n\t\t\tcheckboxSelected: \"fa-check-square-o\",\r\n\t\t\tcheckboxUnknown: \"fa-square\",\r\n\t\t\tdragHelper: \"fa-arrow-right\",\r\n\t\t\tdropMarker: \"fa-long-arrow-right\",\r\n\t\t\terror: \"fa-warning\",\r\n\t\t\texpanderClosed: \"fa-caret-right\",\r\n\t\t\texpanderLazy: \"fa-angle-right\",\r\n\t\t\texpanderOpen: \"fa-caret-down\",\r\n\t\t\tloading: \"fa-spinner fa-pulse\",\r\n\t\t\tnodata: \"fa-meh-o\",\r\n\t\t\tnoExpander: \"\",\r\n\t\t\tradio: \"fa-circle-thin\",  // \"fa-circle-o\"\r\n\t\t\tradioSelected: \"fa-circle\",\r\n\t\t\t// radioUnknown: \"fa-dot-circle-o\",\r\n\t\t\t// Default node icons.\r\n\t\t\t// (Use tree.options.icon callback to define custom icons based on node data)\r\n\t\t\tdoc: \"fa-file-o\",\r\n\t\t\tdocOpen: \"fa-file-o\",\r\n\t\t\tfolder: \"fa-folder-o\",\r\n\t\t\tfolderOpen: \"fa-folder-open-o\"\r\n\t\t\t},\r\n\t\t\"bootstrap3\": {\r\n\t\t\t_addClass: \"glyphicon\",\r\n\t\t\tcheckbox: \"glyphicon-unchecked\",\r\n\t\t\tcheckboxSelected: \"glyphicon-check\",\r\n\t\t\tcheckboxUnknown: \"glyphicon-expand\",  // \"glyphicon-share\",\r\n\t\t\tdragHelper: \"glyphicon-play\",\r\n\t\t\tdropMarker: \"glyphicon-arrow-right\",\r\n\t\t\terror: \"glyphicon-warning-sign\",\r\n\t\t\texpanderClosed: \"glyphicon-menu-right\",  // glyphicon-plus-sign\r\n\t\t\texpanderLazy: \"glyphicon-menu-right\",  // glyphicon-plus-sign\r\n\t\t\texpanderOpen: \"glyphicon-menu-down\",  // glyphicon-minus-sign\r\n\t\t\tloading: \"glyphicon-refresh glyphicon-spin\",\r\n\t\t\tnodata: \"glyphicon-info-sign\",\r\n\t\t\tnoExpander: \"\",\r\n\t\t\tradio: \"glyphicon-remove-circle\",  // \"glyphicon-unchecked\",\r\n\t\t\tradioSelected: \"glyphicon-ok-circle\",  // \"glyphicon-check\",\r\n\t\t\t// radioUnknown: \"glyphicon-ban-circle\",\r\n\t\t\t// Default node icons.\r\n\t\t\t// (Use tree.options.icon callback to define custom icons based on node data)\r\n\t\t\tdoc: \"glyphicon-file\",\r\n\t\t\tdocOpen: \"glyphicon-file\",\r\n\t\t\tfolder: \"glyphicon-folder-close\",\r\n\t\t\tfolderOpen: \"glyphicon-folder-open\"\r\n\t\t\t},\r\n\t\t\"material\": {\r\n\t\t\t_addClass: \"material-icons\",\r\n\t\t\tcheckbox: { text: \"check_box_outline_blank\" },\r\n\t\t\tcheckboxSelected: { text: \"check_box\" },\r\n\t\t\tcheckboxUnknown: { text: \"indeterminate_check_box\" },\r\n\t\t\tdragHelper: { text: \"play_arrow\" },\r\n\t\t\tdropMarker: { text: \"arrow-forward\" },\r\n\t\t\terror: { text: \"warning\" },\r\n\t\t\texpanderClosed: { text: \"chevron_right\" },\r\n\t\t\texpanderLazy: { text: \"last_page\" },\r\n\t\t\texpanderOpen: { text: \"expand_more\" },\r\n\t\t\tloading: { text: \"autorenew\", addClass: \"glyphicon-spin\" },\r\n\t\t\tnodata: { text: \"info\" },\r\n\t\t\tnoExpander: { text: \"\" },\r\n\t\t\tradio: { text: \"radio_button_unchecked\" },\r\n\t\t\tradioSelected: { text: \"radio_button_checked\" },\r\n\t\t\t// Default node icons.\r\n\t\t\t// (Use tree.options.icon callback to define custom icons based on node data)\r\n\t\t\tdoc: { text: \"insert_drive_file\" },\r\n\t\t\tdocOpen: { text: \"insert_drive_file\" },\r\n\t\t\tfolder: { text: \"folder\" },\r\n\t\t\tfolderOpen: { text: \"folder_open\" }\r\n\t\t\t}\r\n\t};\r\n\r\n\r\nfunction setIcon( span, baseClass, opts, type ) {\r\n\tvar map = opts.map,\r\n\t\ticon = map[ type ],\r\n\t\t$span = $( span ),\r\n\t\tsetClass = baseClass + \" \" + (map._addClass || \"\");\r\n\r\n\tif( typeof icon === \"string\" ) {\r\n\t\t$span.attr( \"class\", setClass + \" \" + icon );\r\n\t} else {\r\n\t\tif( icon.text ) {\r\n\t\t\t$span.text( \"\" + icon.text );\r\n\t\t}\r\n\t\t$span.attr( \"class\", setClass + \" \" + ( icon.addClass || \"\" ) );\r\n\t}\r\n}\r\n\r\n\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"glyph\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tpreset: null,  // 'awesome3', 'awesome4', 'bootstrap3', 'material'\r\n\t\tmap: {\r\n\t\t}\r\n\t},\r\n\r\n\ttreeInit: function(ctx){\r\n\t\tvar tree = ctx.tree,\r\n\t\t\topts = ctx.options.glyph;\r\n\r\n\t\tif( opts.preset ) {\r\n\t\t\tFT.assert( !!PRESETS[opts.preset],\r\n\t\t\t\t\"Invalid value for `options.glyph.preset`: \" + opts.preset);\r\n\t\t\topts.map = $.extend({}, PRESETS[opts.preset], opts.map);\r\n\t\t} else {\r\n\t\t\ttree.warn(\"ext-glyph: missing `preset` option.\");\r\n\t\t}\r\n\t\tthis._superApply(arguments);\r\n\t\ttree.$container.addClass(\"fancytree-ext-glyph\");\r\n\t},\r\n\tnodeRenderStatus: function(ctx) {\r\n\t\tvar checkbox, icon, res, span,\r\n\t\t\tnode = ctx.node,\r\n\t\t\t$span = $( node.span ),\r\n\t\t\topts = ctx.options.glyph;\r\n\r\n\t\tres = this._super(ctx);\r\n\r\n\t\tif( node.isRoot() ){\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\tspan = $span.children(\"span.fancytree-expander\").get(0);\r\n\t\tif( span ){\r\n\t\t\t// if( node.isLoading() ){\r\n\t\t\t\t// icon = \"loading\";\r\n\t\t\tif( node.expanded && node.hasChildren() ){\r\n\t\t\t\ticon = \"expanderOpen\";\r\n\t\t\t}else if( node.isUndefined() ){\r\n\t\t\t\ticon = \"expanderLazy\";\r\n\t\t\t}else if( node.hasChildren() ){\r\n\t\t\t\ticon = \"expanderClosed\";\r\n\t\t\t}else{\r\n\t\t\t\ticon = \"noExpander\";\r\n\t\t\t}\r\n\t\t\t// span.className = \"fancytree-expander \" + map[icon];\r\n\t\t\tsetIcon( span, \"fancytree-expander\", opts, icon );\r\n\t\t}\r\n\r\n\t\tif( node.tr ){\r\n\t\t\tspan = $(\"td\", node.tr).find(\"span.fancytree-checkbox\").get(0);\r\n\t\t}else{\r\n\t\t\tspan = $span.children(\"span.fancytree-checkbox\").get(0);\r\n\t\t}\r\n\t\tif( span ) {\r\n\t\t\tcheckbox = FT.evalOption(\"checkbox\", node, node, opts, false);\r\n\t\t\tif( (node.parent && node.parent.radiogroup ) || checkbox === \"radio\" ) {\r\n\t\t\t\ticon = node.selected ? \"radioSelected\" : \"radio\";\r\n\t\t\t\tsetIcon( span, \"fancytree-checkbox fancytree-radio\", opts, icon );\r\n\t\t\t} else {\r\n\t\t\t\ticon = node.selected ? \"checkboxSelected\" : (node.partsel ? \"checkboxUnknown\" : \"checkbox\");\r\n\t\t\t\t// span.className = \"fancytree-checkbox \" + map[icon];\r\n\t\t\t\tsetIcon( span, \"fancytree-checkbox\", opts, icon );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Standard icon (note that this does not match .fancytree-custom-icon,\r\n\t\t// that might be set by opts.icon callbacks)\r\n\t\tspan = $span.children(\"span.fancytree-icon\").get(0);\r\n\t\tif( span ){\r\n\t\t\tif( node.statusNodeType ){\r\n\t\t\t\ticon = node.statusNodeType; // loading, error\r\n\t\t\t}else if( node.folder ){\r\n\t\t\t\ticon = ( node.expanded && node.hasChildren() ) ? \"folderOpen\" : \"folder\";\r\n\t\t\t}else{\r\n\t\t\t\ticon = node.expanded ? \"docOpen\" : \"doc\";\r\n\t\t\t}\r\n\t\t\tsetIcon( span, \"fancytree-icon\", opts, icon );\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnodeSetStatus: function(ctx, status, message, details) {\r\n\t\tvar res, span,\r\n\t\t\topts = ctx.options.glyph,\r\n\t\t\tnode = ctx.node;\r\n\r\n\t\tres = this._superApply(arguments);\r\n\r\n\t\tif( status === \"error\" || status === \"loading\" || status === \"nodata\" ){\r\n\t\t\tif(node.parent){\r\n\t\t\t\tspan = $(\"span.fancytree-expander\", node.span).get(0);\r\n\t\t\t\tif( span ) {\r\n\t\t\t\t\tsetIcon( span, \"fancytree-expander\", opts, status );\r\n\t\t\t\t}\r\n\t\t\t}else{ //\r\n\t\t\t\tspan = $(\".fancytree-statusnode-\" + status, node[this.nodeContainerAttrName])\r\n\t\t\t\t\t.find(\"span.fancytree-icon\").get(0);\r\n\t\t\t\tif( span ) {\r\n\t\t\t\t\tsetIcon( span, \"fancytree-icon\", opts, status );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.gridnav.js\r\n *\r\n * Support keyboard navigation for trees with embedded input controls.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine([\r\n\t\t\t \"jquery\",\r\n\t\t\t \"./jquery.fancytree\",\r\n\t\t\t \"./jquery.fancytree.table\"\r\n\t\t ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree.table\");  // core + table\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n\r\n/*******************************************************************************\r\n * Private functions and variables\r\n */\r\n\r\n// Allow these navigation keys even when input controls are focused\r\n\r\nvar\tKC = $.ui.keyCode,\r\n\t// which keys are *not* handled by embedded control, but passed to tree\r\n\t// navigation handler:\r\n\tNAV_KEYS = {\r\n\t\t\"text\": [KC.UP, KC.DOWN],\r\n\t\t\"checkbox\": [KC.UP, KC.DOWN, KC.LEFT, KC.RIGHT],\r\n\t\t\"link\": [KC.UP, KC.DOWN, KC.LEFT, KC.RIGHT],\r\n\t\t\"radiobutton\": [KC.UP, KC.DOWN, KC.LEFT, KC.RIGHT],\r\n\t\t\"select-one\": [KC.LEFT, KC.RIGHT],\r\n\t\t\"select-multiple\": [KC.LEFT, KC.RIGHT]\r\n\t};\r\n\r\n\r\n/* Calculate TD column index (considering colspans).*/\r\nfunction getColIdx($tr, $td) {\r\n\tvar colspan,\r\n\t\ttd = $td.get(0),\r\n\t\tidx = 0;\r\n\r\n\t$tr.children().each(function () {\r\n\t\tif( this === td ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tcolspan = $(this).prop(\"colspan\");\r\n\t\tidx += colspan ? colspan : 1;\r\n\t});\r\n\treturn idx;\r\n}\r\n\r\n\r\n/* Find TD at given column index (considering colspans).*/\r\nfunction findTdAtColIdx($tr, colIdx) {\r\n\tvar colspan,\r\n\t\tres = null,\r\n\t\tidx = 0;\r\n\r\n\t$tr.children().each(function () {\r\n\t\tif( idx >= colIdx ) {\r\n\t\t\tres = $(this);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tcolspan = $(this).prop(\"colspan\");\r\n\t\tidx += colspan ? colspan : 1;\r\n\t});\r\n\treturn res;\r\n}\r\n\r\n\r\n/* Find adjacent cell for a given direction. Skip empty cells and consider merged cells */\r\nfunction findNeighbourTd($target, keyCode){\r\n\tvar $tr, colIdx,\r\n\t\t$td = $target.closest(\"td\"),\r\n\t\t$tdNext = null;\r\n\r\n\tswitch( keyCode ){\r\n\t\tcase KC.LEFT:\r\n\t\t\t$tdNext = $td.prev();\r\n\t\t\tbreak;\r\n\t\tcase KC.RIGHT:\r\n\t\t\t$tdNext = $td.next();\r\n\t\t\tbreak;\r\n\t\tcase KC.UP:\r\n\t\tcase KC.DOWN:\r\n\t\t\t$tr = $td.parent();\r\n\t\t\tcolIdx = getColIdx($tr, $td);\r\n\t\t\twhile( true ) {\r\n\t\t\t\t$tr = (keyCode === KC.UP) ? $tr.prev() : $tr.next();\r\n\t\t\t\tif( !$tr.length ) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\t// Skip hidden rows\r\n\t\t\t\tif( $tr.is(\":hidden\") ) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t// Find adjacent cell in the same column\r\n\t\t\t\t$tdNext = findTdAtColIdx($tr, colIdx);\r\n\t\t\t\t// Skip cells that don't conatain a focusable element\r\n\t\t\t\tif( $tdNext && $tdNext.find(\":input,a\").length ) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tbreak;\r\n\t}\r\n\treturn $tdNext;\r\n}\r\n\r\n\r\n/*******************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"gridnav\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tautofocusInput:   false,  // Focus first embedded input if node gets activated\r\n\t\thandleCursorKeys: true   // Allow UP/DOWN in inputs to move to prev/next node\r\n\t},\r\n\r\n\ttreeInit: function(ctx){\r\n\t\t// gridnav requires the table extension to be loaded before itself\r\n\t\tthis._requireExtension(\"table\", true, true);\r\n\t\tthis._superApply(arguments);\r\n\r\n\t\tthis.$container.addClass(\"fancytree-ext-gridnav\");\r\n\r\n\t\t// Activate node if embedded input gets focus (due to a click)\r\n\t\tthis.$container.on(\"focusin\", function(event){\r\n\t\t\tvar ctx2,\r\n\t\t\t\tnode = $.ui.fancytree.getNode(event.target);\r\n\r\n\t\t\tif( node && !node.isActive() ){\r\n\t\t\t\t// Call node.setActive(), but also pass the event\r\n\t\t\t\tctx2 = ctx.tree._makeHookContext(node, event);\r\n\t\t\t\tctx.tree._callHook(\"nodeSetActive\", ctx2, true);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tnodeSetActive: function(ctx, flag, callOpts) {\r\n\t\tvar $outer,\r\n\t\t\topts = ctx.options.gridnav,\r\n\t\t\tnode = ctx.node,\r\n\t\t\tevent = ctx.originalEvent || {},\r\n\t\t\ttriggeredByInput = $(event.target).is(\":input\");\r\n\r\n\t\tflag = (flag !== false);\r\n\r\n\t\tthis._superApply(arguments);\r\n\r\n\t\tif( flag ){\r\n\t\t\tif( ctx.options.titlesTabbable ){\r\n\t\t\t\tif( !triggeredByInput ) {\r\n\t\t\t\t\t$(node.span).find(\"span.fancytree-title\").focus();\r\n\t\t\t\t\tnode.setFocus();\r\n\t\t\t\t}\r\n\t\t\t\t// If one node is tabbable, the container no longer needs to be\r\n\t\t\t\tctx.tree.$container.attr(\"tabindex\", \"-1\");\r\n\t\t\t\t// ctx.tree.$container.removeAttr(\"tabindex\");\r\n\t\t\t} else if( opts.autofocusInput && !triggeredByInput ){\r\n\t\t\t\t// Set focus to input sub input (if node was clicked, but not\r\n\t\t\t\t// when TAB was pressed )\r\n\t\t\t\t$outer = $(node.tr || node.span);\r\n\t\t\t\t$outer.find(\":input:enabled:first\").focus();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tnodeKeydown: function(ctx) {\r\n\t\tvar inputType, handleKeys, $td,\r\n\t\t\topts = ctx.options.gridnav,\r\n\t\t\tevent = ctx.originalEvent,\r\n\t\t\t$target = $(event.target);\r\n\r\n\t\tif( $target.is(\":input:enabled\") ) {\r\n\t\t\tinputType = $target.prop(\"type\");\r\n\t\t} else if( $target.is(\"a\") ) {\r\n\t\t\tinputType = \"link\";\r\n\t\t}\r\n\t\t// ctx.tree.debug(\"ext-gridnav nodeKeydown\", event, inputType);\r\n\r\n\t\tif( inputType && opts.handleCursorKeys ){\r\n\t\t\thandleKeys = NAV_KEYS[inputType];\r\n\t\t\tif( handleKeys && $.inArray(event.which, handleKeys) >= 0 ){\r\n\t\t\t\t$td = findNeighbourTd($target, event.which);\r\n\t\t\t\tif( $td && $td.length ) {\r\n\t\t\t\t\t// ctx.node.debug(\"ignore keydown in input\", event.which, handleKeys);\r\n\t\t\t\t\t$td.find(\":input:enabled,a\").focus();\r\n\t\t\t\t\t// Prevent Fancytree default navigation\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t// ctx.tree.debug(\"ext-gridnav NOT HANDLED\", event, inputType);\r\n\t\treturn this._superApply(arguments);\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.persist.js\r\n *\r\n * Persist tree status in cookiesRemove or highlight tree nodes, based on a filter.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * @depends: js-cookie or jquery-cookie\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n/* global Cookies:false */\r\n\r\n/*******************************************************************************\r\n * Private functions and variables\r\n */\r\nvar cookieStore = null,\r\n\tlocalStorageStore = window.localStorage ? {\r\n\t\tget: function(key){ return window.localStorage.getItem(key); },\r\n\t\tset: function(key, value){ window.localStorage.setItem(key, value); },\r\n\t\tremove: function(key){ window.localStorage.removeItem(key); }\r\n\t} : null,\r\n\tsessionStorageStore = window.sessionStorage ? {\r\n\t\tget: function(key){ return window.sessionStorage.getItem(key); },\r\n\t\tset: function(key, value){ window.sessionStorage.setItem(key, value); },\r\n\t\tremove: function(key){ window.sessionStorage.removeItem(key); }\r\n\t} : null,\r\n\t_assert = $.ui.fancytree.assert,\r\n\tACTIVE = \"active\",\r\n\tEXPANDED = \"expanded\",\r\n\tFOCUS = \"focus\",\r\n\tSELECTED = \"selected\";\r\n\r\nif( typeof Cookies === \"function\" ) {\r\n\t// Assume https://github.com/js-cookie/js-cookie\r\n\tcookieStore = {\r\n\t\tget: Cookies.get,\r\n\t\tset: function(key, value) {\r\n\t\t\tCookies.set(key, value, this.options.persist.cookie);\r\n\t\t},\r\n\t\tremove: Cookies.remove\r\n\t};\r\n} else if ( $ && typeof $.cookie === \"function\" ) {\r\n\t// Fall back to https://github.com/carhartl/jquery-cookie\r\n\tcookieStore = {\r\n\t\tget: $.cookie,\r\n\t\tset: function(key, value) {\r\n\t\t\t$.cookie.set(key, value, this.options.persist.cookie);\r\n\t\t},\r\n\t\tremove: $.removeCookie\r\n\t};\r\n}\r\n\r\n/* Recursively load lazy nodes\r\n * @param {string} mode 'load', 'expand', false\r\n */\r\nfunction _loadLazyNodes(tree, local, keyList, mode, dfd) {\r\n\tvar i, key, l, node,\r\n\t\tfoundOne = false,\r\n\t\texpandOpts = tree.options.persist.expandOpts,\r\n\t\tdeferredList = [],\r\n\t\tmissingKeyList = [];\r\n\r\n\tkeyList = keyList || [];\r\n\tdfd = dfd || $.Deferred();\r\n\r\n\tfor( i=0, l=keyList.length; i<l; i++ ) {\r\n\t\tkey = keyList[i];\r\n\t\tnode = tree.getNodeByKey(key);\r\n\t\tif( node ) {\r\n\t\t\tif( mode && node.isUndefined() ) {\r\n\t\t\t\tfoundOne = true;\r\n\t\t\t\ttree.debug(\"_loadLazyNodes: \" + node + \" is lazy: loading...\");\r\n\t\t\t\tif( mode === \"expand\" ) {\r\n\t\t\t\t\tdeferredList.push(node.setExpanded(true, expandOpts));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdeferredList.push(node.load());\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttree.debug(\"_loadLazyNodes: \" + node + \" already loaded.\");\r\n\t\t\t\tnode.setExpanded(true, expandOpts);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tmissingKeyList.push(key);\r\n\t\t\ttree.debug(\"_loadLazyNodes: \" + node + \" was not yet found.\");\r\n\t\t}\r\n\t}\r\n\r\n\t$.when.apply($, deferredList).always(function(){\r\n\t\t// All lazy-expands have finished\r\n\t\tif( foundOne && missingKeyList.length > 0 ) {\r\n\t\t\t// If we read new nodes from server, try to resolve yet-missing keys\r\n\t\t\t_loadLazyNodes(tree, local, missingKeyList, mode, dfd);\r\n\t\t} else {\r\n\t\t\tif( missingKeyList.length ) {\r\n\t\t\t\ttree.warn(\"_loadLazyNodes: could not load those keys: \", missingKeyList);\r\n\t\t\t\tfor( i=0, l=missingKeyList.length; i<l; i++ ) {\r\n\t\t\t\t\tkey = keyList[i];\r\n\t\t\t\t\tlocal._appendKey(EXPANDED, keyList[i], false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tdfd.resolve();\r\n\t\t}\r\n\t});\r\n\treturn dfd;\r\n}\r\n\r\n\r\n/**\r\n * [ext-persist] Remove persistence data of the given type(s).\r\n * Called like\r\n *     $(\"#tree\").fancytree(\"getTree\").clearCookies(\"active expanded focus selected\");\r\n *\r\n * @alias Fancytree#clearData\r\n * @requires jquery.fancytree.persist.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.clearData = function(types){\r\n\tvar local = this.ext.persist,\r\n\t\tprefix = local.cookiePrefix;\r\n\r\n\ttypes = types || \"active expanded focus selected\";\r\n\tif(types.indexOf(ACTIVE) >= 0){\r\n\t\tlocal._data(prefix + ACTIVE, null);\r\n\t}\r\n\tif(types.indexOf(EXPANDED) >= 0){\r\n\t\tlocal._data(prefix + EXPANDED, null);\r\n\t}\r\n\tif(types.indexOf(FOCUS) >= 0){\r\n\t\tlocal._data(prefix + FOCUS, null);\r\n\t}\r\n\tif(types.indexOf(SELECTED) >= 0){\r\n\t\tlocal._data(prefix + SELECTED, null);\r\n\t}\r\n};\r\n\r\n$.ui.fancytree._FancytreeClass.prototype.clearCookies = function(types){\r\n\tthis.warn(\"'tree.clearCookies()' is deprecated since v2.27.0: use 'clearData()' instead.\");\r\n\treturn this.clearData(types);\r\n};\r\n\r\n/**\r\n * [ext-persist] Return persistence information from cookies\r\n *\r\n * Called like\r\n *     $(\"#tree\").fancytree(\"getTree\").getPersistData();\r\n *\r\n * @alias Fancytree#getPersistData\r\n * @requires jquery.fancytree.persist.js\r\n */\r\n$.ui.fancytree._FancytreeClass.prototype.getPersistData = function(){\r\n\tvar local = this.ext.persist,\r\n\t\tprefix = local.cookiePrefix,\r\n\t\tdelim = local.cookieDelimiter,\r\n\t\tres = {};\r\n\r\n\tres[ACTIVE] = local._data(prefix + ACTIVE);\r\n\tres[EXPANDED] = (local._data(prefix + EXPANDED) || \"\").split(delim);\r\n\tres[SELECTED] = (local._data(prefix + SELECTED) || \"\").split(delim);\r\n\tres[FOCUS] = local._data(prefix + FOCUS);\r\n\treturn res;\r\n};\r\n\r\n\r\n/* *****************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"persist\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tcookieDelimiter: \"~\",\r\n\t\tcookiePrefix: undefined, // 'fancytree-<treeId>-' by default\r\n\t\tcookie: {\r\n\t\t\traw: false,\r\n\t\t\texpires: \"\",\r\n\t\t\tpath: \"\",\r\n\t\t\tdomain: \"\",\r\n\t\t\tsecure: false\r\n\t\t},\r\n\t\texpandLazy: false,     // true: recursively expand and load lazy nodes\r\n\t\texpandOpts: undefined, // optional `opts` argument passed to setExpanded()\r\n\t\tfireActivate: true,    // false: suppress `activate` event after active node was restored\r\n\t\toverrideSource: true,  // true: cookie takes precedence over `source` data attributes.\r\n\t\tstore: \"auto\",         // 'cookie': force cookie, 'local': force localStore, 'session': force sessionStore\r\n\t\ttypes: \"active expanded focus selected\"\r\n\t},\r\n\r\n\t/* Generic read/write string data to cookie, sessionStorage or localStorage. */\r\n\t_data: function(key, value){\r\n\t\tvar store = this._local.store;\r\n\r\n\t\tif( value === undefined ) {\r\n\t\t\treturn store.get.call(this, key);\r\n\t\t} else if ( value === null ) {\r\n\t\t\tstore.remove.call(this, key);\r\n\t\t} else {\r\n\t\t\tstore.set.call(this, key, value);\r\n\t\t}\r\n\t},\r\n\r\n\t/* Append `key` to a cookie. */\r\n\t_appendKey: function(type, key, flag){\r\n\t\tkey = \"\" + key; // #90\r\n\t\tvar local = this._local,\r\n\t\t\tinstOpts = this.options.persist,\r\n\t\t\tdelim = instOpts.cookieDelimiter,\r\n\t\t\tcookieName = local.cookiePrefix + type,\r\n\t\t\tdata = local._data(cookieName),\r\n\t\t\tkeyList = data ? data.split(delim) : [],\r\n\t\t\tidx = $.inArray(key, keyList);\r\n\t\t// Remove, even if we add a key,  so the key is always the last entry\r\n\t\tif(idx >= 0){\r\n\t\t\tkeyList.splice(idx, 1);\r\n\t\t}\r\n\t\t// Append key to cookie\r\n\t\tif(flag){\r\n\t\t\tkeyList.push(key);\r\n\t\t}\r\n\t\tlocal._data(cookieName, keyList.join(delim));\r\n\t},\r\n\r\n\ttreeInit: function(ctx){\r\n\t\tvar tree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\tlocal = this._local,\r\n\t\t\tinstOpts = this.options.persist;\r\n\r\n\t\t// // For 'auto' or 'cookie' mode, the cookie plugin must be available\r\n\t\t// _assert((instOpts.store !== \"auto\" && instOpts.store !== \"cookie\") || cookieStore,\r\n\t\t// \t\"Missing required plugin for 'persist' extension: js.cookie.js or jquery.cookie.js\");\r\n\r\n\t\tlocal.cookiePrefix = instOpts.cookiePrefix || (\"fancytree-\" + tree._id + \"-\");\r\n\t\tlocal.storeActive = instOpts.types.indexOf(ACTIVE) >= 0;\r\n\t\tlocal.storeExpanded = instOpts.types.indexOf(EXPANDED) >= 0;\r\n\t\tlocal.storeSelected = instOpts.types.indexOf(SELECTED) >= 0;\r\n\t\tlocal.storeFocus = instOpts.types.indexOf(FOCUS) >= 0;\r\n\t\tlocal.store = null;\r\n\r\n\t\tif( instOpts.store === \"auto\" ) {\r\n\t\t\tinstOpts.store = localStorageStore ? \"local\" : \"cookie\";\r\n\t\t}\r\n\t\tif( $.isPlainObject(instOpts.store) ) {\r\n\t\t\tlocal.store = instOpts.store;\r\n\t\t} else if( instOpts.store === \"cookie\" ) {\r\n\t\t\tlocal.store = cookieStore;\r\n\t\t} else if( instOpts.store === \"local\" ){\r\n\t\t\tlocal.store = (instOpts.store === \"local\") ? localStorageStore : sessionStorageStore;\r\n\t\t} else if( instOpts.store === \"session\" ){\r\n\t\t\tlocal.store = (instOpts.store === \"local\") ? localStorageStore : sessionStorageStore;\r\n\t\t}\r\n\t\t_assert(local.store, \"Need a valid store.\");\r\n\r\n\t\t// Bind init-handler to apply cookie state\r\n\t\ttree.$div.on(\"fancytreeinit\", function(event){\r\n\t\t\tif ( tree._triggerTreeEvent(\"beforeRestore\", null, {}) === false ) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar cookie, dfd, i, keyList, node,\r\n\t\t\t\tprevFocus = local._data(local.cookiePrefix + FOCUS), // record this before node.setActive() overrides it;\r\n\t\t\t\tnoEvents = instOpts.fireActivate === false;\r\n\r\n\t\t\t// tree.debug(\"document.cookie:\", document.cookie);\r\n\r\n\t\t\tcookie = local._data(local.cookiePrefix + EXPANDED);\r\n\t\t\tkeyList = cookie && cookie.split(instOpts.cookieDelimiter);\r\n\r\n\t\t\tif( local.storeExpanded ) {\r\n\t\t\t\t// Recursively load nested lazy nodes if expandLazy is 'expand' or 'load'\r\n\t\t\t\t// Also remove expand-cookies for unmatched nodes\r\n\t\t\t\tdfd = _loadLazyNodes(tree, local, keyList, instOpts.expandLazy ? \"expand\" : false , null);\r\n\t\t\t} else {\r\n\t\t\t\t// nothing to do\r\n\t\t\t\tdfd = new $.Deferred().resolve();\r\n\t\t\t}\r\n\r\n\t\t\tdfd.done(function(){\r\n\t\t\t\tif(local.storeSelected){\r\n\t\t\t\t\tcookie = local._data(local.cookiePrefix + SELECTED);\r\n\t\t\t\t\tif(cookie){\r\n\t\t\t\t\t\tkeyList = cookie.split(instOpts.cookieDelimiter);\r\n\t\t\t\t\t\tfor(i=0; i<keyList.length; i++){\r\n\t\t\t\t\t\t\tnode = tree.getNodeByKey(keyList[i]);\r\n\t\t\t\t\t\t\tif(node){\r\n\t\t\t\t\t\t\t\tif(node.selected === undefined || instOpts.overrideSource && (node.selected === false)){\r\n//\t\t\t\t\t\t\t\t\tnode.setSelected();\r\n\t\t\t\t\t\t\t\t\tnode.selected = true;\r\n\t\t\t\t\t\t\t\t\tnode.renderStatus();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\t\t// node is no longer member of the tree: remove from cookie also\r\n\t\t\t\t\t\t\t\tlocal._appendKey(SELECTED, keyList[i], false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// In selectMode 3 we have to fix the child nodes, since we\r\n\t\t\t\t\t// only stored the selected *top* nodes\r\n\t\t\t\t\tif( tree.options.selectMode === 3 ){\r\n\t\t\t\t\t\ttree.visit(function(n){\r\n\t\t\t\t\t\t\tif( n.selected ) {\r\n\t\t\t\t\t\t\t\tn.fixSelection3AfterClick();\r\n\t\t\t\t\t\t\t\treturn \"skip\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(local.storeActive){\r\n\t\t\t\t\tcookie = local._data(local.cookiePrefix + ACTIVE);\r\n\t\t\t\t\tif(cookie && (opts.persist.overrideSource || !tree.activeNode)){\r\n\t\t\t\t\t\tnode = tree.getNodeByKey(cookie);\r\n\t\t\t\t\t\tif(node){\r\n\t\t\t\t\t\t\tnode.debug(\"persist: set active\", cookie);\r\n\t\t\t\t\t\t\t// We only want to set the focus if the container\r\n\t\t\t\t\t\t\t// had the keyboard focus before\r\n\t\t\t\t\t\t\tnode.setActive(true, {\r\n\t\t\t\t\t\t\t\tnoFocus: true,\r\n\t\t\t\t\t\t\t\tnoEvents: noEvents\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif(local.storeFocus && prevFocus){\r\n\t\t\t\t\tnode = tree.getNodeByKey(prevFocus);\r\n\t\t\t\t\tif(node){\r\n\t\t\t\t\t\t// node.debug(\"persist: set focus\", cookie);\r\n\t\t\t\t\t\tif( tree.options.titlesTabbable ) {\r\n\t\t\t\t\t\t\t$(node.span).find(\".fancytree-title\").focus();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$(tree.$container).focus();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// node.setFocus();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\ttree._triggerTreeEvent(\"restore\", null, {});\r\n\t\t\t});\r\n\t\t});\r\n\t\t// Init the tree\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\tnodeSetActive: function(ctx, flag, callOpts) {\r\n\t\tvar res,\r\n\t\t\tlocal = this._local;\r\n\r\n\t\tflag = (flag !== false);\r\n\t\tres = this._superApply(arguments);\r\n\r\n\t\tif(local.storeActive){\r\n\t\t\tlocal._data(local.cookiePrefix + ACTIVE, this.activeNode ? this.activeNode.key : null);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnodeSetExpanded: function(ctx, flag, callOpts) {\r\n\t\tvar res,\r\n\t\t\tnode = ctx.node,\r\n\t\t\tlocal = this._local;\r\n\r\n\t\tflag = (flag !== false);\r\n\t\tres = this._superApply(arguments);\r\n\r\n\t\tif(local.storeExpanded){\r\n\t\t\tlocal._appendKey(EXPANDED, node.key, flag);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnodeSetFocus: function(ctx, flag) {\r\n\t\tvar res,\r\n\t\t\tlocal = this._local;\r\n\r\n\t\tflag = (flag !== false);\r\n\t\tres = this._superApply(arguments);\r\n\r\n\t\tif( local.storeFocus ) {\r\n\t\t\tlocal._data(local.cookiePrefix + FOCUS, this.focusNode ? this.focusNode.key : null);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnodeSetSelected: function(ctx, flag, callOpts) {\r\n\t\tvar res, selNodes,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\tnode = ctx.node,\r\n\t\t\tlocal = this._local;\r\n\r\n\t\tflag = (flag !== false);\r\n\t\tres = this._superApply(arguments);\r\n\r\n\t\tif(local.storeSelected){\r\n\t\t\tif( tree.options.selectMode === 3 ){\r\n\t\t\t\t// In selectMode 3 we only store the the selected *top* nodes.\r\n\t\t\t\t// De-selecting a node may also de-select some parents, so we\r\n\t\t\t\t// calculate the current status again\r\n\t\t\t\tselNodes = $.map(tree.getSelectedNodes(true), function(n){\r\n\t\t\t\t\treturn n.key;\r\n\t\t\t\t});\r\n\t\t\t\tselNodes = selNodes.join(ctx.options.persist.cookieDelimiter);\r\n\t\t\t\tlocal._data(local.cookiePrefix + SELECTED, selNodes);\r\n\t\t\t} else {\r\n\t\t\t\t// beforeSelect can prevent the change - flag doesn't reflect the node.selected state\r\n\t\t\t\tlocal._appendKey(SELECTED, node.key, node.selected);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn res;\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.table.js\r\n *\r\n * Render tree as table (aka 'tree grid', 'table tree').\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n/* *****************************************************************************\r\n * Private functions and variables\r\n */\r\nfunction _assert(cond, msg){\r\n\tmsg = msg || \"\";\r\n\tif(!cond){\r\n\t\t$.error(\"Assertion failed \" + msg);\r\n\t}\r\n}\r\n\r\nfunction insertFirstChild(referenceNode, newNode) {\r\n\treferenceNode.insertBefore(newNode, referenceNode.firstChild);\r\n}\r\n\r\nfunction insertSiblingAfter(referenceNode, newNode) {\r\n\treferenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\r\n}\r\n\r\n/* Show/hide all rows that are structural descendants of `parent`. */\r\nfunction setChildRowVisibility(parent, flag) {\r\n\tparent.visit(function(node){\r\n\t\tvar tr = node.tr;\r\n\t\t// currentFlag = node.hide ? false : flag; // fix for ext-filter\r\n\t\tif(tr){\r\n\t\t\ttr.style.display = (node.hide || !flag) ? \"none\" : \"\";\r\n\t\t}\r\n\t\tif(!node.expanded){\r\n\t\t\treturn \"skip\";\r\n\t\t}\r\n\t});\r\n}\r\n\r\n/* Find node that is rendered in previous row. */\r\nfunction findPrevRowNode(node){\r\n\tvar i, last, prev,\r\n\t\tparent = node.parent,\r\n\t\tsiblings = parent ? parent.children : null;\r\n\r\n\tif(siblings && siblings.length > 1 && siblings[0] !== node){\r\n\t\t// use the lowest descendant of the preceeding sibling\r\n\t\ti = $.inArray(node, siblings);\r\n\t\tprev = siblings[i - 1];\r\n\t\t_assert(prev.tr);\r\n\t\t// descend to lowest child (with a <tr> tag)\r\n\t\twhile(prev.children && prev.children.length){\r\n\t\t\tlast = prev.children[prev.children.length - 1];\r\n\t\t\tif(!last.tr){\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t\tprev = last;\r\n\t\t}\r\n\t}else{\r\n\t\t// if there is no preceding sibling, use the direct parent\r\n\t\tprev = parent;\r\n\t}\r\n\treturn prev;\r\n}\r\n\r\n/* Render callback for 'wide' mode. */\r\n// function _renderStatusNodeWide(event, data) {\r\n// \tvar node = data.node,\r\n// \t\tnodeColumnIdx = data.options.table.nodeColumnIdx,\r\n// \t\t$tdList = $(node.tr).find(\">td\");\r\n\r\n// \t$tdList.eq(nodeColumnIdx).attr(\"colspan\", data.tree.columnCount);\r\n// \t$tdList.not(\":eq(\" + nodeColumnIdx + \")\").remove();\r\n// }\r\n\r\n\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"table\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tcheckboxColumnIdx: null, // render the checkboxes into the this column index (default: nodeColumnIdx)\r\n\t\t// customStatus: false,\t // true: generate renderColumns events for status nodes\r\n\t\tindentation: 16,         // indent every node level by 16px\r\n\t\tnodeColumnIdx: 0         // render node expander, icon, and title to this column (default: #0)\r\n\t},\r\n\t// Overide virtual methods for this extension.\r\n\t// `this`       : is this extension object\r\n\t// `this._super`: the virtual function that was overriden (member of prev. extension or Fancytree)\r\n\ttreeInit: function(ctx){\r\n\t\tvar i, columnCount, n, $row, $tbody,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\topts = ctx.options,\r\n\t\t\ttableOpts = opts.table,\r\n\t\t\t$table = tree.widget.element;\r\n\r\n\t\tif( tableOpts.customStatus != null ) {\r\n\t\t\tif( opts.renderStatusColumns != null) {\r\n\t\t\t\t$.error(\"The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' only instead.\");\r\n\t\t\t} else {\r\n\t\t\t\ttree.warn(\"The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' instead.\");\r\n\t\t\t\topts.renderStatusColumns = tableOpts.customStatus;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif( opts.renderStatusColumns ) {\r\n\t\t\tif( opts.renderStatusColumns === true ) {\r\n\t\t\t\topts.renderStatusColumns = opts.renderColumns;\r\n\t\t\t// } else if( opts.renderStatusColumns === \"wide\" ) {\r\n\t\t\t// \topts.renderStatusColumns = _renderStatusNodeWide;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$table.addClass(\"fancytree-container fancytree-ext-table\");\r\n\t\t$tbody = $table.find(\">tbody\");\r\n\t\tif( !$tbody.length ) {\r\n\t\t\t// TODO: not sure if we can rely on browsers to insert missing <tbody> before <tr>s:\r\n\t\t\tif( $table.find(\">tr\").length ) {\r\n\t\t\t\t$.error(\"Expected table > tbody > tr. If you see this please open an issue.\");\r\n\t\t\t}\r\n\t\t\t$tbody = $(\"<tbody>\").appendTo($table);\r\n\t\t}\r\n\r\n\t\ttree.tbody = $tbody[0];\r\n\r\n\t\t// Prepare row templates:\r\n\t\t// Determine column count from table header if any\r\n\t\tcolumnCount = $(\"thead >tr:last >th\", $table).length;\r\n\t\t// Read TR templates from tbody if any\r\n\t\t$row = $tbody.children(\"tr:first\");\r\n\t\tif( $row.length ) {\r\n\t\t\tn = $row.children(\"td\").length;\r\n\t\t\tif( columnCount && n !== columnCount ) {\r\n\t\t\t\ttree.warn(\"Column count mismatch between thead (\" + columnCount + \") and tbody (\" + n + \"): using tbody.\");\r\n\t\t\t\tcolumnCount = n;\r\n\t\t\t}\r\n\t\t\t$row = $row.clone();\r\n\t\t} else {\r\n\t\t\t// Only thead is defined: create default row markup\r\n\t\t\t_assert(columnCount >= 1, \"Need either <thead> or <tbody> with <td> elements to determine column count.\");\r\n\t\t\t$row = $(\"<tr />\");\r\n\t\t\tfor(i=0; i<columnCount; i++) {\r\n\t\t\t\t$row.append(\"<td />\");\r\n\t\t\t}\r\n\t\t}\r\n\t\t$row.find(\">td\").eq(tableOpts.nodeColumnIdx)\r\n\t\t\t.html(\"<span class='fancytree-node' />\");\r\n\t\tif( opts.aria ) {\r\n\t\t\t$row.attr(\"role\", \"row\");\r\n\t\t\t$row.find(\"td\").attr(\"role\", \"gridcell\");\r\n\t\t}\r\n\t\ttree.rowFragment = document.createDocumentFragment();\r\n\t\ttree.rowFragment.appendChild($row.get(0));\r\n\r\n\t\t// // If tbody contains a second row, use this as status node template\r\n\t\t// $row = $tbody.children(\"tr:eq(1)\");\r\n\t\t// if( $row.length === 0 ) {\r\n\t\t// \ttree.statusRowFragment = tree.rowFragment;\r\n\t\t// } else {\r\n\t\t// \t$row = $row.clone();\r\n\t\t// \ttree.statusRowFragment = document.createDocumentFragment();\r\n\t\t// \ttree.statusRowFragment.appendChild($row.get(0));\r\n\t\t// }\r\n\t\t//\r\n\t\t$tbody.empty();\r\n\r\n\t\t// Make sure that status classes are set on the node's <tr> elements\r\n\t\ttree.statusClassPropName = \"tr\";\r\n\t\ttree.ariaPropName = \"tr\";\r\n\t\tthis.nodeContainerAttrName = \"tr\";\r\n\r\n\t\t// #489: make sure $container is set to <table>, even if ext-dnd is listed before ext-table\r\n\t\ttree.$container = $table;\r\n\r\n\t\tthis._superApply(arguments);\r\n\r\n\t\t// standard Fancytree created a root UL\r\n\t\t$(tree.rootNode.ul).remove();\r\n\t\ttree.rootNode.ul = null;\r\n\r\n\t\t// Add container to the TAB chain\r\n\t\t// #577: Allow to set tabindex to \"0\", \"-1\" and \"\"\r\n\t\tthis.$container.attr(\"tabindex\", opts.tabindex);\r\n\t\t// this.$container.attr(\"tabindex\", opts.tabbable ? \"0\" : \"-1\");\r\n\t\tif(opts.aria) {\r\n\t\t\ttree.$container\r\n\t\t\t\t.attr(\"role\", \"treegrid\")\r\n\t\t\t\t.attr(\"aria-readonly\", true);\r\n\t\t}\r\n\t},\r\n\tnodeRemoveChildMarkup: function(ctx) {\r\n\t\tvar node = ctx.node;\r\n//\t\tnode.debug(\"nodeRemoveChildMarkup()\");\r\n\t\tnode.visit(function(n){\r\n\t\t\tif(n.tr){\r\n\t\t\t\t$(n.tr).remove();\r\n\t\t\t\tn.tr = null;\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tnodeRemoveMarkup: function(ctx) {\r\n\t\tvar node = ctx.node;\r\n//\t\tnode.debug(\"nodeRemoveMarkup()\");\r\n\t\tif(node.tr){\r\n\t\t\t$(node.tr).remove();\r\n\t\t\tnode.tr = null;\r\n\t\t}\r\n\t\tthis.nodeRemoveChildMarkup(ctx);\r\n\t},\r\n\t/* Override standard render. */\r\n\tnodeRender: function(ctx, force, deep, collapsed, _recursive) {\r\n\t\tvar children, firstTr, i, l, newRow, prevNode, prevTr, subCtx,\r\n\t\t\ttree = ctx.tree,\r\n\t\t\tnode = ctx.node,\r\n\t\t\topts = ctx.options,\r\n\t\t\tisRootNode = !node.parent;\r\n\r\n\t\tif( tree._enableUpdate === false ) {\r\n\t\t\t// $.ui.fancytree.debug(\"*** nodeRender _enableUpdate: false\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif( !_recursive ){\r\n\t\t\tctx.hasCollapsedParents = node.parent && !node.parent.expanded;\r\n\t\t}\r\n\t\t// $.ui.fancytree.debug(\"*** nodeRender \" + node + \", isRoot=\" + isRootNode, \"tr=\" + node.tr, \"hcp=\" + ctx.hasCollapsedParents, \"parent.tr=\" + (node.parent && node.parent.tr));\r\n\t\tif( !isRootNode ){\r\n\t\t\tif( node.tr && force ) {\r\n\t\t\t\tthis.nodeRemoveMarkup(ctx);\r\n\t\t\t}\r\n\t\t\tif( !node.tr ) {\r\n\t\t\t\tif( ctx.hasCollapsedParents && !deep ) {\r\n\t\t\t\t\t// #166: we assume that the parent will be (recursively) rendered\r\n\t\t\t\t\t// later anyway.\r\n\t\t\t\t\t// node.debug(\"nodeRender ignored due to unrendered parent\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// Create new <tr> after previous row\r\n\t\t\t\t// if( node.isStatusNode() ) {\r\n\t\t\t\t// \tnewRow = tree.statusRowFragment.firstChild.cloneNode(true);\r\n\t\t\t\t// } else {\r\n\t\t\t\tnewRow = tree.rowFragment.firstChild.cloneNode(true);\r\n\t\t\t\t// }\r\n\t\t\t\tprevNode = findPrevRowNode(node);\r\n\t\t\t\t// $.ui.fancytree.debug(\"*** nodeRender \" + node + \": prev: \" + prevNode.key);\r\n\t\t\t\t_assert(prevNode);\r\n\t\t\t\tif(collapsed === true && _recursive){\r\n\t\t\t\t\t// hide all child rows, so we can use an animation to show it later\r\n\t\t\t\t\tnewRow.style.display = \"none\";\r\n\t\t\t\t}else if(deep && ctx.hasCollapsedParents){\r\n\t\t\t\t\t// also hide this row if deep === true but any parent is collapsed\r\n\t\t\t\t\tnewRow.style.display = \"none\";\r\n//\t\t\t\t\tnewRow.style.color = \"red\";\r\n\t\t\t\t}\r\n\t\t\t\tif(!prevNode.tr){\r\n\t\t\t\t\t_assert(!prevNode.parent, \"prev. row must have a tr, or be system root\");\r\n\t\t\t\t\t// tree.tbody.appendChild(newRow);\r\n\t\t\t\t\tinsertFirstChild(tree.tbody, newRow);  // #675\r\n\t\t\t\t}else{\r\n\t\t\t\t\tinsertSiblingAfter(prevNode.tr, newRow);\r\n\t\t\t\t}\r\n\t\t\t\tnode.tr = newRow;\r\n\t\t\t\tif( node.key && opts.generateIds ){\r\n\t\t\t\t\tnode.tr.id = opts.idPrefix + node.key;\r\n\t\t\t\t}\r\n\t\t\t\tnode.tr.ftnode = node;\r\n\t\t\t\t// if(opts.aria){\r\n\t\t\t\t// \t$(node.tr).attr(\"aria-labelledby\", \"ftal_\" + opts.idPrefix + node.key);\r\n\t\t\t\t// }\r\n\t\t\t\tnode.span = $(\"span.fancytree-node\", node.tr).get(0);\r\n\t\t\t\t// Set icon, link, and title (normally this is only required on initial render)\r\n\t\t\t\tthis.nodeRenderTitle(ctx);\r\n\t\t\t\t// Allow tweaking, binding, after node was created for the first time\r\n//\t\t\t\ttree._triggerNodeEvent(\"createNode\", ctx);\r\n\t\t\t\tif ( opts.createNode ){\r\n\t\t\t\t\topts.createNode.call(tree, {type: \"createNode\"}, ctx);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif( force ) {\r\n\t\t\t\t\t// Set icon, link, and title (normally this is only required on initial render)\r\n\t\t\t\t\tthis.nodeRenderTitle(ctx); // triggers renderColumns()\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Update element classes according to node state\r\n\t\t\t\t\tthis.nodeRenderStatus(ctx);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Allow tweaking after node state was rendered\r\n//\t\ttree._triggerNodeEvent(\"renderNode\", ctx);\r\n\t\tif ( opts.renderNode ){\r\n\t\t\topts.renderNode.call(tree, {type: \"renderNode\"}, ctx);\r\n\t\t}\r\n\t\t// Visit child nodes\r\n\t\t// Add child markup\r\n\t\tchildren = node.children;\r\n\t\tif(children && (isRootNode || deep || node.expanded)){\r\n\t\t\tfor(i=0, l=children.length; i<l; i++) {\r\n\t\t\t\tsubCtx = $.extend({}, ctx, {node: children[i]});\r\n\t\t\t\tsubCtx.hasCollapsedParents = subCtx.hasCollapsedParents || !node.expanded;\r\n\t\t\t\tthis.nodeRender(subCtx, force, deep, collapsed, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Make sure, that <tr> order matches node.children order.\r\n\t\tif(children && !_recursive){ // we only have to do it once, for the root branch\r\n\t\t\tprevTr = node.tr || null;\r\n\t\t\tfirstTr = tree.tbody.firstChild;\r\n\t\t\t// Iterate over all descendants\r\n\t\t\tnode.visit(function(n){\r\n\t\t\t\tif(n.tr){\r\n\t\t\t\t\tif(!n.parent.expanded && n.tr.style.display !== \"none\"){\r\n\t\t\t\t\t\t// fix after a node was dropped over a collapsed\r\n\t\t\t\t\t\tn.tr.style.display = \"none\";\r\n\t\t\t\t\t\tsetChildRowVisibility(n, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif(n.tr.previousSibling !== prevTr){\r\n\t\t\t\t\t\tnode.debug(\"_fixOrder: mismatch at node: \" + n);\r\n\t\t\t\t\t\tvar nextTr = prevTr ? prevTr.nextSibling : firstTr;\r\n\t\t\t\t\t\ttree.tbody.insertBefore(n.tr, nextTr);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tprevTr = n.tr;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// Update element classes according to node state\r\n\t\t// if(!isRootNode){\r\n\t\t// \tthis.nodeRenderStatus(ctx);\r\n\t\t// }\r\n\t},\r\n\tnodeRenderTitle: function(ctx, title) {\r\n\t\tvar $cb, res,\r\n\t\t\tnode = ctx.node,\r\n\t\t\topts = ctx.options,\r\n\t\t\tisStatusNode = node.isStatusNode();\r\n\r\n\t\tres = this._super(ctx, title);\r\n\r\n\t\tif( node.isRootNode() ) {\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\t// Move checkbox to custom column\r\n\t\tif(opts.checkbox && !isStatusNode && opts.table.checkboxColumnIdx != null ){\r\n\t\t\t$cb = $(\"span.fancytree-checkbox\", node.span); //.detach();\r\n\t\t\t$(node.tr).find(\"td\").eq(+opts.table.checkboxColumnIdx).html($cb);\r\n\t\t}\r\n\t\t// Update element classes according to node state\r\n\t\tthis.nodeRenderStatus(ctx);\r\n\r\n\t\tif( isStatusNode ) {\r\n\t\t\tif( opts.renderStatusColumns ) {\r\n\t\t\t\t// Let user code write column content\r\n\t\t\t\topts.renderStatusColumns.call(ctx.tree, {type: \"renderStatusColumns\"}, ctx);\r\n\t\t\t} // else: default rendering for status node: leave other cells empty\r\n\t\t} else if ( opts.renderColumns ) {\r\n\t\t\topts.renderColumns.call(ctx.tree, {type: \"renderColumns\"}, ctx);\r\n\t\t}\r\n\t\treturn res;\r\n\t},\r\n\tnodeRenderStatus: function(ctx) {\r\n\t\tvar indent,\r\n\t\t\tnode = ctx.node,\r\n\t\t\topts = ctx.options;\r\n\r\n\t\tthis._super(ctx);\r\n\r\n\t\t$(node.tr).removeClass(\"fancytree-node\");\r\n\t\t// indent\r\n\t\tindent = (node.getLevel() - 1) * opts.table.indentation;\r\n\t\t$(node.span).css({paddingLeft: indent + \"px\"});  // #460\r\n\t\t// $(node.span).css({marginLeft: indent + \"px\"});\r\n\t },\r\n\t/* Expand node, return Deferred.promise. */\r\n\tnodeSetExpanded: function(ctx, flag, callOpts) {\r\n\t\t// flag defaults to true\r\n\t\tflag = (flag !== false);\r\n\r\n\t\tif((ctx.node.expanded && flag) || (!ctx.node.expanded && !flag)) {\r\n\t\t\t// Expanded state isn't changed - just call base implementation\r\n\t\t\treturn this._superApply(arguments);\r\n\t\t}\r\n\r\n\t\tvar dfd = new $.Deferred(),\r\n\t\t\tsubOpts = $.extend({}, callOpts, {noEvents: true, noAnimation: true});\r\n\r\n\t\tcallOpts = callOpts || {};\r\n\r\n\t\tfunction _afterExpand(ok) {\r\n\t\t\tsetChildRowVisibility(ctx.node, flag);\r\n\t\t\tif( ok ) {\r\n\t\t\t\tif( flag && ctx.options.autoScroll && !callOpts.noAnimation && ctx.node.hasChildren() ) {\r\n\t\t\t\t\t// Scroll down to last child, but keep current node visible\r\n\t\t\t\t\tctx.node.getLastChild().scrollIntoView(true, {topNode: ctx.node}).always(function(){\r\n\t\t\t\t\t\tif( !callOpts.noEvents ) {\r\n\t\t\t\t\t\t\tctx.tree._triggerNodeEvent(flag ? \"expand\" : \"collapse\", ctx);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdfd.resolveWith(ctx.node);\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif( !callOpts.noEvents ) {\r\n\t\t\t\t\t\tctx.tree._triggerNodeEvent(flag ? \"expand\" : \"collapse\", ctx);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tdfd.resolveWith(ctx.node);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif( !callOpts.noEvents ) {\r\n\t\t\t\t\tctx.tree._triggerNodeEvent(flag ? \"expand\" : \"collapse\", ctx);\r\n\t\t\t\t}\r\n\t\t\t\tdfd.rejectWith(ctx.node);\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Call base-expand with disabled events and animation\r\n\t\tthis._super(ctx, flag, subOpts).done(function () {\r\n\t\t\t_afterExpand(true);\r\n\t\t}).fail(function () {\r\n\t\t\t_afterExpand(false);\r\n\t\t});\r\n\t\treturn dfd.promise();\r\n\t},\r\n\tnodeSetStatus: function(ctx, status, message, details) {\r\n\t\tif(status === \"ok\"){\r\n\t\t\tvar node = ctx.node,\r\n\t\t\t\tfirstChild = ( node.children ? node.children[0] : null );\r\n\t\t\tif ( firstChild && firstChild.isStatusNode() ) {\r\n\t\t\t\t$(firstChild.tr).remove();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\ttreeClear: function(ctx) {\r\n\t\tthis.nodeRemoveChildMarkup(this._makeHookContext(this.rootNode));\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\ttreeDestroy: function(ctx) {\r\n\t\tthis.$container.find(\"tbody\").empty();\r\n\t\tthis.$source && this.$source.removeClass(\"ui-helper-hidden\");\r\n\t\treturn this._superApply(arguments);\r\n\t}\r\n\t/*,\r\n\ttreeSetFocus: function(ctx, flag) {\r\n//\t        alert(\"treeSetFocus\" + ctx.tree.$container);\r\n\t\tctx.tree.$container.focus();\r\n\t\t$.ui.fancytree.focusTree = ctx.tree;\r\n\t}*/\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.themeroller.js\r\n *\r\n * Enable jQuery UI ThemeRoller styles.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * @see http://jqueryui.com/themeroller/\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\n/*******************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"themeroller\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\tactiveClass: \"ui-state-active\",      // Class added to active node\r\n\t\t// activeClass: \"ui-state-highlight\",\r\n\t\taddClass: \"ui-corner-all\",           // Class added to all nodes\r\n\t\tfocusClass: \"ui-state-focus\",        // Class added to focused node\r\n\t\thoverClass: \"ui-state-hover\",        // Class added to hovered node\r\n\t\tselectedClass: \"ui-state-highlight\"  // Class added to selected nodes\r\n\t\t// selectedClass: \"ui-state-active\"\r\n\t},\r\n\r\n\ttreeInit: function(ctx){\r\n\t\tvar $el = ctx.widget.element,\r\n\t\t\topts = ctx.options.themeroller;\r\n\r\n\t\tthis._superApply(arguments);\r\n\r\n\t\tif($el[0].nodeName === \"TABLE\"){\r\n\t\t\t$el.addClass(\"ui-widget ui-corner-all\");\r\n\t\t\t$el.find(\">thead tr\").addClass(\"ui-widget-header\");\r\n\t\t\t$el.find(\">tbody\").addClass(\"ui-widget-conent\");\r\n\t\t}else{\r\n\t\t\t$el.addClass(\"ui-widget ui-widget-content ui-corner-all\");\r\n\t\t}\r\n\r\n\t\t$el.delegate(\".fancytree-node\", \"mouseenter mouseleave\", function(event){\r\n\t\t\tvar node = $.ui.fancytree.getNode(event.target),\r\n\t\t\t\tflag = (event.type === \"mouseenter\");\r\n\r\n\t\t\t$(node.tr ? node.tr : node.span)\r\n\t\t\t\t.toggleClass(opts.hoverClass + \" \" + opts.addClass, flag);\r\n\t\t});\r\n\t},\r\n\ttreeDestroy: function(ctx){\r\n\t\tthis._superApply(arguments);\r\n\t\tctx.widget.element.removeClass(\"ui-widget ui-widget-content ui-corner-all\");\r\n\t},\r\n\tnodeRenderStatus: function(ctx){\r\n\t\tvar classes = {},\r\n\t\t\tnode = ctx.node,\r\n\t\t\t$el = $(node.tr ? node.tr : node.span),\r\n\t\t\topts = ctx.options.themeroller;\r\n\r\n\t\tthis._super(ctx);\r\n/*\r\n\t\t.ui-state-highlight: Class to be applied to highlighted or selected elements. Applies \"highlight\" container styles to an element and its child text, links, and icons.\r\n\t\t.ui-state-error: Class to be applied to error messaging container elements. Applies \"error\" container styles to an element and its child text, links, and icons.\r\n\t\t.ui-state-error-text: An additional class that applies just the error text color without background. Can be used on form labels for instance. Also applies error icon color to child icons.\r\n\r\n\t\t.ui-state-default: Class to be applied to clickable button-like elements. Applies \"clickable default\" container styles to an element and its child text, links, and icons.\r\n\t\t.ui-state-hover: Class to be applied on mouseover to clickable button-like elements. Applies \"clickable hover\" container styles to an element and its child text, links, and icons.\r\n\t\t.ui-state-focus: Class to be applied on keyboard focus to clickable button-like elements. Applies \"clickable hover\" container styles to an element and its child text, links, and icons.\r\n\t\t.ui-state-active: Class to be applied on mousedown to clickable button-like elements. Applies \"clickable active\" container styles to an element and its child text, links, and icons.\r\n*/\r\n\t\t// Set ui-state-* class (handle the case that the same class is assigned\r\n\t\t// to different states)\r\n\t\tclasses[opts.activeClass] = false;\r\n\t\tclasses[opts.focusClass] = false;\r\n\t\tclasses[opts.selectedClass] = false;\r\n\t\tif( node.isActive() ) { classes[opts.activeClass] = true; }\r\n\t\tif( node.hasFocus() ) { classes[opts.focusClass]  = true; }\r\n\t\t// activeClass takes precedence before selectedClass:\r\n\t\tif( node.isSelected() && !node.isActive() ) { classes[opts.selectedClass]  = true; }\r\n\t\t$el.toggleClass(opts.activeClass, classes[opts.activeClass]);\r\n\t\t$el.toggleClass(opts.focusClass, classes[opts.focusClass]);\r\n\t\t$el.toggleClass(opts.selectedClass, classes[opts.selectedClass]);\r\n\t\t// Additional classes (e.g. 'ui-corner-all')\r\n\t\t$el.addClass(opts.addClass);\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n\r\n/*!\r\n * jquery.fancytree.wide.js\r\n * Support for 100% wide selection bars.\r\n * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)\r\n *\r\n * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)\r\n *\r\n * Released under the MIT license\r\n * https://github.com/mar10/fancytree/wiki/LicenseInfo\r\n *\r\n * @version 2.27.0\r\n * @date 2017-12-16T09:14:27Z\r\n */\r\n\r\n;(function( factory ) {\r\n\tif ( typeof define === \"function\" && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( [ \"jquery\", \"./jquery.fancytree\" ], factory );\r\n\t} else if ( typeof module === \"object\" && module.exports ) {\r\n\t\t// Node/CommonJS\r\n\t\trequire(\"./jquery.fancytree\");\r\n\t\tmodule.exports = factory(require(\"jquery\"));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory( jQuery );\r\n\t}\r\n\r\n}( function( $ ) {\r\n\r\n\"use strict\";\r\n\r\nvar reNumUnit = /^([+-]?(?:\\d+|\\d*\\.\\d+))([a-z]*|%)$/; // split \"1.5em\" to [\"1.5\", \"em\"]\r\n\r\n/*******************************************************************************\r\n * Private functions and variables\r\n */\r\n// var _assert = $.ui.fancytree.assert;\r\n\r\n/* Calculate inner width without scrollbar */\r\n// function realInnerWidth($el) {\r\n// \t// http://blog.jquery.com/2012/08/16/jquery-1-8-box-sizing-width-csswidth-and-outerwidth/\r\n// //\tinst.contWidth = parseFloat(this.$container.css(\"width\"), 10);\r\n// \t// 'Client width without scrollbar' - 'padding'\r\n// \treturn $el[0].clientWidth - ($el.innerWidth() -  parseFloat($el.css(\"width\"), 10));\r\n// }\r\n\r\n/* Create a global embedded CSS style for the tree. */\r\nfunction defineHeadStyleElement(id, cssText) {\r\n\tid = \"fancytree-style-\" + id;\r\n\tvar $headStyle = $(\"#\" + id);\r\n\r\n\tif( !cssText ) {\r\n\t\t$headStyle.remove();\r\n\t\treturn null;\r\n\t}\r\n\tif( !$headStyle.length ) {\r\n\t\t$headStyle = $(\"<style />\")\r\n\t\t\t.attr(\"id\", id)\r\n\t\t\t.addClass(\"fancytree-style\")\r\n\t\t\t.prop(\"type\", \"text/css\")\r\n\t\t\t.appendTo(\"head\");\r\n\t}\r\n\ttry {\r\n\t\t$headStyle.html(cssText);\r\n\t} catch ( e ) {\r\n\t\t// fix for IE 6-8\r\n\t\t$headStyle[0].styleSheet.cssText = cssText;\r\n\t}\r\n\treturn $headStyle;\r\n}\r\n\r\n/* Calculate the CSS rules that indent title spans. */\r\nfunction renderLevelCss(containerId, depth, levelOfs, lineOfs, labelOfs, measureUnit)\r\n{\r\n\tvar i,\r\n\t\tprefix = \"#\" + containerId + \" span.fancytree-level-\",\r\n\t\trules = [];\r\n\r\n\tfor(i = 0; i < depth; i++) {\r\n\t\trules.push(prefix + (i + 1) + \" span.fancytree-title { padding-left: \" +\r\n\t\t\t(i * levelOfs + lineOfs) + measureUnit + \"; }\");\r\n\t}\r\n\t// Some UI animations wrap the UL inside a DIV and set position:relative on both.\r\n\t// This breaks the left:0 and padding-left:nn settings of the title\r\n\trules.push(\r\n\t\t\"#\" + containerId + \" div.ui-effects-wrapper ul li span.fancytree-title, \" +\r\n\t\t\"#\" + containerId + \" li.fancytree-animating span.fancytree-title \" +  // #716\r\n\t\t\"{ padding-left: \" + labelOfs + measureUnit + \"; position: static; width: auto; }\");\r\n\treturn rules.join(\"\\n\");\r\n}\r\n\r\n\r\n// /**\r\n//  * [ext-wide] Recalculate the width of the selection bar after the tree container\r\n//  * was resized.<br>\r\n//  * May be called explicitly on container resize, since there is no resize event\r\n//  * for DIV tags.\r\n//  *\r\n//  * @alias Fancytree#wideUpdate\r\n//  * @requires jquery.fancytree.wide.js\r\n//  */\r\n// $.ui.fancytree._FancytreeClass.prototype.wideUpdate = function(){\r\n// \tvar inst = this.ext.wide,\r\n// \t\tprevCw = inst.contWidth,\r\n// \t\tprevLo = inst.lineOfs;\r\n\r\n// \tinst.contWidth = realInnerWidth(this.$container);\r\n// \t// Each title is precceeded by 2 or 3 icons (16px + 3 margin)\r\n// \t//     + 1px title border and 3px title padding\r\n// \t// TODO: use code from treeInit() below\r\n// \tinst.lineOfs = (this.options.checkbox ? 3 : 2) * 19;\r\n// \tif( prevCw !== inst.contWidth || prevLo !== inst.lineOfs ) {\r\n// \t\tthis.debug(\"wideUpdate: \" + inst.contWidth);\r\n// \t\tthis.visit(function(node){\r\n// \t\t\tnode.tree._callHook(\"nodeRenderTitle\", node);\r\n// \t\t});\r\n// \t}\r\n// };\r\n\r\n/*******************************************************************************\r\n * Extension code\r\n */\r\n$.ui.fancytree.registerExtension({\r\n\tname: \"wide\",\r\n\tversion: \"2.27.0\",\r\n\t// Default options for this extension.\r\n\toptions: {\r\n\t\ticonWidth: null,     // Adjust this if @fancy-icon-width != \"16px\"\r\n\t\ticonSpacing: null,   // Adjust this if @fancy-icon-spacing != \"3px\"\r\n\t\tlabelSpacing: null,  // Adjust this if padding between icon and label != \"3px\"\r\n\t\tlevelOfs: null       // Adjust this if ul padding != \"16px\"\r\n\t},\r\n\r\n\ttreeCreate: function(ctx){\r\n\t\tthis._superApply(arguments);\r\n\t\tthis.$container.addClass(\"fancytree-ext-wide\");\r\n\r\n\t\tvar containerId, cssText, iconSpacingUnit, labelSpacingUnit, iconWidthUnit, levelOfsUnit,\r\n\t\t\tinstOpts = ctx.options.wide,\r\n\t\t\t// css sniffing\r\n\t\t\t$dummyLI = $(\"<li id='fancytreeTemp'><span class='fancytree-node'><span class='fancytree-icon' /><span class='fancytree-title' /></span><ul />\")\r\n\t\t\t\t.appendTo(ctx.tree.$container),\r\n\t\t\t$dummyIcon = $dummyLI.find(\".fancytree-icon\"),\r\n\t\t\t$dummyUL = $dummyLI.find(\"ul\"),\r\n\t\t\t// $dummyTitle = $dummyLI.find(\".fancytree-title\"),\r\n\t\t\ticonSpacing = instOpts.iconSpacing || $dummyIcon.css(\"margin-left\"),\r\n\t\t\ticonWidth = instOpts.iconWidth || $dummyIcon.css(\"width\"),\r\n\t\t\tlabelSpacing = instOpts.labelSpacing || \"3px\",\r\n\t\t\tlevelOfs = instOpts.levelOfs || $dummyUL.css(\"padding-left\");\r\n\r\n\t\t$dummyLI.remove();\r\n\r\n\t\ticonSpacingUnit = iconSpacing.match(reNumUnit)[2];\r\n\t\ticonSpacing = parseFloat(iconSpacing, 10);\r\n\t\tlabelSpacingUnit = labelSpacing.match(reNumUnit)[2];\r\n\t\tlabelSpacing = parseFloat(labelSpacing, 10);\r\n\t\ticonWidthUnit = iconWidth.match(reNumUnit)[2];\r\n\t\ticonWidth = parseFloat(iconWidth, 10);\r\n\t\tlevelOfsUnit = levelOfs.match(reNumUnit)[2];\r\n\t\tif( iconSpacingUnit !== iconWidthUnit || levelOfsUnit !== iconWidthUnit || labelSpacingUnit !== iconWidthUnit ) {\r\n\t\t\t$.error(\"iconWidth, iconSpacing, and levelOfs must have the same css measure unit\");\r\n\t\t}\r\n\t\tthis._local.measureUnit = iconWidthUnit;\r\n\t\tthis._local.levelOfs = parseFloat(levelOfs);\r\n\t\tthis._local.lineOfs = (1 + (ctx.options.checkbox ? 1 : 0) +\r\n\t\t\t\t(ctx.options.icon === false ? 0 : 1)) * (iconWidth + iconSpacing) +\r\n\t\t\t\ticonSpacing;\r\n\t\tthis._local.labelOfs = labelSpacing;\r\n\t\tthis._local.maxDepth = 10;\r\n\r\n\t\t// Get/Set a unique Id on the container (if not already exists)\r\n\t\tcontainerId = this.$container.uniqueId().attr(\"id\");\r\n\t\t// Generated css rules for some levels (extended on demand)\r\n\t\tcssText = renderLevelCss(containerId, this._local.maxDepth,\r\n\t\t\tthis._local.levelOfs, this._local.lineOfs, this._local.labelOfs,\r\n\t\t\tthis._local.measureUnit);\r\n\t\tdefineHeadStyleElement(containerId, cssText);\r\n\t},\r\n\ttreeDestroy: function(ctx){\r\n\t\t// Remove generated css rules\r\n\t\tdefineHeadStyleElement(this.$container.attr(\"id\"), null);\r\n\t\treturn this._superApply(arguments);\r\n\t},\r\n\tnodeRenderStatus: function(ctx) {\r\n\t\tvar containerId, cssText, res,\r\n\t\t\tnode = ctx.node,\r\n\t\t\tlevel = node.getLevel();\r\n\r\n\t\tres = this._super(ctx);\r\n\t\t// Generate some more level-n rules if required\r\n\t\tif( level > this._local.maxDepth ) {\r\n\t\t\tcontainerId = this.$container.attr(\"id\");\r\n\t\t\tthis._local.maxDepth *= 2;\r\n\t\t\tnode.debug(\"Define global ext-wide css up to level \" + this._local.maxDepth);\r\n\t\t\tcssText = renderLevelCss(containerId, this._local.maxDepth,\r\n\t\t\t\tthis._local.levelOfs, this._local.lineOfs, this._local.labelSpacing,\r\n\t\t\t\tthis._local.measureUnit);\r\n\t\t\tdefineHeadStyleElement(containerId, cssText);\r\n\t\t}\r\n\t\t// Add level-n class to apply indentation padding.\r\n\t\t// (Setting element style would not work, since it cannot easily be\r\n\t\t// overriden while animations run)\r\n\t\t$(node.span).addClass(\"fancytree-level-\" + level);\r\n\t\treturn res;\r\n\t}\r\n});\r\n// Value returned by `require('jquery.fancytree..')`\r\nreturn $.ui.fancytree;\r\n}));  // End of closure\r\n"]}